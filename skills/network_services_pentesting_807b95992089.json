{
  "id": "network_services_pentesting_807b95992089",
  "category": "network-services-pentesting",
  "title": "php ssrf",
  "description": "# PHP SSRF\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n### SSRF PHP functions\n\nSome function such as **file_get_contents(), fopen(), file(), md5_file()** accept URLs as input that they will follow making **possible SSRF vulnerabilities** if the use can control the data:\n\n```php\nfile_get_contents(\"http://127.0.0.1:8081\");\nfopen(\"http://127.0.0.1:8081\", \"r\");\nfile(\"http://127.0.0.1:8081\");\nmd5_file(\"http://127.0.0.1:8081\");\n```\n\n### Wordpress SSRF via DNS Rebinding\n\nAs [**explained in t",
  "payloads": [
    "# PHP SSRF",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "### SSRF PHP functions",
    "Some function such as **file_get_contents(), fopen(), file(), md5_file()** accept URLs as input that they will follow making **possible SSRF vulnerabilities** if the use can control the data:",
    "```php",
    "file_get_contents(\"http://127.0.0.1:8081\");",
    "fopen(\"http://127.0.0.1:8081\", \"r\");",
    "file(\"http://127.0.0.1:8081\");",
    "md5_file(\"http://127.0.0.1:8081\");",
    "### Wordpress SSRF via DNS Rebinding",
    "As [**explained in this blog post**](https://patchstack.com/articles/exploring-the-unpatched-wordpress-ssrf), even the Wordpress function **`wp_safe_remote_get`** is vulnerable to DNS rebinding, making it potentially vulnerable to SSRF attacks. The main validation it calls is **wp_http_validate_ur**l, which checks that the protocol is `http://` or `https://` and that the port is one of **80**, **443**, and **8080**, but it's **vulnerable to DNS rebinding**.",
    "Other vulnerable functions according to the post are:",
    "- `wp_safe_remote_request()`",
    "- `wp_safe_remote_post()`",
    "- `wp_safe_remote_head()`"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md"
  ]
}