{
  "id": "network_services_pentesting_928b4fea8c18",
  "category": "network-services-pentesting",
  "title": "135 pentesting msrpc",
  "description": "# 135, 593 - Pentesting MSRPC\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Basic Information\n\nThe Microsoft Remote Procedure Call (MSRPC) protocol, a client-server model enabling a program to request a service from a program located on another computer without understanding the network's specifics, was initially derived from open-source software and later developed and copyrighted by Microsoft.\n\nThe RPC endpoint mapper can be accessed via TCP and UDP port 135, SMB on TCP 139 and 445 (with",
  "payloads": [
    "# 135, 593 - Pentesting MSRPC",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Basic Information",
    "The Microsoft Remote Procedure Call (MSRPC) protocol, a client-server model enabling a program to request a service from a program located on another computer without understanding the network's specifics, was initially derived from open-source software and later developed and copyrighted by Microsoft.",
    "The RPC endpoint mapper can be accessed via TCP and UDP port 135, SMB on TCP 139 and 445 (with a null or authenticated session), and as a web service on TCP port 593.",
    "135/tcp   open     msrpc         Microsoft Windows RPC",
    "## How does MSRPC work?",
    "Initiated by the client application, the MSRPC process involves calling a local stub procedure that then interacts with the client runtime library to prepare and transmit the request to the server. This includes converting parameters into a standard Network Data Representation format. The choice of transport protocol is determined by the runtime library if the server is remote, ensuring the RPC is delivered through the network stack.",
    "![https://0xffsec.com/handbook/images/msrpc.png](https://0xffsec.com/handbook/images/msrpc.png)",
    "## **Identifying Exposed RPC Services**",
    "Exposure of RPC services across TCP, UDP, HTTP, and SMB can be determined by querying the RPC locator service and individual endpoints. Tools such as rpcdump facilitate the identification of unique RPC services, denoted by **IFID** values, revealing service details and communication bindings:",
    "D:\\rpctools> rpcdump [-p port] <IP>",
    "**IFID**: 5a7b91f8-ff00-11d0-a9b2-00c04fb6e6fc version 1.0",
    "Annotation: Messenger Service",
    "UUID: 00000000-0000-0000-0000-000000000000"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/135-pentesting-msrpc.md"
  ]
}