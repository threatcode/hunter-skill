{
  "id": "pentesting_web_e5bc3e1c273f",
  "category": "pentesting-web",
  "title": "connection pool example",
  "description": "# Connection Pool Examples\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Sekaictf2022 - safelist\n\nIn the [**Sekaictf2022 - safelist**](https://github.com/project-sekai-ctf/sekaictf-2022/tree/main/web/safelist/solution) challenge, [**@Strellic\\_**](https://twitter.com/Strellic_) gives an example of how to use a **variation** of the **Connection Pool** technique to perform a **XS-Leak**.\n\nIn this challenge, the goal is to exfiltrate a flag that will appear in the bots web session inside a",
  "payloads": [
    "# Connection Pool Examples",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Sekaictf2022 - safelist",
    "In the [**Sekaictf2022 - safelist**](https://github.com/project-sekai-ctf/sekaictf-2022/tree/main/web/safelist/solution) challenge, [**@Strellic\\_**](https://twitter.com/Strellic_) gives an example of how to use a **variation** of the **Connection Pool** technique to perform a **XS-Leak**.",
    "In this challenge, the goal is to exfiltrate a flag that will appear in the bots web session inside a post. These are the assets the attacker has:",
    "- The **bot** will **visit** a **URL** given by the attacker",
    "- The attacker can **inject HTML** in the page (but no JS, dompurify is used) abusing a **CSRF** making the **bot create a post** with that HTML.",
    "- The attacker can abuse a CSRF to make the **bot** **delete** the **first** **post** inside the web.",
    "- Because the **posts** are ordered **alphabetically**, when the **first post is deleted**, if the **HTML** content of the attacker is **loaded** means that it was **alphabetically before the flag**.",
    "Therefore, to steal the flag, the solution proposed by @Strellyc\\_ is to, **for each char to test** make the bot:",
    "- Create a **new post** that **starts** with the known part of the **flag** and several **img** **loads**.",
    "- **Delete** the **post** in position **0**.",
    "- Block 255 sockets.",
    "- Load the page with the posts",
    "- Perform 5 random requests to a site (example.com in this case) and measure the time this takes."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/xs-search/connection-pool-example.md"
  ]
}