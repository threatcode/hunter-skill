{
  "id": "network_services_pentesting_d0485d579878",
  "category": "network-services-pentesting",
  "title": "laravel",
  "description": "# Laravel\n\n{{#include ../../banners/hacktricks-training.md}}\n\n### Laravel SQLInjection\n\nRead information about this here: [https://stitcher.io/blog/unsafe-sql-functions-in-laravel](https://stitcher.io/blog/unsafe-sql-functions-in-laravel)\n\n---\n\n## APP_KEY & Encryption internals (Laravel >=5.6)\n\nLaravel uses AES-256-CBC (or GCM) with HMAC integrity under the hood (`Illuminate\\Encryption\\Encrypter`).\nThe raw ciphertext that is finally **sent to the client** is **Base64 of a JSON object** like:\n\n``",
  "payloads": [
    "# Laravel",
    "{{#include ../../banners/hacktricks-training.md}}",
    "### Laravel SQLInjection",
    "Read information about this here: [https://stitcher.io/blog/unsafe-sql-functions-in-laravel](https://stitcher.io/blog/unsafe-sql-functions-in-laravel)",
    "## APP_KEY & Encryption internals (Laravel >=5.6)",
    "Laravel uses AES-256-CBC (or GCM) with HMAC integrity under the hood (`Illuminate\\Encryption\\Encrypter`).",
    "The raw ciphertext that is finally **sent to the client** is **Base64 of a JSON object** like:",
    "```json",
    "\"iv\"   : \"Base64(random 16-byte IV)\",",
    "\"value\": \"Base64(ciphertext)\",",
    "\"mac\"  : \"HMAC_SHA256(iv||value, APP_KEY)\",",
    "\"tag\"  : \"\"                 // only used for AEAD ciphers (GCM)",
    "`encrypt($value, $serialize=true)` will `serialize()` the plaintext by default, whereas",
    "`decrypt($payload, $unserialize=true)` **will automatically `unserialize()`** the decrypted value.",
    "Therefore **any attacker that knows the 32-byte secret `APP_KEY` can craft an encrypted PHP serialized object and gain RCE via magic methods (`__wakeup`, `__destruct`, \u2026)**."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/laravel.md"
  ]
}