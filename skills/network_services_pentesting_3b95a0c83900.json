{
  "id": "network_services_pentesting_3b95a0c83900",
  "category": "network-services-pentesting",
  "title": "cisco snmp",
  "description": "# Cisco SNMP\n\n{{#include ../../banners/hacktricks-training.md}}\n\n\n## Pentesting Cisco Networks\n\n**SNMP** functions over UDP with ports **161/UDP** for general messages and **162/UDP** for trap messages. This protocol relies on *community strings*, serving as plaintext \"passwords\" that enable communication between SNMP agents and managers. These strings determine the access level, specifically **read-only (RO) or read-write (RW) permissions**.\n\nA classic\u2014yet still extremely effective\u2014attack vecto",
  "payloads": [
    "# Cisco SNMP",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Pentesting Cisco Networks",
    "**SNMP** functions over UDP with ports **161/UDP** for general messages and **162/UDP** for trap messages. This protocol relies on *community strings*, serving as plaintext \"passwords\" that enable communication between SNMP agents and managers. These strings determine the access level, specifically **read-only (RO) or read-write (RW) permissions**.",
    "A classic\u2014yet still extremely effective\u2014attack vector is to **brute-force community strings** in order to elevate from unauthenticated user to device administrator (RW community).",
    "A practical tool for this task is [**onesixtyone**](https://github.com/trailofbits/onesixtyone):",
    "```bash",
    "onesixtyone -c community_strings.txt -i targets.txt",
    "Other fast options are the Nmap NSE script `snmp-brute` or Hydra's SNMP module:",
    "```bash",
    "nmap -sU -p161 --script snmp-brute --script-args brute.community=wordlist 10.0.0.0/24",
    "hydra -P wordlist.txt -s 161 10.10.10.1 snmp",
    "### Dumping configuration through SNMP (CISCO-CONFIG-COPY-MIB)",
    "If you obtain an **RW community** you can copy the running-config/startup-config to a TFTP/FTP server *without CLI access* by abusing the CISCO-CONFIG-COPY-MIB (`1.3.6.1.4.1.9.9.96`). Two common approaches are:",
    "1. **Nmap NSE \u2013 `snmp-ios-config`**"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-snmp/cisco-snmp.md"
  ]
}