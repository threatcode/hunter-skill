{
  "id": "pentesting_web_af417bbca1c3",
  "category": "pentesting-web",
  "title": "prototype pollution to rce",
  "description": "# Prototype Pollution to RCE\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Vulnerable Code\n\nImagine a real JS using some code like the following one:\n\n```javascript\nconst { execSync, fork } = require(\"child_process\")\n\nfunction isObject(obj) {\n  console.log(typeof obj)\n  return typeof obj === \"function\" || typeof obj === \"object\"\n}\n\n// Function vulnerable to prototype pollution\nfunction merge(target, source) {\n  for (let key in source) {\n    if (isObject(target[key]) && isObject(sourc",
  "payloads": [
    "# Prototype Pollution to RCE",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Vulnerable Code",
    "Imagine a real JS using some code like the following one:",
    "```javascript",
    "const { execSync, fork } = require(\"child_process\")",
    "function isObject(obj) {",
    "console.log(typeof obj)",
    "return typeof obj === \"function\" || typeof obj === \"object\"",
    "// Function vulnerable to prototype pollution",
    "function merge(target, source) {",
    "for (let key in source) {",
    "if (isObject(target[key]) && isObject(source[key])) {",
    "merge(target[key], source[key])",
    "} else {"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/nodejs-proto-prototype-pollution/prototype-pollution-to-rce.md"
  ]
}