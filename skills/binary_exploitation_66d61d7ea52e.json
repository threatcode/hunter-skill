{
  "id": "binary_exploitation_66d61d7ea52e",
  "category": "binary-exploitation",
  "title": "off by one overflow",
  "description": "# Off by one overflow\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nHaving just access to a 1B overflow allows an attacker to modify the `size` field from the next chunk. This allows to tamper which chunks are actually freed, potentially generating a chunk that contains another legit chunk. The exploitation is similar to [double free](double-free.md) or overlapping chunks.\n\nThere are 2 types of off by one vulnerabilities:\n\n- Arbitrary byte: This kind allows to overwri",
  "payloads": [
    "# Off by one overflow",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "Having just access to a 1B overflow allows an attacker to modify the `size` field from the next chunk. This allows to tamper which chunks are actually freed, potentially generating a chunk that contains another legit chunk. The exploitation is similar to [double free](double-free.md) or overlapping chunks.",
    "There are 2 types of off by one vulnerabilities:",
    "- Arbitrary byte: This kind allows to overwrite that byte with any value",
    "- Null byte (off-by-null): This kind allows to overwrite that byte only with 0x00",
    "- A common example of this vulnerability can be seen in the following code where the behavior of `strlen` and `strcpy` is inconsistent, which allows set a 0x00 byte in the beginning of the next chunk.",
    "- This can be expoited with the [House of Einherjar](house-of-einherjar.md).",
    "- If using Tcache, this can be leveraged to a [double free](double-free.md) situation.",
    "<details>",
    "<summary>Off-by-null</summary>",
    "// From https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/off_by_one/",
    "int main(void)",
    "char buffer[40]=\"\";"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/off-by-one-overflow.md"
  ]
}