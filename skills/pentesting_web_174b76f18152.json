{
  "id": "pentesting_web_174b76f18152",
  "category": "pentesting-web",
  "title": "server side xss dynamic pdf",
  "description": "# Server Side XSS (Dynamic PDF)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Server Side XSS (Dynamic PDF)\n\nIf a web page is creating a PDF using user controlled input, you can try to **trick the bot** that is creating the PDF into **executing arbitrary JS code**.\\\nSo, if the **PDF creator bot finds** some kind of **HTML** **tags**, it is going to **interpret** them, and you can **abuse** this behaviour to cause a **Server XSS**.\n\nPlease, notice that the `<script></script>` tags don't ",
  "payloads": [
    "# Server Side XSS (Dynamic PDF)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Server Side XSS (Dynamic PDF)",
    "If a web page is creating a PDF using user controlled input, you can try to **trick the bot** that is creating the PDF into **executing arbitrary JS code**.\\",
    "So, if the **PDF creator bot finds** some kind of **HTML** **tags**, it is going to **interpret** them, and you can **abuse** this behaviour to cause a **Server XSS**.",
    "Please, notice that the `<script></script>` tags don't work always, so you will need a different method to execute JS (for example, abusing `<img` ).\\",
    "Also, note that in a regular exploitation you will be **able to see/download the created pdf**, so you will be able to see everything you **write via JS** (using `document.write()` for example). But, if you **cannot see** the created PDF, you will probably need **extract the information making web request to you** (Blind).",
    "### Popular PDF generation",
    "- **wkhtmltopdf** is known for its ability to convert HTML and CSS into PDF documents, utilizing the WebKit rendering engine. This tool is available as an open-source command line utility, making it accessible for a wide range of applications.",
    "- **TCPDF** offers a robust solution within the PHP ecosystem for PDF generation. It is capable of handling images, graphics, and encryption, showcasing its versatility for creating complex documents.",
    "- For those working in a Node.js environment, **PDFKit** presents a viable option. It enables the generation of PDF documents directly from HTML and CSS, providing a bridge between web content and printable formats.",
    "- Java developers might prefer **iText**, a library that not only facilitates PDF creation but also supports advanced features like digital signatures and form filling. Its comprehensive feature set makes it suitable for generating secure and interactive documents.",
    "- **FPDF** is another PHP library, distinguished by its simplicity and ease of use. It's designed for developers looking for a straightforward approach to PDF generation, without the need for extensive features.",
    "## Payloads",
    "### Discovery"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf.md"
  ]
}