{
  "id": "mobile_pentesting_d2d36a3f4158",
  "category": "mobile-pentesting",
  "title": "zero click messaging image parser chains",
  "description": "# Zero-click Messaging \u2192 Image Parser Chains\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## TL;DR\n\n- Treat **messaging app multi-device/companion protocols** as remote control channels: if protocol fields are assumed to come from trusted devices, they might still be user-controlled and can often be replayed directly against a victim to load arbitrary content with **0 user interaction**.\n- Once any app can be coerced into fetching untrusted media, target the **shared OS media pipeline** (",
  "payloads": [
    "# Zero-click Messaging \u2192 Image Parser Chains",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## TL;DR",
    "- Treat **messaging app multi-device/companion protocols** as remote control channels: if protocol fields are assumed to come from trusted devices, they might still be user-controlled and can often be replayed directly against a victim to load arbitrary content with **0 user interaction**.",
    "- Once any app can be coerced into fetching untrusted media, target the **shared OS media pipeline** (RawCamera on iOS/macOS, vendor parsers on Android OEM builds) with malformed files to pivot out of the sandbox.",
    "- The DNG-based RawCamera and Samsung parser bugs discussed here are concrete examples, but the full technique is a reusable blueprint for chaining **logic flaws \u2192 image parser memory corruption \u2192 full device compromise**.",
    "## Remote content loading via WhatsApp linked-device commands",
    "### Attack surface recap",
    "The WhatsApp \"linked devices\" architecture keeps the primary phone and every companion (desktop, tablet, secondary phone) in sync via encrypted, structured protocol messages. Each message encodes:",
    "- **Device metadata** (device ID, capabilities, feature flags).",
    "- **Action descriptors** (e.g., sync chats, fetch thumbnails, render remote content).",
    "- **Arbitrary parameters** such as URIs, MIME hints, pagination keys, etc.",
    "On Apple clients, the handler that processes these linked-device control packets **implicitly trusted** that a valid pairing already occurred, so high-impact fields (e.g., `resource_url`, `open_media`, `sync_snapshot`) were only minimally validated. A malicious companion message could therefore:",
    "1. Be routed to any account identified by its phone number.",
    "2. Survive the transport stack (Noise protocol + WhatsApp protobuf framing) because the receiver never verified that the sender was a legitimately paired device."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/ios-pentesting/zero-click-messaging-image-parser-chains.md"
  ]
}