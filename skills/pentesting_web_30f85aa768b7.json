{
  "id": "pentesting_web_30f85aa768b7",
  "category": "pentesting-web",
  "title": "race condition",
  "description": "# Race Condition\n\n{{#include ../banners/hacktricks-training.md}}\n\n> [!WARNING]\n> For obtaining a deep understanding of this technique check the original report in [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)\n\n## Enhancing Race Condition Attacks\n\nThe main hurdle in taking advantage of race conditions is making sure that multiple requests are handled at the same time, with **very little difference in their processing tim",
  "payloads": [
    "# Race Condition",
    "{{#include ../banners/hacktricks-training.md}}",
    "> [!WARNING]",
    "> For obtaining a deep understanding of this technique check the original report in [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)",
    "## Enhancing Race Condition Attacks",
    "The main hurdle in taking advantage of race conditions is making sure that multiple requests are handled at the same time, with **very little difference in their processing times\u2014ideally, less than 1ms**.",
    "Here you can find some techniques for Synchronizing Requests:",
    "#### HTTP/2 Single-Packet Attack vs. HTTP/1.1 Last-Byte Synchronization",
    "- **HTTP/2**: Supports sending two requests over a single TCP connection, reducing network jitter impact. However, due to server-side variations, two requests may not suffice for a consistent race condition exploit.",
    "- **HTTP/1.1 'Last-Byte Sync'**: Enables the pre-sending of most parts of 20-30 requests, withholding a small fragment, which is then sent together, achieving simultaneous arrival at the server.",
    "**Preparation for Last-Byte Sync** involves:",
    "1. Sending headers and body data minus the final byte without ending the stream.",
    "2. Pausing for 100ms post-initial send.",
    "3. Disabling TCP_NODELAY to utilize Nagle's algorithm for batching final frames.",
    "4. Pinging to warm up the connection."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/race-condition.md"
  ]
}