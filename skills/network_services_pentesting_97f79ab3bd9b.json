{
  "id": "network_services_pentesting_97f79ab3bd9b",
  "category": "network-services-pentesting",
  "title": "dotnetnuke dnn",
  "description": "# DotNetNuke (DNN)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## DotNetNuke (DNN)\n\nIf you enter as **administrator** in DNN it's easy to obtain **RCE**, however a number of *unauthenticated* and *post-auth* techniques have been published in the last few years.  The following cheat-sheet collects the most useful primitives for both offensive and defensive work.\n\n---\n## Version & Environment Enumeration\n\n* Check the *X-DNN* HTTP response header \u2013 it usually discloses the exact platform ve",
  "payloads": [
    "# DotNetNuke (DNN)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## DotNetNuke (DNN)",
    "If you enter as **administrator** in DNN it's easy to obtain **RCE**, however a number of *unauthenticated* and *post-auth* techniques have been published in the last few years.  The following cheat-sheet collects the most useful primitives for both offensive and defensive work.",
    "## Version & Environment Enumeration",
    "* Check the *X-DNN* HTTP response header \u2013 it usually discloses the exact platform version.",
    "* The installation wizard leaks the version in `/Install/Install.aspx?mode=install` (accessible on very old installs).",
    "* `/API/PersonaBar/GetStatus` (9.x) returns a JSON blob containing `\"dnnVersion\"` for low-privilege users.",
    "* Typical cookies you will see on a live instance:",
    "* `.DOTNETNUKE` \u2013 ASP.NET forms authentication ticket.",
    "* `DNNPersonalization` \u2013 contains XML/serialized user profile data (old versions \u2013 see RCE below).",
    "## Unauthenticated Exploitation",
    "### 1. Cookie Deserialization RCE  (CVE-2017-9822 & follow-ups)",
    "*Affected versions \u2264 9.3.0-RC*",
    "`DNNPersonalization` is deserialized on every request when the built-in 404 handler is enabled.  Crafted XML can therefore lead to arbitrary gadget chains and code execution."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/dotnetnuke-dnn.md"
  ]
}