{
  "id": "binary_exploitation_4e69077629ec",
  "category": "binary-exploitation",
  "title": "posix cpu timers toctou cve 2025 38352",
  "description": "# POSIX CPU Timers TOCTOU race (CVE-2025-38352)\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThis page documents a TOCTOU race condition in Linux/Android POSIX CPU timers that can corrupt timer state and crash the kernel, and under some circumstances be steered toward privilege escalation.\n\n- Affected component: kernel/time/posix-cpu-timers.c\n- Primitive: expiry vs deletion race under task exit\n- Config sensitive: CONFIG_POSIX_CPU_TIMERS_TASK_WORK=n (IRQ-context expiry path)\n\nQuick intern",
  "payloads": [
    "# POSIX CPU Timers TOCTOU race (CVE-2025-38352)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "This page documents a TOCTOU race condition in Linux/Android POSIX CPU timers that can corrupt timer state and crash the kernel, and under some circumstances be steered toward privilege escalation.",
    "- Affected component: kernel/time/posix-cpu-timers.c",
    "- Primitive: expiry vs deletion race under task exit",
    "- Config sensitive: CONFIG_POSIX_CPU_TIMERS_TASK_WORK=n (IRQ-context expiry path)",
    "Quick internals recap (relevant for exploitation)",
    "- Three CPU clocks drive accounting for timers via cpu_clock_sample():",
    "- CPUCLOCK_PROF: utime + stime",
    "- CPUCLOCK_VIRT: utime only",
    "- CPUCLOCK_SCHED: task_sched_runtime()",
    "- Timer creation wires a timer to a task/pid and initializes the timerqueue nodes:",
    "static int posix_cpu_timer_create(struct k_itimer *new_timer) {",
    "struct pid *pid;",
    "rcu_read_lock();"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/linux-kernel-exploitation/posix-cpu-timers-toctou-cve-2025-38352.md"
  ]
}