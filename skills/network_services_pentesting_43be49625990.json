{
  "id": "network_services_pentesting_43be49625990",
  "category": "network-services-pentesting",
  "title": "electron contextisolation rce via preload code",
  "description": "# Electron contextIsolation RCE via preload code\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Example 1\n\nExample from [https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=30](https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=30)\n\nThis code open http(s) links with default browser:\n\n![](<../../../images/image (768).png>)\n\nSomething like `file:///C:/Windows/systemd32/calc.exe` could ",
  "payloads": [
    "# Electron contextIsolation RCE via preload code",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Example 1",
    "Example from [https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=30](https://speakerdeck.com/masatokinugawa/electron-abusing-the-lack-of-context-isolation-curecon-en?slide=30)",
    "This code open http(s) links with default browser:",
    "![](<../../../images/image (768).png>)",
    "Something like `file:///C:/Windows/systemd32/calc.exe` could be used to execute a calc, the `SAFE_PROTOCOLS.indexOf` is preventing it.",
    "Therefore, an attacker could inject this JS code via the XSS or arbitrary page navigation:",
    "```html",
    "<script>",
    "Array.prototype.indexOf = function () {",
    "return 1337",
    "</script>",
    "As the call to `SAFE_PROTOCOLS.indexOf` will return 1337 always, the attacker can bypass the protection and execute the calc. Final exploit:",
    "```html"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-preload-code.md"
  ]
}