{
  "id": "network_services_pentesting_ae51dde30222",
  "category": "network-services-pentesting",
  "title": "grafana",
  "description": "# Grafana\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Interesting stuff\n\n- The file **`/etc/grafana/grafana.ini`** can contain sensitive information such as **admin** **username** and **password.**\n- Inside the platform you could **invite people** or **generate API keys** (might need to be admin)\n- You could check which plugins are installed (or even install new)\n- By default it uses **SQLite3** database in **`/var/lib/grafana/grafana.db`**\n  - `select user,password,database from data",
  "payloads": [
    "# Grafana",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Interesting stuff",
    "- The file **`/etc/grafana/grafana.ini`** can contain sensitive information such as **admin** **username** and **password.**",
    "- Inside the platform you could **invite people** or **generate API keys** (might need to be admin)",
    "- You could check which plugins are installed (or even install new)",
    "- By default it uses **SQLite3** database in **`/var/lib/grafana/grafana.db`**",
    "- `select user,password,database from data_source;`",
    "## CVE-2024-9264 \u2013 SQL Expressions (DuckDB shellfs) post-auth RCE / LFI",
    "Grafana\u2019s experimental SQL Expressions feature can evaluate DuckDB queries that embed user-controlled text. Insufficient sanitization allows attackers to chain DuckDB statements and load the community extension shellfs, which exposes shell commands via pipe-backed virtual files.",
    "Impact",
    "- Any authenticated user with VIEWER or higher can get code execution as the Grafana OS user (often grafana; sometimes root inside a container) or perform local file reads.",
    "- Preconditions commonly met in real deployments:",
    "- SQL Expressions enabled: `expressions.enabled = true`",
    "- `duckdb` binary present in PATH on the server"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/grafana.md"
  ]
}