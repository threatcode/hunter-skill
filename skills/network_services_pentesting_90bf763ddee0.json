{
  "id": "network_services_pentesting_90bf763ddee0",
  "category": "network-services-pentesting",
  "title": "nfs service pentesting",
  "description": "# 2049 - Pentesting NFS Service\n\n{{#include ../banners/hacktricks-training.md}}\n\n## **Basic Information**\n\n**NFS** is a system designed for **client/server** that enables users to seamlessly access files over a network as though these files were located within a local directory.\n\n**Default port**: 2049/TCP/UDP (except version 4, it just needs TCP or UDP).\n\n```\n2049/tcp open  nfs     2-3 (RPC #100003\n```\n\n### Authentication\n\nA notable aspect of this protocol is its usual lack of built-in **authen",
  "payloads": [
    "# 2049 - Pentesting NFS Service",
    "{{#include ../banners/hacktricks-training.md}}",
    "## **Basic Information**",
    "**NFS** is a system designed for **client/server** that enables users to seamlessly access files over a network as though these files were located within a local directory.",
    "**Default port**: 2049/TCP/UDP (except version 4, it just needs TCP or UDP).",
    "2049/tcp open  nfs     2-3 (RPC #100003",
    "### Authentication",
    "A notable aspect of this protocol is its usual lack of built-in **authentication** or **authorization mechanisms**. Instead, authorization relies on **file system information**, with the server tasked with accurately translating **client-provided user information** into the file system's required **authorization format**, primarily following **UNIX syntax**.",
    "Authentication commonly relies on **UNIX `UID`/`GID` identifiers and group memberships**. However, a challenge arises due to the potential mismatch in **`UID`/`GID` mappings** between clients and servers, leaving no room for additional verification by the server. Moreover, these details are sent by the client and trusted by the server, so a rogue client could potentially **impersonate another user sending more privileged `uid` and `gid`s.",
    "**However, note that by default it's not possible to impersonate the `UID` 0 (root) using NFS. More on this ins the squashing section.**",
    "#### Hosts",
    "For better (or some) authorization, you can specify the **hosts** that can access the NFS share. This can be done in the Linux `/etc/exports` file. For example:",
    "/PATH/TO/EXPORT\u00a0\u00a0\u00a0\u00a0\u00a0 CLIENT1(OPTIONS1) CLIENT2(OPTIONS2) ...",
    "/media/disk/share\u00a0\u00a0 192.168.2.123(rw,sec=krb5p:krb5i)",
    "As you can see, it allows to configure a specific **IP** or **hostname** to access the share. Only that address will be able to access the share."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/nfs-service-pentesting.md"
  ]
}