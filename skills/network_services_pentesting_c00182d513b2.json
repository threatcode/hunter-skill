{
  "id": "network_services_pentesting_c00182d513b2",
  "category": "network-services-pentesting",
  "title": "imagemagick security",
  "description": "# ImageMagick Security\n\n{{#include ../../banners/hacktricks-training.md}}\n\nCheck further details in [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)\n\nImageMagick, a versatile image processing library, presents a challenge in configuring its security policy due to its extensive options and lack of detailed online documentation. Users often create policies based on fragmented inter",
  "payloads": [
    "# ImageMagick Security",
    "{{#include ../../banners/hacktricks-training.md}}",
    "Check further details in [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)",
    "ImageMagick, a versatile image processing library, presents a challenge in configuring its security policy due to its extensive options and lack of detailed online documentation. Users often create policies based on fragmented internet sources, leading to potential misconfigurations. The library supports a vast array of over 100 image formats, each contributing to its complexity and vulnerability profile, as demonstrated by historical security incidents.",
    "## Towards Safer Policies",
    "To address these challenges, a [tool has been developed](https://imagemagick-secevaluator.doyensec.com/) to aid in designing and auditing ImageMagick's security policies. This tool is rooted in extensive research and aims to ensure policies are not only robust but also free from loopholes that could be exploited.",
    "## Allowlist vs Denylist Approach",
    "Historically, ImageMagick policies relied on a denylist approach, where specific coders were denied access. However, changes in ImageMagick 6.9.7-7 shifted this paradigm, enabling an allowlist approach. This approach first denies all coders and then selectively grants access to trusted ones, enhancing the security posture.",
    "```xml",
    "<policy domain=\"coder\" rights=\"none\" pattern=\"*\" />",
    "<policy domain=\"coder\" rights=\"read | write\" pattern=\"{GIF,JPEG,PNG,WEBP}\" />",
    "## Case Sensitivity in Policies",
    "It's crucial to note that policy patterns in ImageMagick are case sensitive. As such, ensuring that coders and modules are correctly upper-cased in policies is vital to prevent unintended permissions.",
    "## Resource Limits",
    "ImageMagick is prone to denial of service attacks if not properly configured. Setting explicit resource limits in the policy is essential to prevent such vulnerabilities."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/imagemagick-security.md"
  ]
}