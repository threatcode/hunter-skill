{
  "id": "network_services_pentesting_756e2b3f2da7",
  "category": "network-services-pentesting",
  "title": "uncovering cloudflare",
  "description": "# Uncovering CloudFlare\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Common Techniques to Uncover Cloudflare\n\n- You can use some service that gives you the **historical DNS records** of the domain. Maybe the web page is running on an IP address used before.\n  - Same could be achieve **checking historical SSL certificates** that could be pointing to the origin IP address.\n  - Check also **DNS records of other subdomains pointing directly to IPs**, as it's possible that other subdomains ",
  "payloads": [
    "# Uncovering CloudFlare",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Common Techniques to Uncover Cloudflare",
    "- You can use some service that gives you the **historical DNS records** of the domain. Maybe the web page is running on an IP address used before.",
    "- Same could be achieve **checking historical SSL certificates** that could be pointing to the origin IP address.",
    "- Check also **DNS records of other subdomains pointing directly to IPs**, as it's possible that other subdomains are pointing to the same server (maybe to offer FTP, mail or any other service).",
    "- If you find a **SSRF inside the web application** you can abuse it to obtain the IP address of the server.",
    "- Search a unique string of the web page in browsers such as shodan (and maybe google and similar?). Maybe you can find an IP address with that content.",
    "- In a similar way instead of looking for a uniq string you could search for the favicon icon with the tool: [https://github.com/karma9874/CloudFlare-IP](https://github.com/karma9874/CloudFlare-IP) or with [https://github.com/pielco11/fav-up](https://github.com/pielco11/fav-up)",
    "- This won't work be very frequently because the server must send the same response when it's accessed by the IP address, but you never know.",
    "## Tools to uncover Cloudflare",
    "- Search for the domain inside [http://www.crimeflare.org:82/cfs.html](http://www.crimeflare.org:82/cfs.html) or [https://crimeflare.herokuapp.com](https://crimeflare.herokuapp.com). Or use the tool [CloudPeler](https://github.com/zidansec/CloudPeler) (which uses that API)",
    "- Search for the domain in [https://leaked.site/index.php?resolver/cloudflare.0/](https://leaked.site/index.php?resolver/cloudflare.0/)",
    "- [**CF-Hero**](https://github.com/musana/CF-Hero) is a comprehensive reconnaissance tool developed to discover the real IP addresses of web applications protected by Cloudflare. It performs multi-source intelligence gathering through various methods.",
    "- [**CloudFlair**](https://github.com/christophetd/CloudFlair) is a tool that will search using Censys certificates that contains the domain name, then it will search for IPv4s inside those certificates and finally it will try to access the web page in those IPs."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/uncovering-cloudflare.md"
  ]
}