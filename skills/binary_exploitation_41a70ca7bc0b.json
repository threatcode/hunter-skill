{
  "id": "binary_exploitation_41a70ca7bc0b",
  "category": "binary-exploitation",
  "title": "heap functions security checks",
  "description": "# Heap Functions Security Checks\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## unlink\n\nFor more info check:\n\n\n{{#ref}}\nunlink.md\n{{#endref}}\n\nThis is a summary of the performed checks:\n\n- Check if the indicated size of the chunk is the same as the `prev_size` indicated in the next chunk\n  - Error message: `corrupted size vs. prev_size`\n- Check also that `P->fd->bk == P` and `P->bk->fw == P`\n  - Error message: `corrupted double-linked list`\n- If the chunk is not small, check that `P->",
  "payloads": [
    "# Heap Functions Security Checks",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## unlink",
    "For more info check:",
    "{{#ref}}",
    "unlink.md",
    "{{#endref}}",
    "This is a summary of the performed checks:",
    "- Check if the indicated size of the chunk is the same as the `prev_size` indicated in the next chunk",
    "- Error message: `corrupted size vs. prev_size`",
    "- Check also that `P->fd->bk == P` and `P->bk->fw == P`",
    "- Error message: `corrupted double-linked list`",
    "- If the chunk is not small, check that `P->fd_nextsize->bk_nextsize == P` and `P->bk_nextsize->fd_nextsize == P`",
    "- Error message: `corrupted double-linked list (not small)`",
    "## \\_int_malloc"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/heap-memory-functions/heap-functions-security-checks.md"
  ]
}