{
  "id": "binary_exploitation_50b5f2ebe0bc",
  "category": "binary-exploitation",
  "title": "ret2plt",
  "description": "# Ret2plt\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nThe goal of this technique would be to **leak an address from a function from the PLT** to be able to bypass ASLR. This is because if, for example, you leak the address of the function `puts` from the libc, you can then **calculate where is the base of `libc`** and calculate offsets to access other functions such as **`system`**.\n\nThis can be done with a `pwntools` payload such as ([**from here**](https://ir0n",
  "payloads": [
    "# Ret2plt",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "The goal of this technique would be to **leak an address from a function from the PLT** to be able to bypass ASLR. This is because if, for example, you leak the address of the function `puts` from the libc, you can then **calculate where is the base of `libc`** and calculate offsets to access other functions such as **`system`**.",
    "This can be done with a `pwntools` payload such as ([**from here**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt_and_got)):",
    "```python",
    "# 32-bit ret2plt",
    "payload = flat(",
    "b'A' * padding,",
    "elf.plt['puts'],",
    "elf.symbols['main'],",
    "elf.got['puts']",
    "# 64-bit",
    "payload = flat(",
    "b'A' * padding,"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/common-binary-protections-and-bypasses/aslr/ret2plt.md"
  ]
}