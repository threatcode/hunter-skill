{
  "id": "pentesting_web_724b23d9b3ff",
  "category": "pentesting-web",
  "title": "lfi2rce via eternal waiting",
  "description": "# LFI2RCE via Eternal waiting\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nBy default when a file is uploaded to PHP (even if it isn't expecting it), it will generate a temporary file in `/tmp` with a name such as **`php[a-zA-Z0-9]{6}`**, although I have seen some docker images where the generated files don't contain digits.\n\nIn a local file inclusion, **if you manage to include that uploaded file, you will get RCE**.\n\nNote that by default **PHP only allows to upload",
  "payloads": [
    "# LFI2RCE via Eternal waiting",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "By default when a file is uploaded to PHP (even if it isn't expecting it), it will generate a temporary file in `/tmp` with a name such as **`php[a-zA-Z0-9]{6}`**, although I have seen some docker images where the generated files don't contain digits.",
    "In a local file inclusion, **if you manage to include that uploaded file, you will get RCE**.",
    "Note that by default **PHP only allows to upload 20 files in a single request** (set in `/etc/php/<version>/apache2/php.ini`):",
    "; Maximum number of files that can be uploaded via a single request",
    "max_file_uploads = 20",
    "Also, the **number of potential filenames are 62\\*62\\*62\\*62\\*62\\*62 = 56800235584**",
    "### Other techniques",
    "Other techniques relies in attacking PHP protocols (you won't be able if you only control the last part of the path), disclosing the path of the file, abusing expected files, or **making PHP suffer a segmentation fault so uploaded temporary files aren't deleted**.\\",
    "This technique is **very similar to the last one but without needed to find a zero day**.",
    "### Eternal wait technique",
    "In this technique **we only need to control a relative path**. If we manage to upload files and make the **LFI never end**, we will have \"enough time\" to **brute-force uploaded files** and **find** any of the ones uploaded.",
    "**Pros of this technique**:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/file-inclusion/lfi2rce-via-eternal-waiting.md"
  ]
}