{
  "id": "binary_exploitation_dd3c98e1ff16",
  "category": "binary-exploitation",
  "title": "house of lore",
  "description": "# House of Lore | Small bin Attack\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\n### Code\n\n- Check the one from [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house_of_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house_of_lore/)\n  - This isn't working\n- Or: [https://github.com/shellphish/how2heap/blob/master/glibc_2.39/house_of_lore.c](https://github.com/shellphish/how2heap/blob/master/glibc_2.39/house_of_lore.c)\n  - This isn't working even if it tries t",
  "payloads": [
    "# House of Lore | Small bin Attack",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "### Code",
    "- Check the one from [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house_of_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house_of_lore/)",
    "- This isn't working",
    "- Or: [https://github.com/shellphish/how2heap/blob/master/glibc_2.39/house_of_lore.c](https://github.com/shellphish/how2heap/blob/master/glibc_2.39/house_of_lore.c)",
    "- This isn't working even if it tries to bypass some checks getting the error: `malloc(): unaligned tcache chunk detected`",
    "- This example is still working: [**https://guyinatuxedo.github.io/40-house_of_lore/house_lore_exp/index.html**](https://guyinatuxedo.github.io/40-house_of_lore/house_lore_exp/index.html)",
    "### Goal",
    "- Insert a **fake small chunk in the small bin so then it's possible to allocate it**.\\",
    "Note that the small chunk added is the fake one the attacker creates and not a fake one in an arbitrary position.",
    "### Requirements",
    "- Create 2 fake chunks and link them together and with the legit chunk in the small bin:",
    "- `fake0.bk` -> `fake1`"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/house-of-lore.md"
  ]
}