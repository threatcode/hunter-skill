{
  "id": "windows_hardening_7ec05f679cbb",
  "category": "windows-hardening",
  "title": "shadow credentials",
  "description": "# Shadow Credentials\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Intro <a href=\"#3f17\" id=\"3f17\"></a>\n\n**Check the original post for [all the information about this technique](https://posts.specterops.io/shadow-credentials-abusing-key-trust-account-mapping-for-takeover-8ee1a53566ab).**\n\nAs **summary**: if you can write to the **msDS-KeyCredentialLink** property of a user/computer, you can retrieve the **NT hash of that object**.\n\nIn the post, a method is outlined for setting up **p",
  "payloads": [
    "# Shadow Credentials",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Intro <a href=\"#3f17\" id=\"3f17\"></a>",
    "**Check the original post for [all the information about this technique](https://posts.specterops.io/shadow-credentials-abusing-key-trust-account-mapping-for-takeover-8ee1a53566ab).**",
    "As **summary**: if you can write to the **msDS-KeyCredentialLink** property of a user/computer, you can retrieve the **NT hash of that object**.",
    "In the post, a method is outlined for setting up **public-private key authentication credentials** to acquire a unique **Service Ticket** that includes the target's NTLM hash. This process involves the encrypted NTLM_SUPPLEMENTAL_CREDENTIAL within the Privilege Attribute Certificate (PAC), which can be decrypted.",
    "### Requirements",
    "To apply this technique, certain conditions must be met:",
    "- A minimum of one Windows Server 2016 Domain Controller is needed.",
    "- The Domain Controller must have a server authentication digital certificate installed.",
    "- The Active Directory must be at the Windows Server 2016 Functional Level.",
    "- An account with delegated rights to modify the msDS-KeyCredentialLink attribute of the target object is required.",
    "## Abuse",
    "The abuse of Key Trust for computer objects encompasses steps beyond obtaining a Ticket Granting Ticket (TGT) and the NTLM hash. The options include:",
    "1. Creating an **RC4 silver ticket** to act as privileged users on the intended host."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/windows-hardening/active-directory-methodology/acl-persistence-abuse/shadow-credentials.md"
  ]
}