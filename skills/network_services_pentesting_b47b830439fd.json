{
  "id": "network_services_pentesting_b47b830439fd",
  "category": "network-services-pentesting",
  "title": "ruby tricks",
  "description": "# Ruby Tricks\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## File upload to RCE\n\nAs explained in [this article](https://www.offsec.com/blog/cve-2024-46986/), uploading a `.rb` file into sensitive directories such as `config/initializers/` can lead to remote code execution (RCE) in Ruby on Rails applications.\n\nTips:\n- Other boot/eager-load locations that are executed on app start are also risky when writeable (e.g., `config/initializers/` is the classic one). If you find an arbitrary file",
  "payloads": [
    "# Ruby Tricks",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## File upload to RCE",
    "As explained in [this article](https://www.offsec.com/blog/cve-2024-46986/), uploading a `.rb` file into sensitive directories such as `config/initializers/` can lead to remote code execution (RCE) in Ruby on Rails applications.",
    "- Other boot/eager-load locations that are executed on app start are also risky when writeable (e.g., `config/initializers/` is the classic one). If you find an arbitrary file upload that lands anywhere under `config/` and is later evaluated/required, you may obtain RCE at boot.",
    "- Look for dev/staging builds that copy user-controlled files into the container image where Rails will load them on boot.",
    "## Active Storage image transformation \u2192 command execution (CVE-2025-24293)",
    "When an application uses Active Storage with `image_processing` + `mini_magick`, and passes untrusted parameters to image transformation methods, Rails versions prior to 7.1.5.2 / 7.2.2.2 / 8.0.2.1 could allow command injection because some transformation methods were mistakenly allowed by default.",
    "- A vulnerable pattern looks like:",
    "```erb",
    "<%= image_tag blob.variant(params[:t] => params[:v]) %>",
    "where `params[:t]` and/or `params[:v]` are attacker-controlled.",
    "- What to try during testing",
    "- Identify any endpoints that accept variant/processing options, transformation names, or arbitrary ImageMagick arguments.",
    "- Fuzz `params[:t]` and `params[:v]` for suspicious errors or execution side-effects. If you can influence the method name or pass raw arguments that reach MiniMagick, you may get code exec on the image processor host."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/ruby-tricks.md"
  ]
}