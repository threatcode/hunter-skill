{
  "id": "network_services_pentesting_82e13fb89d74",
  "category": "network-services-pentesting",
  "title": "4222 pentesting nats",
  "description": "# 4222 - Pentesting NATS / JetStream\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Basic Information\n\n**NATS** is a high-performance message bus that speaks a simple text-based protocol: the server transmits an `INFO { ... }` JSON banner immediately after TCP connect, and the client replies with a `CONNECT {\"user\":\"USERNAME\",\"pass\":\"PASSWORD\",...}` frame followed by optional `PING`/`PUB`/`SUB` commands. JetStream adds persistence primitives (Streams & Consumers) on top of the same TCP port",
  "payloads": [
    "# 4222 - Pentesting NATS / JetStream",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Basic Information",
    "**NATS** is a high-performance message bus that speaks a simple text-based protocol: the server transmits an `INFO { ... }` JSON banner immediately after TCP connect, and the client replies with a `CONNECT {\"user\":\"USERNAME\",\"pass\":\"PASSWORD\",...}` frame followed by optional `PING`/`PUB`/`SUB` commands. JetStream adds persistence primitives (Streams & Consumers) on top of the same TCP port (`4222/tcp`). TLS and authentication are optional, so many internal deployments run **plaintext AUTH**.",
    "* Default port: **4222/tcp** (4223+ for clustered routes)",
    "* Stock banner fields: `\"version\"`, `\"auth_required\"`, `\"jetstream\"`, `\"max_payload\"`, `\"tls_required\"`",
    "## Enumeration",
    "### Banner grabbing / service probes",
    "```bash",
    "nmap -p4222 -sV --script banner TARGET",
    "# Sample output",
    "# 4222/tcp open  nats  NATS.io gnatsd 2.11.3",
    "# | banner: INFO {\"server_id\":\"NDo...\",\"version\":\"2.11.3\",\"proto\":1,\"auth_required\":true,\"jetstream\":true,\"max_payload\":1048576}",
    "The INFO frame can also be pulled manually:",
    "```bash"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/4222-pentesting-nats.md"
  ]
}