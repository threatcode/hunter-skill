{
  "id": "pentesting_web_d74cfa1e65ae",
  "category": "pentesting-web",
  "title": "second order injection sqlmap",
  "description": "# Second Order Injection with SQLMap\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n**SQLMap can exploit Second Order SQLis.**\\\nYou need to provide:\n\n- The **request** where the **sqlinjection payload** is going to be saved\n- The **request** where the **payload** will be **executed**\n\nThe request where the SQL injection payload is saved is **indicated as in any other injection in sqlmap**. The request **where sqlmap can read the output/execution** of the injection can be indicated with `",
  "payloads": [
    "# Second Order Injection with SQLMap",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "**SQLMap can exploit Second Order SQLis.**\\",
    "You need to provide:",
    "- The **request** where the **sqlinjection payload** is going to be saved",
    "- The **request** where the **payload** will be **executed**",
    "The request where the SQL injection payload is saved is **indicated as in any other injection in sqlmap**. The request **where sqlmap can read the output/execution** of the injection can be indicated with `--second-url` or with `--second-req` if you need to indicate a complete request from a file.",
    "**Simple second order example:**",
    "```bash",
    "#Get the SQL payload execution with a GET to a url",
    "sqlmap -r login.txt -p username --second-url \"http://10.10.10.10/details.php\"",
    "#Get the SQL payload execution sending a custom request from a file",
    "sqlmap -r login.txt -p username --second-req details.txt",
    "In several cases **this won't be enough** because you will need to **perform other actions** apart from sending the payload and accessing a different page.",
    "When this is needed you can use a **sqlmap tamper**. For example the following script will register a new user **using sqlmap payload as email** and logout."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/sql-injection/sqlmap/second-order-injection-sqlmap.md"
  ]
}