{
  "id": "pentesting_web_558d02ecbba9",
  "category": "pentesting-web",
  "title": "mass assignment cwe 915",
  "description": "# Mass Assignment (CWE-915) \u2013 Privilege Escalation via Unsafe Model Binding\n\n{{#include ../banners/hacktricks-training.md}}\n\nMass assignment (a.k.a. insecure object binding) happens when an API/controller takes user-supplied JSON and directly binds it to a server-side model/entity without an explicit allow-list of fields. If privileged properties like roles, isAdmin, status, or ownership fields are bindable, any authenticated user can escalate privileges or tamper with protected state.\n\nThis is ",
  "payloads": [
    "# Mass Assignment (CWE-915) \u2013 Privilege Escalation via Unsafe Model Binding",
    "{{#include ../banners/hacktricks-training.md}}",
    "Mass assignment (a.k.a. insecure object binding) happens when an API/controller takes user-supplied JSON and directly binds it to a server-side model/entity without an explicit allow-list of fields. If privileged properties like roles, isAdmin, status, or ownership fields are bindable, any authenticated user can escalate privileges or tamper with protected state.",
    "This is a Broken Access Control issue (OWASP A01:2021) that often enables vertical privilege escalation by setting roles=ADMIN or similar. It commonly affects frameworks that support automatic binding of request bodies to data models (Rails, Laravel/Eloquent, Django ORM, Spring/Jackson, Express/Mongoose, Sequelize, Go structs, etc.).",
    "## 1) Finding Mass Assignment",
    "Look for self-service endpoints that update your own profile or similar resources:",
    "- PUT/PATCH /api/users/{id}",
    "- PATCH /me, PUT /profile",
    "- PUT /api/orders/{id}",
    "Heuristics indicating mass assignment:",
    "- The response echoes server-managed fields (e.g., roles, status, isAdmin, permissions) even when you didn\u2019t send them.",
    "- Client bundles contain role names/IDs or other privileged attribute names used throughout the app (admin, staff, moderator, internal flags), hinting bindable schema.",
    "- Backend serializers accept unknown fields without rejecting them.",
    "Quick test flow:",
    "1) Perform a normal update with only safe fields and observe the full JSON response structure (this leaks the schema)."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/mass-assignment-cwe-915.md"
  ]
}