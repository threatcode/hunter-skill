{
  "id": "pentesting_web_6ed71b4494bd",
  "category": "pentesting-web",
  "title": "pl pgsql password bruteforce",
  "description": "# PL/pgSQL Password Bruteforce\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n**Find [more information about these attack in the original paper](http://www.leidecker.info/pgshell/Having_Fun_With_PostgreSQL.txt)**.\n\nPL/pgSQL is a **fully featured programming language** that extends beyond the capabilities of SQL by offering **enhanced procedural control**. This includes the utilization of loops and various control structures. Functions crafted in the PL/pgSQL language can be invoked by SQ",
  "payloads": [
    "# PL/pgSQL Password Bruteforce",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "**Find [more information about these attack in the original paper](http://www.leidecker.info/pgshell/Having_Fun_With_PostgreSQL.txt)**.",
    "PL/pgSQL is a **fully featured programming language** that extends beyond the capabilities of SQL by offering **enhanced procedural control**. This includes the utilization of loops and various control structures. Functions crafted in the PL/pgSQL language can be invoked by SQL statements and triggers, broadening the scope of operations within the database environment.",
    "You can abuse this language in order to ask PostgreSQL to brute-force the users credentials, but it must exist on the database. You can verify it's existence using:",
    "```sql",
    "SELECT lanname,lanacl FROM pg_language WHERE lanname = 'plpgsql';",
    "lanname | lanacl",
    "---------+---------",
    "plpgsql |",
    "By default, **creating functions is a privilege granted to PUBLIC**, where PUBLIC refers to every user on that database system. To prevent this, the administrator could have had to revoke the USAGE privilege from the PUBLIC domain:",
    "```sql",
    "REVOKE ALL PRIVILEGES ON LANGUAGE plpgsql FROM PUBLIC;",
    "In that case, our previous query would output different results:",
    "```sql"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.md"
  ]
}