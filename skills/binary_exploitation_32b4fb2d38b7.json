{
  "id": "binary_exploitation_32b4fb2d38b7",
  "category": "binary-exploitation",
  "title": "large bin attack",
  "description": "# Large Bin Attack\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nFor more information about what is a large bin check this page:\n\n\n{{#ref}}\nbins-and-memory-allocations.md\n{{#endref}}\n\nIt's possible to find a great example in [**how2heap - large bin attack**](https://github.com/shellphish/how2heap/blob/master/glibc_2.35/large_bin_attack.c).\n\nBasically here you can see how, in the latest \"current\" version of glibc (2.35), it's not checked: **`P->bk_nextsize`** allowing ",
  "payloads": [
    "# Large Bin Attack",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "For more information about what is a large bin check this page:",
    "{{#ref}}",
    "bins-and-memory-allocations.md",
    "{{#endref}}",
    "It's possible to find a great example in [**how2heap - large bin attack**](https://github.com/shellphish/how2heap/blob/master/glibc_2.35/large_bin_attack.c).",
    "Basically here you can see how, in the latest \"current\" version of glibc (2.35), it's not checked: **`P->bk_nextsize`** allowing to modify an arbitrary address with the value of a large bin chunk if certain conditions are met.",
    "In that example you can find the following conditions:",
    "- A large chunk is allocated",
    "- A large chunk smaller than the first one but in the same index is allocated",
    "- Must be smalled so in the bin it must go first",
    "- (A chunk to prevent merging with the top chunk is created)",
    "- Then, the first large chunk is freed and a new chunk bigger than it is allocated -> Chunk1 goes to the large bin"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/large-bin-attack.md"
  ]
}