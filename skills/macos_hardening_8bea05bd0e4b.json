{
  "id": "macos_hardening_8bea05bd0e4b",
  "category": "macos-hardening",
  "title": "macos kernel vulnerabilities",
  "description": "# macOS Kernel Vulnerabilities\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## [Pwning OTA](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/)\n\n[**In this report**](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/) are explained several vulnerabilities that allowed to compromised the kernel compromising the software updater.\\\n[**PoC**](https://github.com/jhftss/POC/tree/main/CVE-2022-46722).\n\n---\n\n## 2024: In-the-wild Kernel 0-days (CVE-2024-23225 & CVE-2024-23296)",
  "payloads": [
    "# macOS Kernel Vulnerabilities",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## [Pwning OTA](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/)",
    "[**In this report**](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/) are explained several vulnerabilities that allowed to compromised the kernel compromising the software updater.\\",
    "[**PoC**](https://github.com/jhftss/POC/tree/main/CVE-2022-46722).",
    "## 2024: In-the-wild Kernel 0-days (CVE-2024-23225 & CVE-2024-23296)",
    "Apple patched two memory-corruption bugs that were actively exploited against iOS and macOS in March 2024 (fixed in macOS 14.4/13.6.5/12.7.4).",
    "* **CVE-2024-23225 \u2013 Kernel**",
    "\u2022 Out-of-bounds write in the XNU virtual-memory subsystem allows an unprivileged process to obtain arbitrary read/write in the kernel address space, bypassing PAC/KTRR.",
    "\u2022 Triggered from userspace via a crafted XPC message that overflows a buffer in `libxpc`, then pivots into the kernel when the message is parsed.",
    "* **CVE-2024-23296 \u2013 RTKit**",
    "\u2022 Memory corruption in the Apple Silicon RTKit (real-time co-processor).",
    "\u2022 Exploitation chains observed used CVE-2024-23225 for kernel R/W and CVE-2024-23296 to escape the secure co-processor sandbox and disable PAC.",
    "Patch level detection:",
    "```bash"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/macos-kernel-vulnerabilities.md"
  ]
}