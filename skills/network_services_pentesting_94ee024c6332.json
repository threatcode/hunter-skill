{
  "id": "network_services_pentesting_94ee024c6332",
  "category": "network-services-pentesting",
  "title": "ipsec ike vpn pentesting",
  "description": "# 500/udp - Pentesting IPsec/IKE VPN\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Basic Information\n\n**IPsec** is widely recognized as the principal technology for securing communications between networks (LAN-to-LAN) and from remote users to the network gateway (remote access), serving as the backbone for enterprise VPN solutions.\n\nThe establishment of a **security association (SA)** between two points is managed by **IKE**, which operates under the umbrella of ISAKMP, a protocol designe",
  "payloads": [
    "# 500/udp - Pentesting IPsec/IKE VPN",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Basic Information",
    "**IPsec** is widely recognized as the principal technology for securing communications between networks (LAN-to-LAN) and from remote users to the network gateway (remote access), serving as the backbone for enterprise VPN solutions.",
    "The establishment of a **security association (SA)** between two points is managed by **IKE**, which operates under the umbrella of ISAKMP, a protocol designed for the authentication and key exchange. This process unfolds in several phases:",
    "- **Phase 1:** A secure channel is created between two endpoints. This is achieved through the use of a Pre-Shared Key (PSK) or certificates, employing either main mode, which involves three pairs of messages, or **aggressive mode**.",
    "- **Phase 1.5:** Though not mandatory, this phase, known as the Extended Authentication Phase, verifies the identity of the user attempting to connect by requiring a username and password.",
    "- **Phase 2:** This phase is dedicated to negotiating the parameters for securing data with **ESP** and **AH**. It allows for the use of algorithms different from those in Phase 1 to ensure **Perfect Forward Secrecy (PFS)**, enhancing security.",
    "**Default port:** 500/udp",
    "Also commonly exposed: 4500/udp (NAT Traversal)",
    "## **Discover** the service using nmap",
    "root@bt:~# nmap -sU -p 500 172.16.21.200",
    "Starting Nmap 5.51 (http://nmap.org) at 2011-11-26 10:56 IST",
    "Nmap scan report for 172.16.21.200",
    "Host is up (0.00036s latency)."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/ipsec-ike-vpn-pentesting.md"
  ]
}