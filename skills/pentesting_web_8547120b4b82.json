{
  "id": "pentesting_web_8547120b4b82",
  "category": "pentesting-web",
  "title": "basic .net deserialization objectdataprovider gadgets expandedwrapper and json.net",
  "description": "# Basic .Net deserialization (ObjectDataProvider gadget, ExpandedWrapper, and Json.Net)\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThis post is dedicated to **understand how the gadget ObjectDataProvider is exploited** to obtain RCE and **how** the Serialization libraries **Json.Net and xmlSerializer can be abused** with that gadget.\n\n## ObjectDataProvider Gadget\n\nFrom the documentation: _the ObjectDataProvider Class Wraps and creates an object that you can use as a binding source_.\\\nYe",
  "payloads": [
    "# Basic .Net deserialization (ObjectDataProvider gadget, ExpandedWrapper, and Json.Net)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "This post is dedicated to **understand how the gadget ObjectDataProvider is exploited** to obtain RCE and **how** the Serialization libraries **Json.Net and xmlSerializer can be abused** with that gadget.",
    "## ObjectDataProvider Gadget",
    "From the documentation: _the ObjectDataProvider Class Wraps and creates an object that you can use as a binding source_.\\",
    "Yeah, it's a weird explanation, so lets see what does this class have that is so interesting: This class allows to **wrap an arbitrary object**, use _**MethodParameters**_ to **set arbitrary parameters,** and then **use MethodName to call an arbitrary function** of the arbitrary object declared using the arbitrary parameters.\\",
    "Therefore, the arbitrary **object** will **execute** a **function** with **parameters while being deserialized.**",
    "### **How is this possible**",
    "The **System.Windows.Data** namespace, found within the **PresentationFramework.dll** at `C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\WPF`, is where the ObjectDataProvider is defined and implemented.",
    "Using [**dnSpy**](https://github.com/0xd4d/dnSpy) you can **inspect the code** of the class we are interested in. In the image below we are seeing the code of **PresentationFramework.dll --> System.Windows.Data --> ObjectDataProvider --> Method name**",
    "![](<../../images/image (427).png>)",
    "As you can observe when `MethodName` is set `base.Refresh()` is called, lets take a look to what does it do:",
    "![](<../../images/image (319).png>)",
    "Ok, lets continue seeing what does `this.BeginQuery()` does. `BeginQuery` is overridden by `ObjectDataProvider` and this is what it does:",
    "![](<../../images/image (345).png>)"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.md"
  ]
}