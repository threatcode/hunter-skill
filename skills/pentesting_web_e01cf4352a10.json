{
  "id": "pentesting_web_e01cf4352a10",
  "category": "pentesting-web",
  "title": "crlf 0d 0a",
  "description": "# CRLF (%0D%0A) Injection\n\n{{#include ../banners/hacktricks-training.md}}\n\n### CRLF\n\nCarriage Return (CR) and Line Feed (LF), collectively known as CRLF, are special character sequences used in the HTTP protocol to denote the end of a line or the start of a new one. Web servers and browsers use CRLF to distinguish between HTTP headers and the body of a response. These characters are universally employed in HTTP/1.1 communications across various web server types, such as Apache and Microsoft IIS.",
  "payloads": [
    "# CRLF (%0D%0A) Injection",
    "{{#include ../banners/hacktricks-training.md}}",
    "### CRLF",
    "Carriage Return (CR) and Line Feed (LF), collectively known as CRLF, are special character sequences used in the HTTP protocol to denote the end of a line or the start of a new one. Web servers and browsers use CRLF to distinguish between HTTP headers and the body of a response. These characters are universally employed in HTTP/1.1 communications across various web server types, such as Apache and Microsoft IIS.",
    "### CRLF Injection Vulnerability",
    "CRLF injection involves the insertion of CR and LF characters into user-supplied input. This action misleads the server, application, or user into interpreting the injected sequence as the end of one response and the beginning of another. While these characters are not inherently harmful, their misuse can lead to HTTP response splitting and other malicious activities.",
    "### Example: CRLF Injection in a Log File",
    "[Example from here](https://www.invicti.com/blog/web-security/crlf-http-header/)",
    "Consider a log file in an admin panel that follows the format: `IP - Time - Visited Path`. A typical entry might look like:",
    "123.123.123.123 - 08:15 - /index.php?page=home",
    "An attacker can exploit a CRLF injection to manipulate this log. By injecting CRLF characters into the HTTP request, the attacker can alter the output stream and fabricate log entries. For instance, an injected sequence might transform the log entry into:",
    "/index.php?page=home&%0d%0a127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit",
    "Here, `%0d` and `%0a` represent the URL-encoded forms of CR and LF. Post-attack, the log would misleadingly display:",
    "IP - Time - Visited Path",
    "123.123.123.123 - 08:15 - /index.php?page=home&"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/crlf-0d-0a.md"
  ]
}