{
  "id": "binary_exploitation_50436455692e",
  "category": "binary-exploitation",
  "title": "first fit",
  "description": "# First Fit\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## **First Fit**\n\nWhen you free memory in a program using glibc, different \"bins\" are used to manage the memory chunks. Here's a simplified explanation of two common scenarios: unsorted bins and fastbins.\n\n### Unsorted Bins\n\nWhen you free a memory chunk that's not a fast chunk, it goes to the unsorted bin. This bin acts like a list where new freed chunks are added to the front (the \"head\"). When you request a new chunk of memory,",
  "payloads": [
    "# First Fit",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## **First Fit**",
    "When you free memory in a program using glibc, different \"bins\" are used to manage the memory chunks. Here's a simplified explanation of two common scenarios: unsorted bins and fastbins.",
    "### Unsorted Bins",
    "When you free a memory chunk that's not a fast chunk, it goes to the unsorted bin. This bin acts like a list where new freed chunks are added to the front (the \"head\"). When you request a new chunk of memory, the allocator looks at the unsorted bin from the back (the \"tail\") to find a chunk that's big enough. If a chunk from the unsorted bin is bigger than what you need, it gets split, with the front part being returned and the remaining part staying in the bin.",
    "Example:",
    "- You allocate 300 bytes (`a`), then 250 bytes (`b`), then free `a` and request again 250 bytes (`c`).",
    "- When you free `a`, it goes to the unsorted bin.",
    "- If you then request 250 bytes again, the allocator finds `a` at the tail and splits it, returning the part that fits your request and keeping the rest in the bin.",
    "- `c` will be pointing to the previous `a` and filled with the `a`'s contents.",
    "char *a = malloc(300);",
    "char *b = malloc(250);",
    "free(a);",
    "char *c = malloc(250);"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/use-after-free/first-fit.md"
  ]
}