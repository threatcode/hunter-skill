{
  "id": "network_services_pentesting_961be3bd2ef6",
  "category": "network-services-pentesting",
  "title": "disable functions bypass php perl extension safe mode bypass exploit",
  "description": "# PHP Perl Extension Safe_mode Bypass Exploit\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\n## Background\n\nThe issue tracked as **CVE-2007-4596** comes from the legacy `perl` PHP extension, which embeds a full Perl interpreter without honoring PHP's `safe_mode`, `disable_functions`, or `open_basedir` controls. Any PHP worker that loads `extension=perl.so` gains unrestricted Perl `eval`, so command execution remains trivial even when all classic PHP process-spawning primitives are blo",
  "payloads": [
    "# PHP Perl Extension Safe_mode Bypass Exploit",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "## Background",
    "The issue tracked as **CVE-2007-4596** comes from the legacy `perl` PHP extension, which embeds a full Perl interpreter without honoring PHP's `safe_mode`, `disable_functions`, or `open_basedir` controls. Any PHP worker that loads `extension=perl.so` gains unrestricted Perl `eval`, so command execution remains trivial even when all classic PHP process-spawning primitives are blocked. Although `safe_mode` disappeared in PHP 5.4, many outdated shared-hosting stacks and vulnerable labs still ship it, so this bypass is still valuable when you land on legacy control panels.",
    "## Compatibility & Packaging Status (2025)",
    "* The last PECL release (`perl-1.0.1`, 2013) targets PHP \u22655.0; PHP 8+ generally fails because the Zend APIs changed.",
    "* PECL is being superseded by PIE, but older stacks still ship PECL/pear. Use the flow below on PHP 5/7 targets; on newer PHP expect to downgrade or switch to another injection path (e.g., userland FFI).",
    "## Building a Testable Environment in 2025",
    "* Fetch `perl-1.0.1` from PECL, compile it for the PHP branch you plan to attack, and load it globally (`php.ini`) or via `dl()` (if permitted).",
    "* Quick Debian-based lab recipe:",
    "```bash",
    "sudo apt install php5.6 php5.6-dev php-pear build-essential",
    "sudo pecl install perl-1.0.1",
    "echo \"extension=perl.so\" | sudo tee /etc/php/5.6/mods-available/perl.ini",
    "sudo phpenmod perl && sudo systemctl restart apache2"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-perl-extension-safe_mode-bypass-exploit.md"
  ]
}