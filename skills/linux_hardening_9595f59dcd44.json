{
  "id": "linux_hardening_9595f59dcd44",
  "category": "linux-hardening",
  "title": "sensitive mounts",
  "description": "# Sensitive Mounts\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\nThe exposure of `/proc`, `/sys`, and `/var` without proper namespace isolation introduces significant security risks, including attack surface enlargement and information disclosure. These directories contain sensitive files that, if misconfigured or accessed by an unauthorized user, can lead to container escape, host modification, or provide information aiding further attacks. For instance, incorrectly mounting `-v /pr",
  "payloads": [
    "# Sensitive Mounts",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "The exposure of `/proc`, `/sys`, and `/var` without proper namespace isolation introduces significant security risks, including attack surface enlargement and information disclosure. These directories contain sensitive files that, if misconfigured or accessed by an unauthorized user, can lead to container escape, host modification, or provide information aiding further attacks. For instance, incorrectly mounting `-v /proc:/host/proc` can bypass AppArmor protection due to its path-based nature, leaving `/host/proc` unprotected.",
    "**You can find further details of each potential vuln in** [**https://0xn3va.gitbook.io/cheat-sheets/container/escaping/sensitive-mounts**](https://0xn3va.gitbook.io/cheat-sheets/container/escaping/sensitive-mounts)**.**",
    "## procfs Vulnerabilities",
    "### `/proc/sys`",
    "This directory permits access to modify kernel variables, usually via `sysctl(2)`, and contains several subdirectories of concern:",
    "#### **`/proc/sys/kernel/core_pattern`**",
    "- Described in [core(5)](https://man7.org/linux/man-pages/man5/core.5.html).",
    "- If you can write inside this file it's possible to write a pipe `|` followed by the path to a program or script that will be exuted after a crash happens.",
    "-  An attacker can find the path inside the host to his container executing `mount` and write the path to a binary inside his container file system. Then, crash a program to make the kernel execute the binary outside of the container.",
    "- **Testing and Exploitation Example**:",
    "```bash",
    "[ -w /proc/sys/kernel/core_pattern ] && echo Yes # Test write access",
    "cd /proc/sys/kernel"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts.md"
  ]
}