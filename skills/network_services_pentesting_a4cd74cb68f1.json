{
  "id": "network_services_pentesting_a4cd74cb68f1",
  "category": "network-services-pentesting",
  "title": "32100 udp pentesting pppp cs2 p2p cameras",
  "description": "# 32100/UDP - Pentesting PPPP (CS2) P2P Cameras\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Overview\n\nPPPP (a.k.a. \u201cP2P\u201d) is a proprietary device connectivity stack by CS2 Network that\u2019s widely embedded in low-cost IP cameras and other IoT devices. It provides rendezvous, NAT traversal (UDP hole punching), an application-layer \u201creliable\u201d stream on top of UDP, and an ID-based addressing scheme, allowing a mobile/desktop app to reach devices anywhere on the Internet by knowing only a devic",
  "payloads": [
    "# 32100/UDP - Pentesting PPPP (CS2) P2P Cameras",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Overview",
    "PPPP (a.k.a. \u201cP2P\u201d) is a proprietary device connectivity stack by CS2 Network that\u2019s widely embedded in low-cost IP cameras and other IoT devices. It provides rendezvous, NAT traversal (UDP hole punching), an application-layer \u201creliable\u201d stream on top of UDP, and an ID-based addressing scheme, allowing a mobile/desktop app to reach devices anywhere on the Internet by knowing only a device ID.",
    "Key traits relevant to attackers:",
    "- Devices register to three vendor-operated rendezvous servers per ID prefix. Clients query the same servers to find the device\u2019s external/relay address, then attempt UDP hole punching. Relay fallback exists.",
    "- Default server listener is reachable over UDP/32100. A minimal \u201chello\u201d probe is enough to fingerprint servers and some devices.",
    "- Optional blanket cipher and a special \u201cCRCEnc\u201d mode exist but are weak by design and are typically disabled in popular ecosystems (e.g., LookCam).",
    "- Control plane is usually JSON commands over the PPPP stream and commonly suffers from missing auth and memory-safety bugs.",
    "Typical device ID format (LookCam family): PREFIX-######-CCCCC, shortened in apps (e.g., GHBB-000001-NRLXW \u2192 G000001NRLXW). Observed prefixes: BHCC (\"hekai\"), FHBB and GHBB (\"mykj\").",
    "## Discovery and Enumeration",
    "- Internet exposure: many PPPP super-nodes answer a 32100/UDP probe. Known plaintext and error-string responses make them easy to identify in traffic captures and with Internet scanners.",
    "- LAN discovery: devices often reply to an unencrypted search on local broadcast. Use Paul Marrapese\u2019s script to enumerate:",
    "- [https://github.com/pmarrapese/iot/tree/master/p2p/lansearch](https://github.com/pmarrapese/iot/tree/master/p2p/lansearch)",
    "Notes:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/32100-udp-pentesting-pppp-cs2-p2p-cameras.md"
  ]
}