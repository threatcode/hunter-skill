{
  "id": "binary_exploitation_5bc0a7f6eb28",
  "category": "binary-exploitation",
  "title": "memory tagging extension mte",
  "description": "# Memory Tagging Extension (MTE)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\n**Memory Tagging Extension (MTE)** is designed to enhance software reliability and security by **detecting and preventing memory-related errors**, such as buffer overflows and use-after-free vulnerabilities. MTE, as part of the **ARM** architecture, provides a mechanism to attach a **small tag to each memory allocation** and a **corresponding tag to each pointer** referencing that memory. T",
  "payloads": [
    "# Memory Tagging Extension (MTE)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "**Memory Tagging Extension (MTE)** is designed to enhance software reliability and security by **detecting and preventing memory-related errors**, such as buffer overflows and use-after-free vulnerabilities. MTE, as part of the **ARM** architecture, provides a mechanism to attach a **small tag to each memory allocation** and a **corresponding tag to each pointer** referencing that memory. This approach allows for the detection of illegal memory accesses at runtime, significantly reducing the risk of exploiting such vulnerabilities for executing arbitrary code.",
    "### **How Memory Tagging Extension Works**",
    "MTE operates by **dividing memory into small, fixed-size blocks, with each block assigned a tag,** typically a few bits in size.",
    "When a pointer is created to point to that memory, it gets the same tag. This tag is stored in the **unused bits of a memory pointer**, effectively linking the pointer to its corresponding memory block.",
    "<figure><img src=\"../../images/image (1202).png\" alt=\"\"><figcaption><p><a href=\"https://www.youtube.com/watch?v=UwMt0e_dC_Q\">https://www.youtube.com/watch?v=UwMt0e_dC_Q</a></p></figcaption></figure>",
    "When a program accesses memory through a pointer, the MTE hardware checks that the **pointer's tag matches the memory block's tag**. If the tags **do not match**, it indicates an **illegal memory access.**",
    "### MTE Pointer Tags",
    "Tags inside a pointer are stored in 4 bits inside the top byte:",
    "<figure><img src=\"../../images/image (1203).png\" alt=\"\"><figcaption><p><a href=\"https://www.youtube.com/watch?v=UwMt0e_dC_Q\">https://www.youtube.com/watch?v=UwMt0e_dC_Q</a></p></figcaption></figure>",
    "Therefore, this allows up to **16 different tag values**.",
    "### MTE Memory Tags",
    "Every **16B of physical memory** have a corresponding **memory tag**."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/common-binary-protections-and-bypasses/memory-tagging-extension-mte.md"
  ]
}