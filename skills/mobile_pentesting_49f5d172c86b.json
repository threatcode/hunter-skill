{
  "id": "mobile_pentesting_49f5d172c86b",
  "category": "mobile-pentesting",
  "title": "abusing android media pipelines image parsers",
  "description": "# Abusing Android Media Pipelines & Image Parsers\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Delivery: Messaging Apps \u279c MediaStore \u279c Privileged Parsers\n\nModern OEM builds regularly run privileged media indexers that rescan `MediaStore` for \"AI\" or sharing features. On Samsung firmware prior to the April 2025 patch, `com.samsung.ipservice` loads Quram (`/system/lib64/libimagecodec.quram.so`) and automatically parses any file WhatsApp (or other apps) drops into `MediaStore`. In practic",
  "payloads": [
    "# Abusing Android Media Pipelines & Image Parsers",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Delivery: Messaging Apps \u279c MediaStore \u279c Privileged Parsers",
    "Modern OEM builds regularly run privileged media indexers that rescan `MediaStore` for \"AI\" or sharing features. On Samsung firmware prior to the April 2025 patch, `com.samsung.ipservice` loads Quram (`/system/lib64/libimagecodec.quram.so`) and automatically parses any file WhatsApp (or other apps) drops into `MediaStore`. In practice an attacker can send a DNG disguised as `IMG-*.jpg`, wait for the victim to tap \"download\" (1-click), and the privileged service will parse the payload even if the user never opens the gallery.",
    "```bash",
    "$ file IMG-2025-02-10.jpeg",
    "TIFF image data ...",
    "$ exiftool IMG-2025-02-10.jpeg | grep \"Opcode List\"",
    "Opcode List 1 : [opcode 23], [opcode 23], ...",
    "**Key takeaways**",
    "- Delivery relies on system media re-parsing (not the chat client) and thus inherits that process' permissions (full read/write access to the gallery, ability to drop new media, etc.).",
    "- Any image parser reachable through `MediaStore` (vision widgets, wallpapers, AI r\u00e9sum\u00e9 features, etc.) becomes remotely reachable if the attacker can convince a target to save media.",
    "## 0-click DD+/EAC-3 decoding path (Google Messages \u279c mediacodec sandbox)",
    "Modern messaging stacks also auto-decode *audio* for transcription/search. On Pixel 9, **Google Messages** will hand incoming RCS/SMS audio to the **Dolby Unified Decoder (UDC)** inside `/vendor/lib64/libcodec2_soft_ddpdec.so` **before** the user opens the message, expanding the 0-click surface to media codecs.",
    "**Key parse constraints**"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/abusing-android-media-pipelines-image-parsers.md"
  ]
}