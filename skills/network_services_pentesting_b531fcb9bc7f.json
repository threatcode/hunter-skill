{
  "id": "network_services_pentesting_b531fcb9bc7f",
  "category": "network-services-pentesting",
  "title": "5985 5986 pentesting winrm",
  "description": "# 5985,5986 - Pentesting WinRM\n\n{{#include ../banners/hacktricks-training.md}}\n\n## WinRM\n\n[Windows Remote Management (WinRM)](<https://msdn.microsoft.com/en-us/library/windows/desktop/aa384426(v=vs.85).aspx>) is highlighted as a **protocol by Microsoft** that enables the **remote management of Windows systems** through HTTP(S), leveraging SOAP in the process. It's fundamentally powered by WMI, presenting itself as an HTTP-based interface for WMI operations.\n\nThe presence of WinRM on a machine al",
  "payloads": [
    "# 5985,5986 - Pentesting WinRM",
    "{{#include ../banners/hacktricks-training.md}}",
    "## WinRM",
    "[Windows Remote Management (WinRM)](<https://msdn.microsoft.com/en-us/library/windows/desktop/aa384426(v=vs.85).aspx>) is highlighted as a **protocol by Microsoft** that enables the **remote management of Windows systems** through HTTP(S), leveraging SOAP in the process. It's fundamentally powered by WMI, presenting itself as an HTTP-based interface for WMI operations.",
    "The presence of WinRM on a machine allows for straightforward remote administration via PowerShell, akin to how SSH works for other operating systems. To determine if WinRM is operational, checking for the opening of specific ports is recommended:",
    "- **5985/tcp (HTTP)**",
    "- **5986/tcp (HTTPS)**",
    "An open port from the list above signifies that WinRM has been set up, thus permitting attempts to initiate a remote session.",
    "### **Initiating a WinRM Session**",
    "To configure PowerShell for WinRM, Microsoft's `Enable-PSRemoting` cmdlet comes into play, setting up the computer to accept remote PowerShell commands. With elevated PowerShell access, the following commands can be executed to enable this functionality and designate any host as trusted:",
    "```bash",
    "Enable-PSRemoting -Force",
    "Set-Item wsman:\\localhost\\client\\trustedhosts *",
    "This approach involves adding a wildcard to the `trustedhosts` configuration, a step that requires cautious consideration due to its implications. It's also noted that altering the network type from \"Public\" to \"Work\" might be necessary on the attacker's machine.",
    "Moreover, WinRM can be **activated remotely** using the `wmic` command, demonstrated as follows:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/5985-5986-pentesting-winrm.md"
  ]
}