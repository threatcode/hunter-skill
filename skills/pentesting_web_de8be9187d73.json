{
  "id": "pentesting_web_de8be9187d73",
  "category": "pentesting-web",
  "title": "idor",
  "description": "# IDOR (Insecure Direct Object Reference)\n\n{{#include ../banners/hacktricks-training.md}}\n\nIDOR (Insecure Direct Object Reference) / Broken Object Level Authorization (BOLA) appears when a web or API endpoint discloses or accepts a user\u2013controllable identifier that is used **directly** to access an internal object **without verifying that the caller is authorized** to access/modify that object.  \nSuccessful exploitation normally allows horizontal or vertical privilege-escalation such as reading ",
  "payloads": [
    "# IDOR (Insecure Direct Object Reference)",
    "{{#include ../banners/hacktricks-training.md}}",
    "IDOR (Insecure Direct Object Reference) / Broken Object Level Authorization (BOLA) appears when a web or API endpoint discloses or accepts a user\u2013controllable identifier that is used **directly** to access an internal object **without verifying that the caller is authorized** to access/modify that object.",
    "Successful exploitation normally allows horizontal or vertical privilege-escalation such as reading or modifying other users\u2019 data and, in the worst case, full account takeover or mass-data exfiltration.",
    "## 1. Identifying Potential IDORs",
    "1. Look for **parameters that reference an object**:",
    "* Path: `/api/user/1234`, `/files/550e8400-e29b-41d4-a716-446655440000`",
    "* Query: `?id=42`, `?invoice=2024-00001`",
    "* Body / JSON: `{\"user_id\": 321, \"order_id\": 987}`",
    "* Headers / Cookies: `X-Client-ID: 4711`",
    "2. Prefer endpoints that **read or update** data (`GET`, `PUT`, `PATCH`, `DELETE`).",
    "3. Note when identifiers are **sequential or predictable** \u2013 if your ID is `64185742`, then `64185741` probably exists.",
    "4. Explore hidden or alternate flows (e.g. *\"Paradox team members\"* link in login pages) that might expose extra APIs.",
    "5. Use an **authenticated low-privilege session** and change only the ID **keeping the same token/cookie**. The absence of an authorization error is usually a sign of IDOR.",
    "### Quick manual tampering (Burp Repeater)"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/idor.md"
  ]
}