{
  "id": "macos_hardening_ec30db8dac0a",
  "category": "macos-hardening",
  "title": "macos system extensions",
  "description": "# macOS System Extensions\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## System Extensions / Endpoint Security Framework\n\nUnlike Kernel Extensions, **System Extensions run in user space** instead of kernel space, reducing the risk of a system crash due to extension malfunction.\n\n<figure><img src=\"../../../images/image (606).png\" alt=\"https://knight.sc/images/system-extension-internals-1.png\"><figcaption></figcaption></figure>\n\nThere are three types of system extensions: **DriverKit** ",
  "payloads": [
    "# macOS System Extensions",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## System Extensions / Endpoint Security Framework",
    "Unlike Kernel Extensions, **System Extensions run in user space** instead of kernel space, reducing the risk of a system crash due to extension malfunction.",
    "<figure><img src=\"../../../images/image (606).png\" alt=\"https://knight.sc/images/system-extension-internals-1.png\"><figcaption></figcaption></figure>",
    "There are three types of system extensions: **DriverKit** Extensions, **Network** Extensions, and **Endpoint Security** Extensions.",
    "### **DriverKit Extensions**",
    "DriverKit is a replacement for kernel extensions that **provide hardware support**. It allows device drivers (like USB, Serial, NIC, and HID drivers) to run in user space rather than kernel space. The DriverKit framework includes **user space versions of certain I/O Kit classes**, and the kernel forwards normal I/O Kit events to user space, offering a safer environment for these drivers to run.",
    "### **Network Extensions**",
    "Network Extensions provide the ability to customize network behaviors. There are several types of Network Extensions:",
    "- **App Proxy**: This is used for creating a VPN client that implements a flow-oriented, custom VPN protocol. This means it handles network traffic based on connections (or flows) rather than individual packets.",
    "- **Packet Tunnel**: This is used for creating a VPN client that implements a packet-oriented, custom VPN protocol. This means it handles network traffic based on individual packets.",
    "- **Filter Data**: This is used for filtering network \"flows\". It can monitor or modify network data at the flow level.",
    "- **Filter Packet**: This is used for filtering individual network packets. It can monitor or modify network data at the packet level.",
    "- **DNS Proxy**: This is used for creating a custom DNS provider. It can be used to monitor or modify DNS requests and responses."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/macos-system-extensions.md"
  ]
}