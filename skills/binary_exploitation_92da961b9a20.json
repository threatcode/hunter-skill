{
  "id": "binary_exploitation_92da961b9a20",
  "category": "binary-exploitation",
  "title": "house of einherjar",
  "description": "# House of Einherjar\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\n### Code\n\n- Check the example from [https://github.com/shellphish/how2heap/blob/master/glibc_2.35/house_of_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc_2.35/house_of_einherjar.c)\n- Or the one from [https://guyinatuxedo.github.io/42-house_of_einherjar/house_einherjar_exp/index.html#house-of-einherjar-explanation](https://guyinatuxedo.github.io/42-house_of_einherjar/house_einherj",
  "payloads": [
    "# House of Einherjar",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "### Code",
    "- Check the example from [https://github.com/shellphish/how2heap/blob/master/glibc_2.35/house_of_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc_2.35/house_of_einherjar.c)",
    "- Or the one from [https://guyinatuxedo.github.io/42-house_of_einherjar/house_einherjar_exp/index.html#house-of-einherjar-explanation](https://guyinatuxedo.github.io/42-house_of_einherjar/house_einherjar_exp/index.html#house-of-einherjar-explanation) (you might need to fill the tcache)",
    "### Goal",
    "- The goal is to allocate memory in almost any specific address.",
    "### Requirements",
    "- Create a fake chunk when we want to allocate a chunk:",
    "- Set pointers to point to itself to bypass sanity checks",
    "- One-byte overflow with a null byte from one chunk to the next one to modify the `PREV_INUSE` flag.",
    "- Indicate in the `prev_size` of the off-by-null abused chunk the difference between itself and the fake chunk",
    "- The fake chunk size must also have been set the same size to bypass sanity checks",
    "- For constructing these chunks, you will need a heap leak."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/house-of-einherjar.md"
  ]
}