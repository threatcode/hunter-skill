{
  "id": "pentesting_web_b4f47609a614",
  "category": "pentesting-web",
  "title": "cache poisoning via url discrepancies",
  "description": "# Cache Poisoning via URL discrepancies\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThis is a summary of the techniques proposed in the post [https://portswigger.net/research/gotta-cache-em-all](https://portswigger.net/research/gotta-cache-em-all) in order to perform cache poisoning attacks **abusing discrepancies between cache proxies and web servers.**\n\n> [!TIP]\n> The goal of this attack is to **make the cache server think that a static resource is being loaded** so it caches it while ",
  "payloads": [
    "# Cache Poisoning via URL discrepancies",
    "{{#include ../../banners/hacktricks-training.md}}",
    "This is a summary of the techniques proposed in the post [https://portswigger.net/research/gotta-cache-em-all](https://portswigger.net/research/gotta-cache-em-all) in order to perform cache poisoning attacks **abusing discrepancies between cache proxies and web servers.**",
    "> [!TIP]",
    "> The goal of this attack is to **make the cache server think that a static resource is being loaded** so it caches it while the cache server stores as cache key part of the path but the web server responds resolving another path. The web server will resolve the real path which will be loading a dynamic page (which might store sensitive information about the user, a malicious payload like XSS or redirecting to lo load a JS file from the attackers website for example).",
    "## Delimiters",
    "**URL delimiters** vary by framework and server, impacting how requests are routed and responses are handled. Some common origin delimiters are:",
    "- **Semicolon**: Used in Spring for matrix variables (e.g. `/hello;var=a/world;var1=b;var2=c` \u2192 `/hello/world`).",
    "- **Dot**: Specifies response format in Ruby on Rails (e.g. `/MyAccount.css` \u2192 `/MyAccount`)",
    "- **Null Byte**: Truncates paths in OpenLiteSpeed (e.g. `/MyAccount%00aaa` \u2192 `/MyAccount`).",
    "- **Newline Byte**: Separates URL components in Nginx (e.g. `/users/MyAccount%0aaaa` \u2192 `/account/MyAccount`).",
    "Other specific delimiters might be found following this process:",
    "- **Step 1**: Identify non-cacheable requests and use them to monitor how URLs with potential delimiters are handled.",
    "- **Step 2**: Append random suffixes to paths and compare the server's response to determine if a character functions as a delimiter.",
    "- **Step 3**: Introduce potential delimiters before the random suffix to see if the response changes, indicating delimiter usage."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/cache-deception/cache-poisoning-via-url-discrepancies.md"
  ]
}