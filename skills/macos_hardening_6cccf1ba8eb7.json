{
  "id": "macos_hardening_6cccf1ba8eb7",
  "category": "macos-hardening",
  "title": "macos authorizations db and authd",
  "description": "# macOS Authorizations DB & Authd\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## **Athorizarions DB**\n\nThe database located in `/var/db/auth.db` is database used to store permissions to perform sensitive operations. These operations are performed completely in **user space** and are usually used by **XPC services** which need to check **if the calling client is authorized** to perform certain action checking this database.\n\nInitially this database is created from the content of `/Syst",
  "payloads": [
    "# macOS Authorizations DB & Authd",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## **Athorizarions DB**",
    "The database located in `/var/db/auth.db` is database used to store permissions to perform sensitive operations. These operations are performed completely in **user space** and are usually used by **XPC services** which need to check **if the calling client is authorized** to perform certain action checking this database.",
    "Initially this database is created from the content of `/System/Library/Security/authorization.plist`. Then, some services might add or modify this dataabse to add other permissions to it.",
    "The rules are stored in the `rules` table inside the database and contains the folliwing colmns:",
    "- **id**: A unique identifier for each rule, automatically incremented and serving as the primary key.",
    "- **name**: The unique name of the rule used to identify and reference it within the authorization system.",
    "- **type**: Specifies the type of the rule, restricted to values 1 or 2 to define its authorization logic.",
    "- **class**: Categorizes the rule into a specific class, ensuring it is a positive integer.",
    "- \"allow\" for allow, \"deny\" for deny, \"user\" if the group property indicated a group which membership allows the access, \"rule\" indicates in an array a rule to be fulfilled, \"evaluate-mechanisms\" followed by a `mechanisms` array which are either builtins or a name of a bundle inside `/System/Library/CoreServices/SecurityAgentPlugins/` or /Library/Security//SecurityAgentPlugins",
    "- **group**: Indicates the user group associated with the rule for group-based authorization.",
    "- **kofn**: Represents the \"k-of-n\" parameter, determining how many subrules must be satisfied out of a total number.",
    "- **timeout**: Defines the duration in seconds before the authorization granted by the rule expires.",
    "- **flags**: Contains various flags that modify the behavior and characteristics of the rule."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-authorizations-db-and-authd.md"
  ]
}