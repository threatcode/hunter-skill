{
  "id": "binary_exploitation_e8548eda25c7",
  "category": "binary-exploitation",
  "title": "bypassing canary and pie",
  "description": "# BF Addresses in the Stack\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n**If you are facing a binary protected by a canary and PIE (Position Independent Executable) you probably need to find a way to bypass them.**\n\n![](<../../../images/image (865).png>)\n\n> [!TIP]\n> Note that **`checksec`** might not find that a binary is protected by a canary if this was statically compiled and it's not capable to identify the function.\\\n> However, you can manually notice this if you find that a valu",
  "payloads": [
    "# BF Addresses in the Stack",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "**If you are facing a binary protected by a canary and PIE (Position Independent Executable) you probably need to find a way to bypass them.**",
    "![](<../../../images/image (865).png>)",
    "> [!TIP]",
    "> Note that **`checksec`** might not find that a binary is protected by a canary if this was statically compiled and it's not capable to identify the function.\\",
    "> However, you can manually notice this if you find that a value is saved in the stack at the beginning of a function call and this value is checked before exiting.",
    "## Brute-Force Addresses",
    "In order to **bypass the PIE** you need to **leak some address**. And if the binary is not leaking any addresses the best to do it is to **brute-force the RBP and RIP saved in the stack** in the vulnerable function.\\",
    "For example, if a binary is protected using both a **canary** and **PIE**, you can start brute-forcing the canary, then the **next** 8 Bytes (x64) will be the saved **RBP** and the **next** 8 Bytes will be the saved **RIP.**",
    "> [!TIP]",
    "> It's supposed that the return address inside the stack belongs to the main binary code, which, if the vulnerability is located in the binary code, will usually be the case.",
    "To brute-force the RBP and the RIP from the binary you can figure out that a valid guessed byte is correct if the program output something or it just doesn't crash. The **same function** as the provided for brute-forcing the canary can be used to brute-force the RBP and the RIP:",
    "```python",
    "from pwn import *"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/common-binary-protections-and-bypasses/pie/bypassing-canary-and-pie.md"
  ]
}