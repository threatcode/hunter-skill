{
  "id": "binary_exploitation_188b3ac6798e",
  "category": "binary-exploitation",
  "title": "CVE 2020 27950 mach msg trailer t",
  "description": "# CVE-2021-30807: IOMobileFrameBuffer OOB\n\n{{#include ../../banners/hacktricks-training.md}}\n\n\n## The Bug\n\nYou have a [great explanation of the vuln here](https://www.synacktiv.com/en/publications/ios-1-day-hunting-uncovering-and-exploiting-cve-2020-27950-kernel-memory-leak), but as summary:\n\nEvery Mach message the kernel receives ends with a **\"trailer\"**: a variable-length struct with metadata (seqno, sender token, audit token, context, access control data, labels...). The kernel **always rese",
  "payloads": [
    "# CVE-2021-30807: IOMobileFrameBuffer OOB",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## The Bug",
    "You have a [great explanation of the vuln here](https://www.synacktiv.com/en/publications/ios-1-day-hunting-uncovering-and-exploiting-cve-2020-27950-kernel-memory-leak), but as summary:",
    "Every Mach message the kernel receives ends with a **\"trailer\"**: a variable-length struct with metadata (seqno, sender token, audit token, context, access control data, labels...). The kernel **always reserves the largest possible trailer** (MAX_TRAILER_SIZE) in the message buffer, but **only initializes some fields**, then later **decides which trailer size to return** based on **user-controlled receive options**.",
    "These are the trailer relevant structs:",
    "typedef struct{",
    "mach_msg_trailer_type_t       msgh_trailer_type;",
    "mach_msg_trailer_size_t       msgh_trailer_size;",
    "} mach_msg_trailer_t;",
    "typedef struct{",
    "mach_msg_trailer_type_t       msgh_trailer_type;",
    "mach_msg_trailer_size_t       msgh_trailer_size;",
    "mach_port_seqno_t             msgh_seqno;",
    "security_token_t              msgh_sender;"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/ios-exploiting/CVE-2020-27950-mach_msg_trailer_t.md"
  ]
}