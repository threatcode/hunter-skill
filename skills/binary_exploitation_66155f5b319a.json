{
  "id": "binary_exploitation_66155f5b319a",
  "category": "binary-exploitation",
  "title": "imessage media parser zero click coreaudio pac bypass",
  "description": "# iMessage Media Parser Zero-Click \u2192 CoreAudio RCE \u2192 PAC/RPAC \u2192 Kernel \u2192 CryptoTokenKit Abuse\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThis page summarizes a modern iOS zero-click attack surface and an observed end-to-end exploitation chain abusing iMessage automatic media parsing to compromise CoreAudio, bypass BlastDoor, defeat Pointer Authentication (PAC) via an RPAC path, escalate to kernel, and finally abuse CryptoTokenKit for unauthorized key uses.\n\n> Warning: This is an educati",
  "payloads": [
    "# iMessage Media Parser Zero-Click \u2192 CoreAudio RCE \u2192 PAC/RPAC \u2192 Kernel \u2192 CryptoTokenKit Abuse",
    "{{#include ../../banners/hacktricks-training.md}}",
    "This page summarizes a modern iOS zero-click attack surface and an observed end-to-end exploitation chain abusing iMessage automatic media parsing to compromise CoreAudio, bypass BlastDoor, defeat Pointer Authentication (PAC) via an RPAC path, escalate to kernel, and finally abuse CryptoTokenKit for unauthorized key uses.",
    "> Warning: This is an educational summary to help defenders, researchers, and red teams understand the techniques. Do not use offensively.",
    "## High-level chain",
    "- Delivery vector: a malicious audio attachment (e.g., .amr / MP4 AAC) sent via iMessage/SMS.",
    "- Auto-ingestion: iOS auto-parses media for previews and conversions without user interaction.",
    "- Parser bug: malformed structures hit CoreAudio\u2019s AudioConverterService and corrupt heap memory.",
    "- Code exec in media context: RCE inside the media parsing process; reported to bypass BlastDoor isolation in specific paths (e.g., \u201cknown sender\u201d framing path).",
    "- PAC/RPAC bypass: once arbitrary R/W is achieved, a PAC bypass in the RPAC path enables stable control flow under arm64e PAC.",
    "- Kernel escalation: the chain converts userland exec into kernel exec (e.g., via wireless/AppleBCMWLAN code paths and AMPDU handling as seen in logs below).",
    "- Post-exploitation: with kernel, abuse CryptoTokenKit to perform signing with Secure Enclave\u2013backed keys, read sensitive data paths (Keychain contexts), intercept messages/2FA, silently authorize actions, and enable stealth surveillance (mic/camera/GPS) without prompts.",
    "## iMessage/BlastDoor attack surface notes",
    "BlastDoor is a hardened service designed to parse untrusted message content. However, observed logs indicate paths where protections may be bypassed when messages are framed from a \u201cknown sender\u201d and when additional filters (e.g., Blackhole) are relaxed:",
    "```text"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/ios-exploiting/imessage-media-parser-zero-click-coreaudio-pac-bypass.md"
  ]
}