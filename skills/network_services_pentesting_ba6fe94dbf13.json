{
  "id": "network_services_pentesting_ba6fe94dbf13",
  "category": "network-services-pentesting",
  "title": "pentesting 631 internet printing protocol ipp",
  "description": "# Internet Printing Protocol\n\n{{#include ../banners/hacktricks-training.md}}\n\nThe **Internet Printing Protocol (IPP)**, as specified in **RFC 2910** and **RFC 2911**, is the de-facto standard for network printing. It sits on top of **HTTP/1.1** (either clear-text or TLS) and exposes a rich API for creating print jobs, querying printer capabilities and managing queues. Modern extensions such as **IPP Everywhere** even allow driver-less printing from mobile and cloud environments, while the same p",
  "payloads": [
    "# Internet Printing Protocol",
    "{{#include ../banners/hacktricks-training.md}}",
    "The **Internet Printing Protocol (IPP)**, as specified in **RFC 2910** and **RFC 2911**, is the de-facto standard for network printing. It sits on top of **HTTP/1.1** (either clear-text or TLS) and exposes a rich API for creating print jobs, querying printer capabilities and managing queues. Modern extensions such as **IPP Everywhere** even allow driver-less printing from mobile and cloud environments, while the same packet format has been reused for 3-D printers.",
    "Unfortunately, exposing port **631/tcp (and 631/udp for printer discovery)** often leads to serious security issues \u2013 both on traditional office printers and on any Linux/Unix host running **CUPS**.",
    "## Quick PoC \u2013 crafting raw IPP with Python",
    "```python",
    "import struct, requests",
    "# Minimal IPP Get-Printer-Attributes request (operation-id 0x000B)",
    "ipp = struct.pack(",
    "\">IHHIHH\",               # version 2.0, operation-id, request-id",
    "0x0200,                  # 2.0",
    "0x000B,                  # Get-Printer-Attributes",
    "0x00000001,             # request-id",
    "0x01, 0x47,             # operation-attributes-tag, charset attr (skipped)",
    ") + b\"\\x03\"                # end-of-attributes"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-631-internet-printing-protocol-ipp.md"
  ]
}