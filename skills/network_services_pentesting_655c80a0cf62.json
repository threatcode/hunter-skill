{
  "id": "network_services_pentesting_655c80a0cf62",
  "category": "network-services-pentesting",
  "title": "ksmbd attack surface and fuzzing syzkaller",
  "description": "# ksmbd Attack Surface & SMB2/SMB3 Protocol Fuzzing (syzkaller)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Overview\nThis page abstracts practical techniques to exercise and fuzz the Linux in-kernel SMB server (ksmbd) using syzkaller. It focuses on expanding the protocol attack surface through configuration, building a stateful harness capable of chaining SMB2 operations, generating grammar-valid PDUs, biasing mutations into weakly-covered code paths, and leveraging syzkaller features",
  "payloads": [
    "# ksmbd Attack Surface & SMB2/SMB3 Protocol Fuzzing (syzkaller)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Overview",
    "This page abstracts practical techniques to exercise and fuzz the Linux in-kernel SMB server (ksmbd) using syzkaller. It focuses on expanding the protocol attack surface through configuration, building a stateful harness capable of chaining SMB2 operations, generating grammar-valid PDUs, biasing mutations into weakly-covered code paths, and leveraging syzkaller features such as focus_areas and ANYBLOB. While the original research enumerates specific CVEs, here we emphasise the reusable methodology and concrete snippets you can adapt to your own setups.",
    "Target scope: SMB2/SMB3 over TCP. Kerberos and RDMA are intentionally out-of-scope to keep the harness simple.",
    "## Expand ksmbd Attack Surface via Configuration",
    "By default, a minimal ksmbd setup leaves large parts of the server untested. Enable the following features to drive the server through additional parsers/handlers and reach deeper code paths:",
    "- Global-level",
    "- Durable handles",
    "- Server multi-channel",
    "- SMB2 leases",
    "- Per-share-level",
    "- Oplocks (on by default)",
    "- VFS objects",
    "Enabling these increases execution in modules such as:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-smb/ksmbd-attack-surface-and-fuzzing-syzkaller.md"
  ]
}