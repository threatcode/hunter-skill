{
  "id": "pentesting_web_0eb06499e4dc",
  "category": "pentesting-web",
  "title": "basic java deserialization objectinputstream readobject",
  "description": "# Basic Java Deserialization with ObjectInputStream readObject\n\n{{#include ../../banners/hacktricks-training.md}}\n\nIn this POST it's going to be explained an example using `java.io.Serializable` **and why overriding `readObject()` can be extremely dangerous if the incoming stream is attacker-controlled**.\n\n## Serializable\n\nThe Java `Serializable` interface (`java.io.Serializable`) is a marker interface your classes must implement if they are to be **serialized** and **deserialized**. Java object",
  "payloads": [
    "# Basic Java Deserialization with ObjectInputStream readObject",
    "{{#include ../../banners/hacktricks-training.md}}",
    "In this POST it's going to be explained an example using `java.io.Serializable` **and why overriding `readObject()` can be extremely dangerous if the incoming stream is attacker-controlled**.",
    "## Serializable",
    "The Java `Serializable` interface (`java.io.Serializable`) is a marker interface your classes must implement if they are to be **serialized** and **deserialized**. Java object serialization (writing) is done with the [`ObjectOutputStream`](http://tutorials.jenkov.com/java-io/objectoutputstream.html) and deserialization (reading) is done with the [`ObjectInputStream`](http://tutorials.jenkov.com/java-io/objectinputstream.html).",
    "### Reminder: Which methods are implicitly invoked during deserialization?",
    "1. `readObject()` \u2013 class-specific read logic (if implemented and *private*).",
    "2. `readResolve()` \u2013 can replace the deserialized object with another one.",
    "3. `validateObject()` \u2013 via `ObjectInputValidation` callbacks.",
    "4. `readExternal()` \u2013 for classes implementing `Externalizable`.",
    "5. Constructors are **not** executed \u2013 therefore gadget chains rely exclusively on the previous callbacks.",
    "Any method in that chain that ends up invoking attacker-controlled data (command execution, JNDI lookups, reflection, etc.) turns the deserialization routine into an RCE gadget.",
    "Lets see an example with a **class Person** which is **serializable**. This class **overwrites the readObject** function, so when **any object** of this **class** is **deserialized** this **function** is going to be **executed**.\\",
    "In the example, the **readObject** function of the class Person calls the function `eat()` of his pet and the function `eat()` of a Dog (for some reason) calls a **calc.exe**. **We are going to see how to serialize and deserialize a Person object to execute this calculator:**",
    "**The following example is from <https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649>**"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/basic-java-deserialization-objectinputstream-readobject.md"
  ]
}