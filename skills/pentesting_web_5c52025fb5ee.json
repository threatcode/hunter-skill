{
  "id": "pentesting_web_5c52025fb5ee",
  "category": "pentesting-web",
  "title": "big binary files upload postgresql",
  "description": "# Big Binary Files Upload in PostgreSQL\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## PostgreSQL Large Objects\n\nPostgreSQL offers a structure known as **large objects**, accessible via the `pg_largeobject` table, designed for storing large data types, such as images or PDF documents. This approach is advantageous over the `COPY TO` function as it enables the **exportation of data back to the file system**, ensuring an exact replica of the original file is maintained.\n\nFor **storing a",
  "payloads": [
    "# Big Binary Files Upload in PostgreSQL",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## PostgreSQL Large Objects",
    "PostgreSQL offers a structure known as **large objects**, accessible via the `pg_largeobject` table, designed for storing large data types, such as images or PDF documents. This approach is advantageous over the `COPY TO` function as it enables the **exportation of data back to the file system**, ensuring an exact replica of the original file is maintained.",
    "For **storing a complete file** within this table, an object must be created in the `pg_largeobject` table (identified by a LOID), followed by the insertion of data chunks, each 2KB in size, into this object. It is crucial that these chunks are exactly 2KB in size (with the possible exception of the last chunk) to ensure the exporting function performs correctly.",
    "To **divide your binary data** into 2KB chunks, the following commands can be executed:",
    "```bash",
    "split -b 2048 your_file # Creates 2KB sized files",
    "For encoding each file into Base64 or Hex, the commands below can be used:",
    "```bash",
    "base64 -w 0 <Chunk_file> # Encodes in Base64 in one line",
    "xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line",
    "**Important**: When automating this process, ensure to send chunks of 2KB of clear-text bytes. Hex encoded files will require 4KB of data per chunk due to doubling in size, while Base64 encoded files follow the formula `ceil(n / 3) * 4`.",
    "The contents of the large objects can be viewed for debugging purposes using:",
    "```sql"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/sql-injection/postgresql-injection/big-binary-files-upload-postgresql.md"
  ]
}