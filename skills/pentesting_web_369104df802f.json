{
  "id": "pentesting_web_369104df802f",
  "category": "pentesting-web",
  "title": "dependency confusion",
  "description": "# Dependency Confusion\n\n{{#include ../banners/hacktricks-training.md}}\n\n\n## Basic Information\n\nDependency Confusion (a.k.a. substitution attacks) happens when a package manager resolves a dependency name from an unintended, less-trusted registry/source (usually a public registry) instead of the intended private/internal one. This typically leads to the installation of an attacker-controlled package.\n\nCommon root causes:\n- Typosquatting/misspelling: Importing `reqests` instead of `requests` (reso",
  "payloads": [
    "# Dependency Confusion",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Basic Information",
    "Dependency Confusion (a.k.a. substitution attacks) happens when a package manager resolves a dependency name from an unintended, less-trusted registry/source (usually a public registry) instead of the intended private/internal one. This typically leads to the installation of an attacker-controlled package.",
    "Common root causes:",
    "- Typosquatting/misspelling: Importing `reqests` instead of `requests` (resolves from public registry).",
    "- Non-existent/abandoned internal package: Importing `company-logging` that no longer exists internally, so the resolver looks in public registries and finds an attacker\u2019s package.",
    "- Version preference across multiple registries: Importing an internal `company-requests` while the resolver is allowed to also query public registries and prefers the \u201cbest\u201d/newer version published publicly by an attacker.",
    "Key idea: If the resolver can see multiple registries for the same package name and is allowed to pick the \u201cbest\u201d candidate globally, you\u2019re vulnerable unless you constrain resolution.",
    "## Exploitation",
    "> [!WARNING]",
    "> In all cases, the attacker only needs to publish a malicious package with the same name as the dependency your build resolves from a public registry. Installation-time hooks (e.g., npm scripts) or import-time code paths often give code execution.",
    "### Misspelled & Inexistent",
    "If your project references a library that isn\u2019t available in the private registry, and your tooling falls back to a public registry, an attacker can seed a malicious package with that name in the public registry. Your runners/CI/dev machines will fetch and execute it.",
    "### Unspecified Version / \u201cBest-version\u201d selection across indexes"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/dependency-confusion.md"
  ]
}