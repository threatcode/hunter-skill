{
  "id": "network_services_pentesting_aadeefab4bc3",
  "category": "network-services-pentesting",
  "title": "403 and 401 bypasses",
  "description": "# 403 & 401 Bypasses\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## HTTP Verbs/Methods Fuzzing\n\nTry using **different verbs** to access the file: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`\n\n- Check the response headers, maybe some information can be given. For example, a **200 response** to **HEAD** with `Content-Length: 55` means that the **HEAD verb can access the info**. But you still need to find a way to exfiltrate that info.\n- Using a HTTP header",
  "payloads": [
    "# 403 & 401 Bypasses",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## HTTP Verbs/Methods Fuzzing",
    "Try using **different verbs** to access the file: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`",
    "- Check the response headers, maybe some information can be given. For example, a **200 response** to **HEAD** with `Content-Length: 55` means that the **HEAD verb can access the info**. But you still need to find a way to exfiltrate that info.",
    "- Using a HTTP header like `X-HTTP-Method-Override: PUT` can overwrite the verb used.",
    "- Use **`TRACE`** verb and if you are very lucky maybe in the response you can see also the **headers added by intermediate proxies** that might be useful.",
    "## HTTP Headers Fuzzing",
    "- **Change Host header** to some arbitrary value ([that worked here](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))",
    "- Try to [**use other User Agents**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) to access the resource.",
    "- **Fuzz HTTP Headers**: Try using HTTP Proxy **Headers**, HTTP Authentication Basic and NTLM brute-force (with a few combinations only) and other techniques. To do all of this I have created the tool [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass).",
    "- `X-Originating-IP: 127.0.0.1`",
    "- `X-Forwarded-For: 127.0.0.1`",
    "- `X-Forwarded: 127.0.0.1`",
    "- `Forwarded-For: 127.0.0.1`"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/403-and-401-bypasses.md"
  ]
}