{
  "id": "binary_exploitation_a65b2c923079",
  "category": "binary-exploitation",
  "title": "house of rabbit",
  "description": "# House of Rabbit\n\n{{#include ../../banners/hacktricks-training.md}}\n\n### Requirements\n\n1. **Ability to modify fast bin fd pointer or size**: This means you can change the forward pointer of a chunk in the fastbin or its size.\n2. **Ability to trigger `malloc_consolidate`**: This can be done by either allocating a large chunk or merging the top chunk, which forces the heap to consolidate chunks.\n\n### Goals\n\n1. **Create overlapping chunks**: To have one chunk overlap with another, allowing for fur",
  "payloads": [
    "# House of Rabbit",
    "{{#include ../../banners/hacktricks-training.md}}",
    "### Requirements",
    "1. **Ability to modify fast bin fd pointer or size**: This means you can change the forward pointer of a chunk in the fastbin or its size.",
    "2. **Ability to trigger `malloc_consolidate`**: This can be done by either allocating a large chunk or merging the top chunk, which forces the heap to consolidate chunks.",
    "### Goals",
    "1. **Create overlapping chunks**: To have one chunk overlap with another, allowing for further heap manipulations.",
    "2. **Forge fake chunks**: To trick the allocator into treating a fake chunk as a legitimate chunk during heap operations.",
    "## Steps of the attack",
    "### POC 1: Modify the size of a fast bin chunk",
    "**Objective**: Create an overlapping chunk by manipulating the size of a fastbin chunk.",
    "- **Step 1: Allocate Chunks**",
    "```cpp",
    "unsigned long* chunk1 = malloc(0x40);  // Allocates a chunk of 0x40 bytes at 0x602000",
    "unsigned long* chunk2 = malloc(0x40);  // Allocates another chunk of 0x40 bytes at 0x602050"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/house-of-rabbit.md"
  ]
}