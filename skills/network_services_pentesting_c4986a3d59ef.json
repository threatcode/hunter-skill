{
  "id": "network_services_pentesting_c4986a3d59ef",
  "category": "network-services-pentesting",
  "title": "php rce abusing object creation new usd get a usd get b",
  "description": "# PHP - RCE abusing object creation: new $_GET[\"a\"]($_GET[\"b\"])\n\n{{#include ../../../banners/hacktricks-training.md}}\n\nThis is basically a summary of [https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/)\n\n## Introduction\n\nThe creation of new arbitrary objects, such as `new $_GET[\"a\"]($_GET[\"a\"])`, can lead to Remote Code Execution (RCE), as detailed in a [**writeup**](https://swarm.ptsecurity.com/explo",
  "payloads": [
    "# PHP - RCE abusing object creation: new $_GET[\"a\"]($_GET[\"b\"])",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "This is basically a summary of [https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/)",
    "## Introduction",
    "The creation of new arbitrary objects, such as `new $_GET[\"a\"]($_GET[\"a\"])`, can lead to Remote Code Execution (RCE), as detailed in a [**writeup**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/). This document highlights various strategies for achieving RCE.",
    "## RCE via Custom Classes or Autoloading",
    "The syntax `new $a($b)` is used to instantiate an object where **`$a`** represents the class name and **`$b`** is the first argument passed to the constructor. These variables can be sourced from user inputs like GET/POST, where they may be strings or arrays, or from JSON, where they might present as other types.",
    "Consider the code snippet below:",
    "```php",
    "class App {",
    "function __construct ($cmd) {",
    "system($cmd);",
    "class App2 {",
    "function App2 ($cmd) {",
    "system($cmd);"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.md"
  ]
}