{
  "id": "binary_exploitation_230417cb7d6e",
  "category": "binary-exploitation",
  "title": "bf forked stack canaries",
  "description": "# BF Forked & Threaded Stack Canaries\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n**If you are facing a binary protected by a canary and PIE (Position Independent Executable) you probably need to find a way to bypass them.**\n\n![](<../../../images/image (865).png>)\n\n> [!TIP]\n> Note that **`checksec`** might not find that a binary is protected by a canary if this was statically compiled and it's not capable to identify the function.\\\n> However, you can manually notice this if you find t",
  "payloads": [
    "# BF Forked & Threaded Stack Canaries",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "**If you are facing a binary protected by a canary and PIE (Position Independent Executable) you probably need to find a way to bypass them.**",
    "![](<../../../images/image (865).png>)",
    "> [!TIP]",
    "> Note that **`checksec`** might not find that a binary is protected by a canary if this was statically compiled and it's not capable to identify the function.\\",
    "> However, you can manually notice this if you find that a value is saved in the stack at the beginning of a function call and this value is checked before exiting.",
    "## Brute force Canary",
    "The best way to bypass a simple canary is if the binary is a program **forking child processes every time you establish a new connection** with it (network service), because every time you connect to it **the same canary will be used**.",
    "Then, the best way to bypass the canary is just to **brute-force it char by char**, and you can figure out if the guessed canary byte was correct checking if the program has crashed or continues its regular flow. In this example the function **brute-forces an 8 Bytes canary (x64)** and distinguish between a correct guessed byte and a bad byte just **checking** if a **response** is sent back by the server (another way in **other situation** could be using a **try/except**):",
    "### Example 1",
    "This example is implemented for 64bits but could be easily implemented for 32 bits.",
    "```python",
    "from pwn import *",
    "def connect():"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/common-binary-protections-and-bypasses/stack-canaries/bf-forked-stack-canaries.md"
  ]
}