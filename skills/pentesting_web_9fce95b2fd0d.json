{
  "id": "pentesting_web_9fce95b2fd0d",
  "category": "pentesting-web",
  "title": "java dns deserialization and gadgetprobe",
  "description": "# Java DNS Deserialization, GadgetProbe and Java Deserialization Scanner\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## DNS request on deserialization\n\nThe class `java.net.URL` implements `Serializable`, this means that this class can be serialized.\n\n```java\npublic final class URL implements java.io.Serializable {\n```\n\nThis class have a **curious behaviour.** From the documentation: \u201c**Two hosts are considered equivalent if both host names can be resolved into the same IP addresses**\u201d.\\\n",
  "payloads": [
    "# Java DNS Deserialization, GadgetProbe and Java Deserialization Scanner",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## DNS request on deserialization",
    "The class `java.net.URL` implements `Serializable`, this means that this class can be serialized.",
    "```java",
    "public final class URL implements java.io.Serializable {",
    "This class have a **curious behaviour.** From the documentation: \u201c**Two hosts are considered equivalent if both host names can be resolved into the same IP addresses**\u201d.\\",
    "Then, every-time an URL object calls **any** of the **functions `equals`** or **`hashCode`** a **DNS request** to get the IP Address is going to be **sent**.",
    "**Calling** the function **`hashCode`** **from** an **URL** object is fairly easy, it's enough to insert this object inside a `HashMap` that is going to be deserialized. This is because **at the end** of the **`readObject`** function from `HashMap` this code is executed:",
    "```java",
    "private void readObject(java.io.ObjectInputStream s)",
    "throws IOException, ClassNotFoundException {",
    "[   ...   ]",
    "for (int i = 0; i < mappings; i++) {",
    "[   ...   ]"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/java-dns-deserialization-and-gadgetprobe.md"
  ]
}