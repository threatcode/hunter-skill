{
  "id": "network_services_pentesting_2ce79faf4041",
  "category": "network-services-pentesting",
  "title": "4840 pentesting opc ua",
  "description": "# 4840 - Pentesting OPC UA\n\n{{#include ../banners/hacktricks-training.md}}\n\n\n## Basic Information\n\n**OPC UA**, standing for **Open Platform Communications Unified Access**, is a crucial open-source protocol used in various industries like Manufacturing, Energy, Aerospace, and Defence for data exchange and equipment control. It uniquely enables different vendors' equipment to communicate, especially with PLCs.\n\nIts configuration allows for strong security measures, but often, for compatibility wi",
  "payloads": [
    "# 4840 - Pentesting OPC UA",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Basic Information",
    "**OPC UA**, standing for **Open Platform Communications Unified Access**, is a crucial open-source protocol used in various industries like Manufacturing, Energy, Aerospace, and Defence for data exchange and equipment control. It uniquely enables different vendors' equipment to communicate, especially with PLCs.",
    "Its configuration allows for strong security measures, but often, for compatibility with older devices, these are lessened, exposing systems to risks. Additionally, finding OPC UA services can be tricky since network scanners might not detect them if they're on nonstandard ports.",
    "**Default port:** 4840 (binary `opc.tcp`). Many vendors expose separate discovery endpoints (`/discovery`), HTTPS bindings (4843/443), or vendor-specific listener ports such as 49320 (KepServerEX), 62541 (OPC Foundation reference stack) and 48050 (UaGateway). Expect multiple endpoints per host, each advertising transport profile, security policy and user-token support.",
    "| Built-in NodeId | Why it matters |",
    "| --- | --- |",
    "| `i=2253` (`0:Server`) | Holds `ServerArray`, vendor/product strings and namespace URIs.",
    "| `i=2256` (`ServerStatus`) | Reveals uptime, current state, and optionally build info.",
    "| `i=2267` (`ServerDiagnosticsSummary`) | Shows session counts, aborted requests, etc. Great for fingerprinting brute-force attempts.",
    "| `i=85` (`ObjectsFolder`) | Entry point to walk exposed device tags, methods and alarms.",
    "```text",
    "PORT     STATE SERVICE REASON",
    "4840/tcp open  unknown syn-ack"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/4840-pentesting-opc-ua.md"
  ]
}