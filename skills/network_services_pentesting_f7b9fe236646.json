{
  "id": "network_services_pentesting_f7b9fe236646",
  "category": "network-services-pentesting",
  "title": "microsoft sharepoint",
  "description": "# Microsoft SharePoint \u2013 Pentesting & Exploitation\n\n{{#include ../../banners/hacktricks-training.md}}\n\n> Microsoft SharePoint (on-premises) is built on top of ASP.NET/IIS.  Most of the classic web attack surface (ViewState, Web.Config, web shells, etc.) is therefore present, but SharePoint also ships with hundreds of proprietary ASPX pages and web services that dramatically enlarge the exposed attack surface.  This page collects practical tricks to enumerate, exploit and persist inside SharePoin",
  "payloads": [
    "# Microsoft SharePoint \u2013 Pentesting & Exploitation",
    "{{#include ../../banners/hacktricks-training.md}}",
    "> Microsoft SharePoint (on-premises) is built on top of ASP.NET/IIS.  Most of the classic web attack surface (ViewState, Web.Config, web shells, etc.) is therefore present, but SharePoint also ships with hundreds of proprietary ASPX pages and web services that dramatically enlarge the exposed attack surface.  This page collects practical tricks to enumerate, exploit and persist inside SharePoint environments with emphasis on the 2025 exploit chain disclosed by Unit42 (CVE-2025-49704/49706/53770/53771).",
    "## 1. Quick enumeration",
    "# favicon hash and keywords",
    "curl -s https://<host>/_layouts/15/images/SharePointHome.png",
    "curl -s https://<host>/_vti_bin/client.svc | file -  # returns WCF/XSI",
    "# version leakage (often in JS)",
    "curl -s https://<host>/_layouts/15/init.js | grep -i \"spPageContextInfo\"",
    "# interesting standard paths",
    "/_layouts/15/ToolPane.aspx               # vulnerable page used in 2025 exploit chain",
    "/_vti_bin/Lists.asmx                     # legacy SOAP service",
    "/_catalogs/masterpage/Forms/AllItems.aspx",
    "# enumerate sites & site-collections (requires at least Anonymous)",
    "python3 Office365-ADFSBrute/SharePointURLBrute.py -u https://<host>"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/microsoft-sharepoint.md"
  ]
}