{
  "id": "network_services_pentesting_092843ac37e6",
  "category": "network-services-pentesting",
  "title": "snmp rce",
  "description": "# SNMP RCE\n\n{{#include ../../banners/hacktricks-training.md}}\n\nSNMP can be exploited by an attacker if the administrator overlooks its default configuration on the device or server. By **abusing SNMP community with write permissions (rwcommunity)** on a Linux operating system, the attacker can execute commands on the server.\n\n## Extending Services with Additional Commands\n\nTo extend SNMP services and add extra commands, it is possible to append new **rows to the \"nsExtendObjects\" table**. This c",
  "payloads": [
    "# SNMP RCE",
    "{{#include ../../banners/hacktricks-training.md}}",
    "SNMP can be exploited by an attacker if the administrator overlooks its default configuration on the device or server. By **abusing SNMP community with write permissions (rwcommunity)** on a Linux operating system, the attacker can execute commands on the server.",
    "## Extending Services with Additional Commands",
    "To extend SNMP services and add extra commands, it is possible to append new **rows to the \"nsExtendObjects\" table**. This can be achieved by using the `snmpset` command and providing the necessary parameters, including the absolute path to the executable and the command to be executed:",
    "```bash",
    "snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \\",
    "'nsExtendStatus.\"evilcommand\"' = createAndGo \\",
    "'nsExtendCommand.\"evilcommand\"' = /bin/echo \\",
    "'nsExtendArgs.\"evilcommand\"' = 'hello world'",
    "## Injecting Commands for Execution",
    "Injecting commands to run on the SNMP service requires the existence and executability of the called binary/script. The **`NET-SNMP-EXTEND-MIB`** mandates providing the absolute path to the executable.",
    "To confirm the execution of the injected command, the `snmpwalk` command can be used to enumerate the SNMP service. The **output will display the command and its associated details**, including the absolute path:",
    "```bash",
    "snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-snmp/snmp-rce.md"
  ]
}