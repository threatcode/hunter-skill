{
  "id": "network_services_pentesting_1a28bb344bd7",
  "category": "network-services-pentesting",
  "title": "9000 pentesting fastcgi",
  "description": "# 9000 Pentesting FastCGI\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Basic Information\n\nIf you want to **learn what is FastCGI** check the following page:\n\n\n{{#ref}}\npentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-fpm-fastcgi.md\n{{#endref}}\n\nBy default **FastCGI** run in **port** **9000** and isn't recognized by nmap. **Usually** FastCGI only listen in **localhost**.\n\n## Enumeration / Quick checks\n\n* **Port scan:** `n",
  "payloads": [
    "# 9000 Pentesting FastCGI",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Basic Information",
    "If you want to **learn what is FastCGI** check the following page:",
    "{{#ref}}",
    "pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-fpm-fastcgi.md",
    "{{#endref}}",
    "By default **FastCGI** run in **port** **9000** and isn't recognized by nmap. **Usually** FastCGI only listen in **localhost**.",
    "## Enumeration / Quick checks",
    "* **Port scan:** `nmap -sV -p9000 <target>` (will often show \"unknown\" service; manually test).",
    "* **Probe FPM status page:** `SCRIPT_FILENAME=/status SCRIPT_NAME=/status REQUEST_METHOD=GET cgi-fcgi -bind -connect 127.0.0.1:9000` (default php-fpm `pm.status_path`).",
    "* **Find reachable sockets via SSRF:** if an HTTP service is exploitable for SSRF, try `gopher://127.0.0.1:9000/_...` payloads to hit the FastCGI listener.",
    "* **Nginx misconfigs:** `cgi.fix_pathinfo=1` with `fastcgi_split_path_info` errors let you append `/.php` to static files and reach PHP (code exec via traversal).",
    "## RCE",
    "It's quite easy to make FastCGI execute arbitrary code:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/9000-pentesting-fastcgi.md"
  ]
}