{
  "id": "mobile_pentesting_64538f40d6b6",
  "category": "mobile-pentesting",
  "title": "play integrity attestation bypass",
  "description": "# Play Integrity Attestation Bypass (SafetyNet Replacement)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## What Play Integrity Does\n\n**Play Integrity** is Google\u2019s SafetyNet successor for **app attestation**. The app calls the API, Google Play Services gathers software/hardware signals, sends them encrypted to `googleapis.com`, and Google returns a **JWT** that is *signed and encrypted* by Google. The app forwards the token to its backend, which validates the signature with Google\u2019s publ",
  "payloads": [
    "# Play Integrity Attestation Bypass (SafetyNet Replacement)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## What Play Integrity Does",
    "**Play Integrity** is Google\u2019s SafetyNet successor for **app attestation**. The app calls the API, Google Play Services gathers software/hardware signals, sends them encrypted to `googleapis.com`, and Google returns a **JWT** that is *signed and encrypted* by Google. The app forwards the token to its backend, which validates the signature with Google\u2019s public key, decrypts the payload, and enforces policy based on the verdict fields:",
    "- **`appIntegrity`**: APK build/signature match (no repack/tamper).",
    "- **`deviceIntegrity`**: genuine & certified device, locked bootloader, no root/system tamper.",
    "- **`accountDetails`**: installation via Google Play.",
    "Key verdict flags commonly enforced:",
    "- `MEETS_BASIC_INTEGRITY`: token generated by genuine Play Services (not emulator/tampered transport).",
    "- `MEETS_DEVICE_INTEGRITY`: genuine/certified device, bootloader locked, no root/system tamper.",
    "- `MEETS_STRONG_INTEGRITY`: requires `DEVICE` plus **recent security patches on all partitions (OS + vendor)**.",
    "## Bypass Model",
    "Instead of forging Google\u2019s JWT, **spoof the signals Google evaluates** so they correspond to a different, legitimate device profile. The attack chain:",
    "1) Hide root so local checks and Play Services probes don\u2019t see Magisk/su.",
    "2) Replace the **key attestation certificate chain** (`keybox.xml`) with one from a genuine device so Play Integrity sees a certified/locked device."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/play-integrity-attestation-bypass.md"
  ]
}