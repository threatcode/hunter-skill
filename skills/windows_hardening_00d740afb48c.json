{
  "id": "windows_hardening_00d740afb48c",
  "category": "windows-hardening",
  "title": "custom ssp",
  "description": "# Custom SSP\n\n{{#include ../../banners/hacktricks-training.md}}\n\n### Custom SSP\n\n[Learn what is a SSP (Security Support Provider) here.](../authentication-credentials-uac-and-efs/index.html#security-support-provider-interface-sspi)\\\nYou can create you **own SSP** to **capture** in **clear text** the **credentials** used to access the machine.\n\n#### Mimilib\n\nYou can use the `mimilib.dll` binary provided by Mimikatz. **This will log inside a file all the credentials in clear text.**\\\nDrop the dll ",
  "payloads": [
    "# Custom SSP",
    "{{#include ../../banners/hacktricks-training.md}}",
    "### Custom SSP",
    "[Learn what is a SSP (Security Support Provider) here.](../authentication-credentials-uac-and-efs/index.html#security-support-provider-interface-sspi)\\",
    "You can create you **own SSP** to **capture** in **clear text** the **credentials** used to access the machine.",
    "#### Mimilib",
    "You can use the `mimilib.dll` binary provided by Mimikatz. **This will log inside a file all the credentials in clear text.**\\",
    "Drop the dll in `C:\\Windows\\System32\\`\\",
    "Get a list existing LSA Security Packages:",
    "```bash:attacker@target",
    "PS C:\\> reg query hklm\\system\\currentcontrolset\\control\\lsa\\ /v \"Security Packages\"",
    "HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\control\\lsa",
    "Security Packages    REG_MULTI_SZ    kerberos\\0msv1_0\\0schannel\\0wdigest\\0tspkg\\0pku2u",
    "Add `mimilib.dll` to the Security Support Provider list (Security Packages):",
    "```bash"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/windows-hardening/active-directory-methodology/custom-ssp.md"
  ]
}