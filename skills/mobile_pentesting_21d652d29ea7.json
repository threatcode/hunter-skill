{
  "id": "mobile_pentesting_21d652d29ea7",
  "category": "mobile-pentesting",
  "title": "exploiting content providers",
  "description": "# Exploiting Content Providers\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Intro\n\nData is **supplied from one application to others** on request by a component known as a **content provider**. These requests are managed through the **ContentResolver class** methods. Content providers can store their data in various locations, such as a **database**, **files**, or over a **network**.\n\nIn the _Manifest.xml_ file, the declaration of the content provider is required. For instance:\n\n```",
  "payloads": [
    "# Exploiting Content Providers",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Intro",
    "Data is **supplied from one application to others** on request by a component known as a **content provider**. These requests are managed through the **ContentResolver class** methods. Content providers can store their data in various locations, such as a **database**, **files**, or over a **network**.",
    "In the _Manifest.xml_ file, the declaration of the content provider is required. For instance:",
    "```xml",
    "<provider android:name=\".DBContentProvider\" android:exported=\"true\" android:multiprocess=\"true\" android:authorities=\"com.mwr.example.sieve.DBContentProvider\">",
    "<path-permission android:readPermission=\"com.mwr.example.sieve.READ_KEYS\" android:writePermission=\"com.mwr.example.sieve.WRITE_KEYS\" android:path=\"/Keys\"/>",
    "</provider>",
    "To access `content://com.mwr.example.sieve.DBContentProvider/Keys`, the `READ_KEYS` permission is necessary. It's interesting to note that the path `/Keys/` is accessible in the following section, which is not protected due to a mistake by the developer, who secured `/Keys` but declared `/Keys/`.",
    "**Maybe you can access private data or exploit some vulnerability (SQL Injection or Path Traversal).**",
    "## Get info from **exposed content providers**",
    "dz> run app.provider.info -a com.mwr.example.sieve",
    "Package: com.mwr.example.sieve",
    "Authority: com.mwr.example.sieve.DBContentProvider"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/drozer-tutorial/exploiting-content-providers.md"
  ]
}