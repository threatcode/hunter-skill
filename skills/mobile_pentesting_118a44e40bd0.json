{
  "id": "mobile_pentesting_118a44e40bd0",
  "category": "mobile-pentesting",
  "title": "tapjacking",
  "description": "# Tapjacking\n\n{{#include ../../banners/hacktricks-training.md}}\n\n\n## **Basic Information**\n\n**Tapjacking** is an attack where a **malicious** **application** is launched and **positions itself on top of a victim application**. Once it visibly obscures the victim app, its user interface is designed in such a way as to trick the user to interact with it, while it is passing the interaction along to the victim app.\\\nIn effect, it is **blinding the user from knowing they are actually performing acti",
  "payloads": [
    "# Tapjacking",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## **Basic Information**",
    "**Tapjacking** is an attack where a **malicious** **application** is launched and **positions itself on top of a victim application**. Once it visibly obscures the victim app, its user interface is designed in such a way as to trick the user to interact with it, while it is passing the interaction along to the victim app.\\",
    "In effect, it is **blinding the user from knowing they are actually performing actions on the victim app**.",
    "### Detection",
    "* Look for **exported activities** in the Android manifest (an activity with an intent-filter is exported by default). If an exported activity is protected by a permission, the attacking app will need the **same permission**, which limits exploitability.",
    "* Check the **minimum SDK** version `android:minSdkVersion` in `AndroidManifest.xml`. If it is **lower than 30**, older default behaviors may make tapjacking easier to exploit.",
    "* At runtime, use `logcat` to spot blocked touches on Android 12+: the system logs `Untrusted touch due to occlusion by <package>` when overlays are filtered.",
    "### Protection",
    "#### Android 12+ default blocking & compat flags",
    "Android 12 (API 31) introduced **\"Block untrusted touches\"**: touches coming from another UID window of type `TYPE_APPLICATION_OVERLAY` (opacity \u22650.8) are dropped. This is enabled by default. During tests you can toggle it:",
    "```bash",
    "# disable blocking for a specific package (for PoC crafting)",
    "adb shell am compat disable BLOCK_UNTRUSTED_TOUCHES com.example.victim"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/tapjacking.md"
  ]
}