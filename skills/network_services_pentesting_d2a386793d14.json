{
  "id": "network_services_pentesting_d2a386793d14",
  "category": "network-services-pentesting",
  "title": "cgi",
  "description": "# CGI Pentesting\n\n{{#include ../../banners/hacktricks-training.md}}\n\n\n## Information\n\nThe **CGI scripts are perl scripts**, so, if you have compromised a server that can execute _**.cgi**_ scripts you can **upload a perl reverse shell** \\(`/usr/share/webshells/perl/perl-reverse-shell.pl`\\), **change the extension** from **.pl** to **.cgi**, give **execute permissions** \\(`chmod +x`\\) and **access** the reverse shell **from the web browser** to execute it.  \nIn order to test for **CGI vulns** it'",
  "payloads": [
    "# CGI Pentesting",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Information",
    "The **CGI scripts are perl scripts**, so, if you have compromised a server that can execute _**.cgi**_ scripts you can **upload a perl reverse shell** \\(`/usr/share/webshells/perl/perl-reverse-shell.pl`\\), **change the extension** from **.pl** to **.cgi**, give **execute permissions** \\(`chmod +x`\\) and **access** the reverse shell **from the web browser** to execute it.",
    "In order to test for **CGI vulns** it's recommended to use `nikto -C all` \\(and all the plugins\\)",
    "## **ShellShock**",
    "**ShellShock** is a **vulnerability** that affects the widely used **Bash** command-line shell in Unix-based operating systems. It targets the ability of Bash to run commands passed by applications. The vulnerability lies in the manipulation of **environment variables**, which are dynamic named values that impact how processes run on a computer. Attackers can exploit this by attaching **malicious code** to environment variables, which is executed upon receiving the variable. This allows attackers to potentially compromise the system.",
    "Exploiting this vulnerability the **page could throw an error**.",
    "You could **find** this vulnerability noticing that it is using an **old Apache version** and **cgi_mod** \\(with cgi folder\\) or using **nikto**.",
    "### **Test**",
    "Most tests are based in echo something and expect that that string is returned in the web response. If you think a page may be vulnerable, search for all the cgi pages and test them.",
    "**Nmap**",
    "```bash",
    "nmap 10.2.1.31 -p 80 --script=http-shellshock --script-args uri=/cgi-bin/admin.cgi",
    "## **Curl \\(reflected, blind and out-of-band\\)**"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/cgi.md"
  ]
}