{
  "id": "binary_exploitation_78afeebd3eec",
  "category": "binary-exploitation",
  "title": "ret2vdso",
  "description": "# Ret2vDSO\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nThere might be **gadgets in the vDSO region**, which is used to change from user mode to kernel mode. In these type of challenges, usually a kernel image is provided to dump the vDSO region.\n\nFollowing the example from [https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse/maze-of-mist/](https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse/maze-of-mist/) it's possible to see how it was possible to dum",
  "payloads": [
    "# Ret2vDSO",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "There might be **gadgets in the vDSO region**, which is used to change from user mode to kernel mode. In these type of challenges, usually a kernel image is provided to dump the vDSO region.",
    "Following the example from [https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse/maze-of-mist/](https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse/maze-of-mist/) it's possible to see how it was possible to dump the vdso section and move it to the host with:",
    "```bash",
    "# Find addresses",
    "cat /proc/76/maps",
    "08048000-08049000 r--p 00000000 00:02 317                                /target",
    "08049000-0804a000 r-xp 00001000 00:02 317                                /target",
    "0804a000-0804b000 rw-p 00002000 00:02 317                                /target",
    "f7ff8000-f7ffc000 r--p 00000000 00:00 0                                  [vvar]",
    "f7ffc000-f7ffe000 r-xp 00000000 00:00 0                                  [vdso]",
    "fffdd000-ffffe000 rw-p 00000000 00:00 0                                  [stack]",
    "# Dump it"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/rop-return-oriented-programing/ret2vdso.md"
  ]
}