{
  "id": "pentesting_web_96d3e03bcae6",
  "category": "pentesting-web",
  "title": "cookie tossing",
  "description": "# Cookie Tossing\n\n{{#include ../../banners/hacktricks-training.md}}\n\n### Description\n\nIf an attacker can **control a subdomain or the domain of a company or finds an XSS in a subdomain** he will be able to perform this attack.\n\nAs it was indicated in the Cookies Hacking section, when a **cookie is set to a domain (specifying it) it will be used in the domain and subdomains.**\n\n> [!CAUTION]\n> Therefore, **an attacker is going to be able to set to the domain and subdomains a specific cookie doing ",
  "payloads": [
    "# Cookie Tossing",
    "{{#include ../../banners/hacktricks-training.md}}",
    "### Description",
    "If an attacker can **control a subdomain or the domain of a company or finds an XSS in a subdomain** he will be able to perform this attack.",
    "As it was indicated in the Cookies Hacking section, when a **cookie is set to a domain (specifying it) it will be used in the domain and subdomains.**",
    "> [!CAUTION]",
    "> Therefore, **an attacker is going to be able to set to the domain and subdomains a specific cookie doing something like** `document.cookie=\"session=1234; Path=/app/login; domain=.example.com\"`",
    "This can be dangerous as the attacker may be able to:",
    "- **Fixate the cookie of the victim to the attacker's account** so if the user doesn't notice, **he will perform the actions in the attacker's account** and the attacker may obtain some interesting information (check the history of the searches of the user in the platform, the victim may set his credit card in the account...)",
    "- An example of this [can be found here](https://snyk.io/articles/hijacking-oauth-flows-via-cookie-tossing/) where the attacker set his cookie in specific sections a victim will use to authorize **access to his git repos but from the attackers account** as he will be setting his cookies in the needed endpoints.",
    "- If the **cookie doesn't change after login**, the attacker may just **fixate a cookie (session-fixation)**, wait until the victim logs in and then **use that cookie to log in as the victim**.",
    "- Sometimes, even if the session cookies changes, the attacker use the previous one and he will receive the new one also.",
    "- If the **cookie is setting some initial value** (like in flask where the **cookie** may **set** the **CSRF token** of the session and this value will be maintained after the victim logs in), the **attacker may set this known value and then abuse it** (in that scenario, the attacker may then make the user perform a CSRF request as he knows the CSRF token).",
    "- Just like setting the value, the attacker could also get an unauthenticated cookie generated by the server, get the CSRF token from it and use it.",
    "### Cookie Order"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/hacking-with-cookies/cookie-tossing.md"
  ]
}