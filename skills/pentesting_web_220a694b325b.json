{
  "id": "pentesting_web_220a694b325b",
  "category": "pentesting-web",
  "title": "forced extension load preferences mac forgery windows",
  "description": "# Forced Extension Load & Preferences MAC Forgery (Windows)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Overview\n\nStealthy post-exploitation technique to force-load arbitrary extensions in Chromium-based browsers on Windows by editing a user\u2019s Preferences/Secure Preferences and forging valid HMACs for the modified nodes. Works against Chrome/Chromium, Edge, and Brave. Observed to apply from Chromium 130 through 139 at publication time. A simple disk write primitive in the victim profi",
  "payloads": [
    "# Forced Extension Load & Preferences MAC Forgery (Windows)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Overview",
    "Stealthy post-exploitation technique to force-load arbitrary extensions in Chromium-based browsers on Windows by editing a user\u2019s Preferences/Secure Preferences and forging valid HMACs for the modified nodes. Works against Chrome/Chromium, Edge, and Brave. Observed to apply from Chromium 130 through 139 at publication time. A simple disk write primitive in the victim profile suffices to persist a full-privileged extension without command-line flags or user prompts.",
    "> Key idea: Chromium stores per-user extension state in a JSON preferences file and protects it with HMAC-SHA256. If you compute valid MACs with the browser\u2019s embedded seed and write them next to your injected nodes, the browser accepts and activates your extension entry.",
    "## Where extension state lives (Windows)",
    "- Non\u2013domain\u2011joined Chrome profile:",
    "- %USERPROFILE%/AppData/Local/Google/Chrome/User Data/Default/Secure Preferences (includes a root \"super_mac\").",
    "- Domain\u2011joined Chrome profile:",
    "- %USERPROFILE%/AppData/Local/Google/Chrome/User Data/Default/Preferences",
    "- Key nodes used by Chromium:",
    "- extensions.settings.<extension_id> \u2192 embedded manifest/metadata for the extension entry",
    "- protection.macs.extensions.settings.<extension_id> \u2192 HMAC for that JSON blob",
    "- Chromium \u2265134: extensions.ui.developer_mode (boolean) must be present and MAC\u2011signed for unpacked extensions to activate",
    "Simplified schema (illustrative):"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/browser-extension-pentesting-methodology/forced-extension-load-preferences-mac-forgery-windows.md"
  ]
}