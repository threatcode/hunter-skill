{
  "id": "macos_hardening_c484216ef9bd",
  "category": "macos-hardening",
  "title": "macos code signing",
  "description": "# macOS Code Signing\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Basic Information\n\n{{#ref}}\n../../../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/mach-o-entitlements-and-ipsw-indexing.md\n{{#endref}}\n\n\nMach-o binaries contains a load command called **`LC_CODE_SIGNATURE`** that indicates the **offset** and **size** of the signatures inside the binary. Actually, using the GUI tool MachOView, it's possible to find at the end of the ",
  "payloads": [
    "# macOS Code Signing",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "{{#ref}}",
    "../../../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/mach-o-entitlements-and-ipsw-indexing.md",
    "{{#endref}}",
    "Mach-o binaries contains a load command called **`LC_CODE_SIGNATURE`** that indicates the **offset** and **size** of the signatures inside the binary. Actually, using the GUI tool MachOView, it's possible to find at the end of the binary a section called **Code Signature** with this information:",
    "<figure><img src=\"../../../images/image (1) (1) (1) (1).png\" alt=\"\" width=\"431\"><figcaption></figcaption></figure>",
    "The magic header of the Code Signature is **`0xFADE0CC0`** (embedded code signature) or **`0xFADE0CC1`** (detached code signature). Then you have information such as the length and the number of blobs of the superBlob that contains them.\\",
    "It's possible to find this information in the [source code here](https://github.com/apple-oss-distributions/xnu/blob/94d3b452840153a99b38a3a9659680b2a006908e/osfmk/kern/cs_blobs.h#L276):",
    "* Structure of an embedded-signature SuperBlob",
    "typedef struct __BlobIndex {",
    "uint32_t type;                                  /* type of entry */",
    "uint32_t offset;                                /* offset of entry */",
    "} CS_BlobIndex"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-code-signing.md"
  ]
}