{
  "id": "pentesting_web_233ec089dc8f",
  "category": "pentesting-web",
  "title": "proxy waf protections bypass",
  "description": "# Proxy / WAF Protections Bypass\n\n{{#include ../banners/hacktricks-training.md}}\n\n\n## Bypass Nginx ACL Rules with Pathname Manipulation <a href=\"#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules\" id=\"heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules\"></a>\n\nTechniques [from this research](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies).\n\nNginx rule example:\n\n```plaintext\nlocation = /admin {\n    den",
  "payloads": [
    "# Proxy / WAF Protections Bypass",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Bypass Nginx ACL Rules with Pathname Manipulation <a href=\"#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules\" id=\"heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules\"></a>",
    "Techniques [from this research](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies).",
    "Nginx rule example:",
    "```plaintext",
    "location = /admin {",
    "deny all;",
    "location = /admin/ {",
    "deny all;",
    "In order to prevent bypasses Nginx performs path normalization before checking it. However, if the backend server performs a different normalization (removing characters that nginx doesn't remove) it might be possible to bypass this defense.",
    "### **NodeJS - Express**",
    "| Nginx Version | **Node.js Bypass Characters** |",
    "| ------------- | ----------------------------- |",
    "| 1.22.0        | `\\xA0`                        |"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/proxy-waf-protections-bypass.md"
  ]
}