{
  "id": "network_services_pentesting_3fc55e0eed56",
  "category": "network-services-pentesting",
  "title": "zabbix",
  "description": "# Zabbix Security\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Overview\n\nZabbix is a monitoring platform exposing a web UI (typically behind Apache/Nginx) and a server component that also talks the Zabbix protocol on TCP/10051 (server/trapper) and agent on TCP/10050. During engagements you may encounter:\n\n- Web UI: HTTP(S) virtual host like zabbix.example.tld\n- Zabbix server port: 10051/tcp (JSON over a ZBXD header framing)\n- Zabbix agent port: 10050/tcp\n\nUseful cookie format: zbx_sess",
  "payloads": [
    "# Zabbix Security",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Overview",
    "Zabbix is a monitoring platform exposing a web UI (typically behind Apache/Nginx) and a server component that also talks the Zabbix protocol on TCP/10051 (server/trapper) and agent on TCP/10050. During engagements you may encounter:",
    "- Web UI: HTTP(S) virtual host like zabbix.example.tld",
    "- Zabbix server port: 10051/tcp (JSON over a ZBXD header framing)",
    "- Zabbix agent port: 10050/tcp",
    "Useful cookie format: zbx_session is Base64 of a compact JSON object that includes at least sessionid, serverCheckResult, serverCheckTime and sign. The sign is an HMAC of the JSON payload.",
    "## zbx_session cookie internals",
    "Recent Zabbix versions compute the cookie like:",
    "- data JSON: {\"sessionid\":\"<32-hex>\",\"serverCheckResult\":true,\"serverCheckTime\":<unix_ts>}",
    "- sign: HMAC-SHA256(key=session_key, data=JSON string of data sorted by keys and compact separators)",
    "- Final cookie: Base64(JSON_with_sign)",
    "If you can recover the global session_key and a valid admin sessionid, you can forge a valid Admin cookie offline and authenticate to the UI.",
    "## CVE-2024-22120 \u2014 Time-based blind SQLi in Zabbix Server audit log"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/zabbix.md"
  ]
}