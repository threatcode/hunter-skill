{
  "id": "mobile_pentesting_d7b762b5c652",
  "category": "mobile-pentesting",
  "title": "android hce nfc emv relay attacks",
  "description": "# Android HCE NFC/EMV Relay Attacks\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Overview\n\nAbuse of Android Host Card Emulation (HCE) allows a malicious app set as the default NFC payment service to relay EMV contactless transactions in real-time. The POS terminal talks ISO 14443-4/EMV to the phone; the app\u2019s HostApduService receives APDUs and forwards them over a bidirectional C2 (often WebSocket) to a backend that crafts responses, which are relayed back to the POS. This enables live",
  "payloads": [
    "# Android HCE NFC/EMV Relay Attacks",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Overview",
    "Abuse of Android Host Card Emulation (HCE) allows a malicious app set as the default NFC payment service to relay EMV contactless transactions in real-time. The POS terminal talks ISO 14443-4/EMV to the phone; the app\u2019s HostApduService receives APDUs and forwards them over a bidirectional C2 (often WebSocket) to a backend that crafts responses, which are relayed back to the POS. This enables live card emulation without local card data. Campaigns observed at scale rebrand as banks/government apps, prompt to become the default payment app, and auto-exfiltrate device/card data to Telegram bots/channels.",
    "Key traits",
    "- Android components: HostApduService + default NFC payment handler (category \"payment\")",
    "- Transport/C2: WebSocket for APDU relay; Telegram bot API for exfil/ops",
    "- Operator workflow: structured commands (login, register_device, apdu_command/apdu_response, get_pin/pin_response, paired, check_status, update_required, telegram_notification, error)",
    "- Roles: scanner (read EMV data) vs tapper (HCE/relay) builds",
    "## Minimal implementation building blocks",
    "### Manifest (become default payment HCE service)",
    "```xml",
    "<uses-feature android:name=\"android.hardware.nfc.hce\" android:required=\"true\"/>",
    "<uses-permission android:name=\"android.permission.NFC\"/>",
    "<application ...>"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/android-hce-nfc-emv-relay-attacks.md"
  ]
}