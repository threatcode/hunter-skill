{
  "id": "pentesting_web_76815e6db182",
  "category": "pentesting-web",
  "title": "livewire hydration synthesizer abuse",
  "description": "# Laravel Livewire Hydration & Synthesizer Abuse\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Recap of the Livewire state machine\n\nLivewire 3 components exchange their state through **snapshots** that contain `data`, `memo`, and a checksum. Every POST to `/livewire/update` rehydrates the JSON snapshot server-side and executes the queued `calls`/`updates`.\n\n```php\nclass Checksum {\n    static function verify($snapshot) {\n        $checksum = $snapshot['checksum'];\n        unset($snapshot[",
  "payloads": [
    "# Laravel Livewire Hydration & Synthesizer Abuse",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Recap of the Livewire state machine",
    "Livewire 3 components exchange their state through **snapshots** that contain `data`, `memo`, and a checksum. Every POST to `/livewire/update` rehydrates the JSON snapshot server-side and executes the queued `calls`/`updates`.",
    "```php",
    "class Checksum {",
    "static function verify($snapshot) {",
    "$checksum = $snapshot['checksum'];",
    "unset($snapshot['checksum']);",
    "if ($checksum !== self::generate($snapshot)) {",
    "throw new CorruptComponentPayloadException;",
    "static function generate($snapshot) {",
    "return hash_hmac('sha256', json_encode($snapshot), $hashKey);",
    "Anyone holding `APP_KEY` (used to derive `$hashKey`) can therefore forge arbitrary snapshots by recomputing the HMAC.",
    "Complex properties are encoded as **synthetic tuples** detected by `Livewire\\Drawer\\BaseUtils::isSyntheticTuple()`; each tuple is `[value, {\"s\":\"<key>\", ...meta}]`. The hydration core simply delegates every tuple to the synth selected in `HandleComponents::$propertySynthesizers` and recurses over children:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/livewire-hydration-synthesizer-abuse.md"
  ]
}