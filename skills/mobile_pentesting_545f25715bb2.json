{
  "id": "mobile_pentesting_545f25715bb2",
  "category": "mobile-pentesting",
  "title": "inputmethodservice ime abuse",
  "description": "# Android IME / InputMethodService Abuse (Malicious Keyboards)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Overview\n\nAndroid allows third-party keyboards via an `InputMethodService` (IME). Once a user **enables** a keyboard and selects it as the **current input method**, the IME can observe (and influence) essentially **all text input** produced on the device across apps.\n\nThis is why several Android banking trojans bundle a \u201csecure keyboard\u201d feature: the malicious IME receives keystr",
  "payloads": [
    "# Android IME / InputMethodService Abuse (Malicious Keyboards)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Overview",
    "Android allows third-party keyboards via an `InputMethodService` (IME). Once a user **enables** a keyboard and selects it as the **current input method**, the IME can observe (and influence) essentially **all text input** produced on the device across apps.",
    "This is why several Android banking trojans bundle a \u201csecure keyboard\u201d feature: the malicious IME receives keystrokes even from apps that never embed a `WebView` (banking apps, chat apps, crypto wallets, etc.).",
    "> [!NOTE]",
    "> `android.permission.BIND_INPUT_METHOD` is typically declared on the IME *service* so only the system can bind to it. Declaring it doesn\u2019t grant special privileges by itself; the key step is getting the victim to **enable/select** the keyboard in Settings.",
    "## Manifest declaration",
    "A keyboard is exposed via a service with the `android.view.InputMethod` intent action and an IME configuration XML:",
    "```xml",
    "<!-- AndroidManifest.xml -->",
    "<service",
    "android:name=\".SpyKeyboard\"",
    "android:permission=\"android.permission.BIND_INPUT_METHOD\"",
    "android:exported=\"false\">"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/inputmethodservice-ime-abuse.md"
  ]
}