{
  "id": "binary_exploitation_0c0eb551ba35",
  "category": "binary-exploitation",
  "title": "ret2csu",
  "description": "# Ret2csu\n\n{{#include ../../banners/hacktricks-training.md}}\n\n##\n\n## [https://www.scs.stanford.edu/brop/bittau-brop.pdf](https://www.scs.stanford.edu/brop/bittau-brop.pdf)Basic Information\n\n**ret2csu** is a hacking technique used when you're trying to take control of a program but can't find the **gadgets** you usually use to manipulate the program's behavior.\n\nWhen a program uses certain libraries (like libc), it has some built-in functions for managing how different pieces of the program talk ",
  "payloads": [
    "# Ret2csu",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## [https://www.scs.stanford.edu/brop/bittau-brop.pdf](https://www.scs.stanford.edu/brop/bittau-brop.pdf)Basic Information",
    "**ret2csu** is a hacking technique used when you're trying to take control of a program but can't find the **gadgets** you usually use to manipulate the program's behavior.",
    "When a program uses certain libraries (like libc), it has some built-in functions for managing how different pieces of the program talk to each other. Among these functions are some hidden gems that can act as our missing gadgets, especially one called `__libc_csu_init`.",
    "### The Magic Gadgets in \\_\\_libc_csu_init",
    "In **`__libc_csu_init`**, there are two sequences of instructions (gadgets) to highlight:",
    "1. The first sequence lets us set up values in several registers (rbx, rbp, r12, r13, r14, r15). These are like slots where we can store numbers or addresses we want to use later.",
    "```armasm",
    "pop rbx;",
    "pop rbp;",
    "pop r12;",
    "pop r13;",
    "pop r14;",
    "pop r15;"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/rop-return-oriented-programing/ret2csu.md"
  ]
}