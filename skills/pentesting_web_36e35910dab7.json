{
  "id": "pentesting_web_36e35910dab7",
  "category": "pentesting-web",
  "title": "lfi2rce via phpinfo",
  "description": "# LFI to RCE via PHPInfo\n\n{{#include ../../banners/hacktricks-training.md}}\n\nTo exploit this technique you need all of the following:\n- A reachable page that prints phpinfo() output.\n- A Local File Inclusion (LFI) primitive you control (e.g., include/require on user input).\n- PHP file uploads enabled (file_uploads = On). Any PHP script will accept RFC1867 multipart uploads and create a temporary file for each uploaded part.\n- The PHP worker must be able to write to the configured upload_tmp_dir ",
  "payloads": [
    "# LFI to RCE via PHPInfo",
    "{{#include ../../banners/hacktricks-training.md}}",
    "To exploit this technique you need all of the following:",
    "- A reachable page that prints phpinfo() output.",
    "- A Local File Inclusion (LFI) primitive you control (e.g., include/require on user input).",
    "- PHP file uploads enabled (file_uploads = On). Any PHP script will accept RFC1867 multipart uploads and create a temporary file for each uploaded part.",
    "- The PHP worker must be able to write to the configured upload_tmp_dir (or default system temp directory) and your LFI must be able to include that path.",
    "Classic write-up and original PoC:",
    "- Whitepaper: LFI with PHPInfo() Assistance (B. Moore, 2011)",
    "- Original PoC script name: phpinfolfi.py (see whitepaper and mirrors)",
    "Tutorial HTB: https://www.youtube.com/watch?v=rs4zEwONzzk&t=600s",
    "Notes about the original PoC",
    "- The phpinfo() output is HTML-encoded, so the \"=>\" arrow often appears as \"=&gt;\". If you reuse legacy scripts, ensure they search for both encodings when parsing the _FILES[tmp_name] value.",
    "- You must adapt the payload (your PHP code), REQ1 (the request to the phpinfo() endpoint including padding), and LFIREQ (the request to your LFI sink). Some targets don\u2019t need a null-byte (%00) terminator and modern PHP versions won\u2019t honor it. Adjust the LFIREQ accordingly to the vulnerable sink.",
    "Example sed (only if you really use the old Python2 PoC) to match HTML-encoded arrow:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/file-inclusion/lfi2rce-via-phpinfo.md"
  ]
}