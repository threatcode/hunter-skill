{
  "id": "pentesting_web_3f5a63ea501d",
  "category": "pentesting-web",
  "title": "jndi java naming and directory interface and log4shell",
  "description": "# JNDI - Java Naming and Directory Interface & Log4Shell\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nJNDI, integrated into Java since the late 1990s, serves as a directory service, enabling Java programs to locate data or objects through a naming system. It supports various directory services via service provider interfaces (SPIs), allowing data retrieval from different systems, including remote Java objects. Common SPIs include CORBA COS, Java RMI Registry, and LDA",
  "payloads": [
    "# JNDI - Java Naming and Directory Interface & Log4Shell",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "JNDI, integrated into Java since the late 1990s, serves as a directory service, enabling Java programs to locate data or objects through a naming system. It supports various directory services via service provider interfaces (SPIs), allowing data retrieval from different systems, including remote Java objects. Common SPIs include CORBA COS, Java RMI Registry, and LDAP.",
    "### JNDI Naming Reference",
    "Java objects can be stored and retrieved using JNDI Naming References, which come in two forms:",
    "- **Reference Addresses**: Specifies an object's location (e.g., _rmi://server/ref_), allowing direct retrieval from the specified address.",
    "- **Remote Factory**: References a remote factory class. When accessed, the class is downloaded and instantiated from the remote location.",
    "However, this mechanism can be exploited, potentially leading to the loading and execution of arbitrary code. As a countermeasure:",
    "- **RMI**: `java.rmi.server.useCodeabseOnly = true` by default from JDK 7u21, restricting remote object loading. A Security Manager further limits what can be loaded.",
    "- **LDAP**: `com.sun.jndi.ldap.object.trustURLCodebase = false` by default from JDK 6u141, 7u131, 8u121, blocking the execution of remotely loaded Java objects. If set to `true`, remote code execution is possible without a Security Manager's oversight.",
    "- **CORBA**: Doesn't have a specific property, but the Security Manager is always active.",
    "However, the **Naming Manager**, responsible for resolving JNDI links, lacks built-in security mechanisms, potentially allowing the retrieval of objects from any source. This poses a risk as RMI, LDAP, and CORBA protections can be circumvented, leading to the loading of arbitrary Java objects or exploiting existing application components (gadgets) to run malicious code.",
    "Examples of exploitable URLs include:",
    "- _rmi://attacker-server/bar_"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/jndi-java-naming-and-directory-interface-and-log4shell.md"
  ]
}