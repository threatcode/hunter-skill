{
  "id": "mobile_pentesting_e910bfd7ca0d",
  "category": "mobile-pentesting",
  "title": "ios custom uri handlers deeplinks custom schemes",
  "description": "# iOS Custom URI Handlers / Deeplinks / Custom Schemes\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nCustom URL schemes enable apps to communicate using a custom protocol, as detailed in the [Apple Developer Documentation](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1). These schemes must be declared by the app, which then ha",
  "payloads": [
    "# iOS Custom URI Handlers / Deeplinks / Custom Schemes",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "Custom URL schemes enable apps to communicate using a custom protocol, as detailed in the [Apple Developer Documentation](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1). These schemes must be declared by the app, which then handles incoming URLs following those schemes. It's crucial to **validate all URL parameters** and **discard any malformed URLs** to prevent attacks through this vector.",
    "An example is given where the URI `myapp://hostname?data=123876123` invokes a specific application action. A noted vulnerability was in the Skype Mobile app, which allowed unpermitted call actions via the `skype://` protocol. The registered schemes can be found in the app's `Info.plist` under `CFBundleURLTypes`. Malicious applications can exploit this by re-registering URIs to intercept sensitive information.",
    "### Application Query Schemes Registration",
    "From iOS 9.0, to check if an app is available, `canOpenURL:` requires declaring URL schemes in the `Info.plist` under `LSApplicationQueriesSchemes`. This limits the schemes an app can query to 50, enhancing privacy by preventing app enumeration.",
    "```xml",
    "<key>LSApplicationQueriesSchemes</key>",
    "<array>",
    "<string>url_scheme1</string>",
    "<string>url_scheme2</string>",
    "</array>",
    "### Testing URL Handling and Validation",
    "Developers should inspect specific methods in the source code to understand URL path construction and validation, such as `application:didFinishLaunchingWithOptions:` and `application:openURL:options:`. For instance, Telegram employs various methods for opening URLs:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/ios-pentesting/ios-custom-uri-handlers-deeplinks-custom-schemes.md"
  ]
}