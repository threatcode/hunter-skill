{
  "id": "binary_exploitation_f8f3cccfcb9c",
  "category": "binary-exploitation",
  "title": "www2exec .dtors and .fini array",
  "description": "# WWW2Exec - .dtors & .fini_array\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## .dtors\n\n> [!CAUTION]\n> Nowadays is very **weird to find a binary with a .dtors section!**\n\nThe destructors are functions that are **executed before program finishes** (after the `main` function returns).\\\nThe addresses to these functions are stored inside the **`.dtors`** section of the binary and therefore, if you manage to **write** the **address** to a **shellcode** in **`__DTOR_END__`** , that will be **",
  "payloads": [
    "# WWW2Exec - .dtors & .fini_array",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## .dtors",
    "> [!CAUTION]",
    "> Nowadays is very **weird to find a binary with a .dtors section!**",
    "The destructors are functions that are **executed before program finishes** (after the `main` function returns).\\",
    "The addresses to these functions are stored inside the **`.dtors`** section of the binary and therefore, if you manage to **write** the **address** to a **shellcode** in **`__DTOR_END__`** , that will be **executed** before the programs ends.",
    "Get the address of this section with:",
    "```bash",
    "objdump -s -j .dtors /exec",
    "rabin -s /exec | grep \u201c__DTOR\u201d",
    "Usually you will find the **DTOR** markers **between** the values `ffffffff` and `00000000`. So if you just see those values, it means that there **isn't any function registered**. So **overwrite** the **`00000000`** with the **address** to the **shellcode** to execute it.",
    "> [!WARNING]",
    "> Ofc, you first need to find a **place to store the shellcode** in order to later call it.",
    "## **.fini_array**"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/arbitrary-write-2-exec/www2exec-.dtors-and-.fini_array.md"
  ]
}