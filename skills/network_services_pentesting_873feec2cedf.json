{
  "id": "network_services_pentesting_873feec2cedf",
  "category": "network-services-pentesting",
  "title": "electron contextisolation rce via ipc",
  "description": "# Electron contextIsolation RCE via IPC\n\n{{#include ../../../banners/hacktricks-training.md}}\n\nIf the preload script exposes an IPC endpoint from the main.js file, the renderer process will be able to access it and if vulnerable, a RCE might be possible.\n\n**Most of these examples were taken from here** [**https://www.youtube.com/watch?v=xILfQGkLXQo**](https://www.youtube.com/watch?v=xILfQGkLXQo). Check the video for further information.\n\n## Example 0\n\nExample from [https://speakerdeck.com/masato",
  "payloads": [
    "# Electron contextIsolation RCE via IPC",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "If the preload script exposes an IPC endpoint from the main.js file, the renderer process will be able to access it and if vulnerable, a RCE might be possible.",
    "**Most of these examples were taken from here** [**https://www.youtube.com/watch?v=xILfQGkLXQo**](https://www.youtube.com/watch?v=xILfQGkLXQo). Check the video for further information.",
    "## Example 0",
    "Example from [https://speakerdeck.com/masatokinugawa/how-i-hacked-microsoft-teams-and-got-150000-dollars-in-pwn2own?slide=21](https://speakerdeck.com/masatokinugawa/how-i-hacked-microsoft-teams-and-got-150000-dollars-in-pwn2own?slide=21) (you have the full example of how MS Teams was abusing from XSS to RCE in those slides, this is just a very basic example):",
    "<figure><img src=\"../../../images/image (9) (1) (1) (1) (1).png\" alt=\"\"><figcaption></figcaption></figure>",
    "## Example 1",
    "Check how the `main.js` listens on `getUpdate` and will **download and execute any URL** passed.\\",
    "Check also how `preload.js` **exposes any IPC** event from main.",
    "```javascript",
    "// Part of code of main.js",
    "ipcMain.on(\"getUpdate\", (event, url) => {",
    "console.log(\"getUpdate: \" + url)",
    "mainWindow.webContents.downloadURL(url)"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-ipc.md"
  ]
}