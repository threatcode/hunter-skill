{
  "id": "pentesting_web_49778a3dc9c0",
  "category": "pentesting-web",
  "title": "java signedobject gated deserialization",
  "description": "# Java SignedObject-gated Deserialization and Pre-auth Reachability via Error Paths\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThis page documents a common \"guarded\" Java deserialization pattern built around java.security.SignedObject and how seemingly unreachable sinks can become pre-auth reachable via error-handling flows. The technique was observed in Fortra GoAnywhere MFT (CVE-2025-10035) but is applicable to similar designs.\n\n## Threat model\n\n- Attacker can reach an HTTP endpoint t",
  "payloads": [
    "# Java SignedObject-gated Deserialization and Pre-auth Reachability via Error Paths",
    "{{#include ../../banners/hacktricks-training.md}}",
    "This page documents a common \"guarded\" Java deserialization pattern built around java.security.SignedObject and how seemingly unreachable sinks can become pre-auth reachable via error-handling flows. The technique was observed in Fortra GoAnywhere MFT (CVE-2025-10035) but is applicable to similar designs.",
    "## Threat model",
    "- Attacker can reach an HTTP endpoint that eventually processes an attacker-supplied byte[] intended to be a serialized SignedObject.",
    "- The code uses a validating wrapper (e.g., Apache Commons IO ValidatingObjectInputStream or a custom adapter) to constrain the outermost type to SignedObject (or byte[]).",
    "- The inner object returned by SignedObject.getObject() is where gadget chains can trigger (e.g., CommonsBeanutils1), but only after a signature verification gate.",
    "## Typical vulnerable pattern",
    "A simplified example based on com.linoma.license.gen2.BundleWorker.verify:",
    "```java",
    "private static byte[] verify(byte[] payload, KeyConfig keyCfg) throws Exception {",
    "String sigAlg = \"SHA1withDSA\";",
    "if (\"2\".equals(keyCfg.getVersion())) {",
    "sigAlg = \"SHA512withRSA\";        // key version controls algorithm",
    "PublicKey pub = getPublicKey(keyCfg);"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/deserialization/java-signedobject-gated-deserialization.md"
  ]
}