{
  "id": "network_services_pentesting_faa9b57ec25d",
  "category": "network-services-pentesting",
  "title": "werkzeug",
  "description": "# Werkzeug / Flask Debug\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Console RCE\n\nIf debug is active you could try to access to `/console` and gain RCE.\n\n```python\n__import__('os').popen('whoami').read();\n```\n\n![](<../../images/image (117).png>)\n\nThere is also several exploits on the internet like [this ](https://github.com/its-arun/Werkzeug-Debug-RCE)or one in metasploit.\n\n## Pin Protected - Path Traversal\n\nIn some occasions the **`/console`** endpoint is going to be protected by a p",
  "payloads": [
    "# Werkzeug / Flask Debug",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Console RCE",
    "If debug is active you could try to access to `/console` and gain RCE.",
    "```python",
    "__import__('os').popen('whoami').read();",
    "![](<../../images/image (117).png>)",
    "There is also several exploits on the internet like [this ](https://github.com/its-arun/Werkzeug-Debug-RCE)or one in metasploit.",
    "## Pin Protected - Path Traversal",
    "In some occasions the **`/console`** endpoint is going to be protected by a pin. If you have a **file traversal vulnerability**, you can leak all the necessary info to generate that pin.",
    "### Werkzeug Console PIN Exploit",
    "Force a debug error page in the app to see this:",
    "The console is locked and needs to be unlocked by entering the PIN.",
    "You can find the PIN printed out on the standard output of your",
    "shell that runs the server"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/werkzeug.md"
  ]
}