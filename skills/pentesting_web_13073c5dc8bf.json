{
  "id": "pentesting_web_13073c5dc8bf",
  "category": "pentesting-web",
  "title": "less code injection",
  "description": "# LESS Code Injection leading to SSRF & Local File Read\n\n{{#include ../../../banners/hacktricks-training.md}}\n\nLESS is a popular CSS pre-processor that adds variables, mixins, functions and the powerful `@import` directive.  During compilation the LESS engine will **fetch the resources referenced in `@import`** statements and embed (\"inline\") their contents into the resulting CSS when the `(inline)` option is used.\n\nWhen an application concatenates **user-controlled input** into a string that is",
  "payloads": [
    "# LESS Code Injection leading to SSRF & Local File Read",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "LESS is a popular CSS pre-processor that adds variables, mixins, functions and the powerful `@import` directive.  During compilation the LESS engine will **fetch the resources referenced in `@import`** statements and embed (\"inline\") their contents into the resulting CSS when the `(inline)` option is used.",
    "When an application concatenates **user-controlled input** into a string that is later parsed by the LESS compiler, an attacker can **inject arbitrary LESS code**.  By abusing `@import (inline)` the attacker can force the server to retrieve:",
    "* Local files via the `file://` protocol (information disclosure / Local File Inclusion).",
    "* Remote resources on internal networks or cloud metadata services (SSRF).",
    "This technique has been seen in real-world products such as **SugarCRM \u2264 14.0.0** (`/rest/v10/css/preview` endpoint).",
    "### Exploitation",
    "1. Identify a parameter that is directly embedded inside a stylesheet string processed by the LESS engine (e.g. `?lm=` in SugarCRM).",
    "2. Close the current statement and inject new directives.  The most common primitives are:",
    "* `;`  \u2013 terminates the previous declaration.",
    "* `}`  \u2013 closes the previous block (if required).",
    "3. Use `@import (inline) '<URL>';` to read arbitrary resources.",
    "4. Optionally inject a **marker** (`data:` URI) after the import to ease extraction of the fetched content from the compiled CSS.",
    "#### Local File Read"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/xs-search/css-injection/less-code-injection.md"
  ]
}