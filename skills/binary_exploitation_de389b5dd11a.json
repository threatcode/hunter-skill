{
  "id": "binary_exploitation_de389b5dd11a",
  "category": "binary-exploitation",
  "title": "unlink",
  "description": "# unlink\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n### Code\n\n```c\n// From https://github.com/bminor/glibc/blob/master/malloc/malloc.c\n\n/* Take a chunk off a bin list.  */\nstatic void\nunlink_chunk (mstate av, mchunkptr p)\n{\n  if (chunksize (p) != prev_size (next_chunk (p)))\n    malloc_printerr (\"corrupted size vs. prev_size\");\n\n  mchunkptr fd = p->fd;\n  mchunkptr bk = p->bk;\n\n  if (__builtin_expect (fd->bk != p || bk->fd != p, 0))\n    malloc_printerr (\"corrupted double-linked list\");",
  "payloads": [
    "# unlink",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "### Code",
    "// From https://github.com/bminor/glibc/blob/master/malloc/malloc.c",
    "/* Take a chunk off a bin list.  */",
    "static void",
    "unlink_chunk (mstate av, mchunkptr p)",
    "if (chunksize (p) != prev_size (next_chunk (p)))",
    "malloc_printerr (\"corrupted size vs. prev_size\");",
    "mchunkptr fd = p->fd;",
    "mchunkptr bk = p->bk;",
    "if (__builtin_expect (fd->bk != p || bk->fd != p, 0))",
    "malloc_printerr (\"corrupted double-linked list\");",
    "fd->bk = bk;",
    "bk->fd = fd;"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/libc-heap/heap-memory-functions/unlink.md"
  ]
}