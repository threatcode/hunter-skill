{
  "id": "pentesting_web_40ef99a6752a",
  "category": "pentesting-web",
  "title": "regular expression denial of service redos",
  "description": "# Regular expression Denial of Service - ReDoS\n\n{{#include ../banners/hacktricks-training.md}}\n\n# Regular Expression Denial of Service (ReDoS)\n\nA **Regular Expression Denial of Service (ReDoS)** happens when someone takes advantage of weaknesses in how regular expressions (a way to search and match patterns in text) work. Sometimes, when regular expressions are used, they can become very slow, especially if the piece of text they're working with gets larger. This slowness can get so bad that it ",
  "payloads": [
    "# Regular expression Denial of Service - ReDoS",
    "{{#include ../banners/hacktricks-training.md}}",
    "# Regular Expression Denial of Service (ReDoS)",
    "A **Regular Expression Denial of Service (ReDoS)** happens when someone takes advantage of weaknesses in how regular expressions (a way to search and match patterns in text) work. Sometimes, when regular expressions are used, they can become very slow, especially if the piece of text they're working with gets larger. This slowness can get so bad that it grows really fast with even small increases in the text size. Attackers can use this problem to make a program that uses regular expressions stop working properly for a long time.",
    "## The Problematic Regex Na\u00efve Algorithm",
    "**Check the details in [https://owasp.org/www-community/attacks/Regular*expression_Denial_of_Service*-_ReDoS](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)**",
    "### Engine behavior and exploitability",
    "- Most popular engines (PCRE, Java `java.util.regex`, Python `re`, JavaScript `RegExp`) use a **backtracking** VM. Crafted inputs that create many overlapping ways to match a subpattern force exponential or high-polynomial backtracking.",
    "- Some engines/libraries are designed to be **ReDoS-resilient** by construction (no backtracking), e.g. **RE2** and ports based on finite automata that provide worst\u2011case linear time; using them for untrusted input removes the backtracking DoS primitive. See the references at the end for details.",
    "## Evil Regexes <a href=\"#evil-regexes\" id=\"evil-regexes\"></a>",
    "An evil regular expression pattern is that one that can **get stuck on crafted input causing a DoS**. Evil regex patterns typically contain grouping with repetition and repetition or alternation with overlapping inside the repeated group. Some examples of evil patterns include:",
    "- (a+)+",
    "- ([a-zA-Z]+)\\*",
    "- (a|aa)+",
    "- (a|a?)+"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/regular-expression-denial-of-service-redos.md"
  ]
}