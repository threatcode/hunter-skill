{
  "id": "macos_hardening_744d523ca8f4",
  "category": "macos-hardening",
  "title": "macos dangerous entitlements",
  "description": "# macOS Dangerous Entitlements & TCC perms\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n> [!WARNING]\n> Note that entitlements starting with **`com.apple`** are not available to third-parties, only Apple can grant them... Or if you are using an enterprise certificate you could create your own entitlements starting with **`com.apple`** actually and bypass protections based on this.\n\n## High\n\n### `com.apple.rootless.install.heritable`\n\nThe entitlement **`com.apple.rootless.install.heritab",
  "payloads": [
    "# macOS Dangerous Entitlements & TCC perms",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "> [!WARNING]",
    "> Note that entitlements starting with **`com.apple`** are not available to third-parties, only Apple can grant them... Or if you are using an enterprise certificate you could create your own entitlements starting with **`com.apple`** actually and bypass protections based on this.",
    "## High",
    "### `com.apple.rootless.install.heritable`",
    "The entitlement **`com.apple.rootless.install.heritable`** allows to **bypass SIP**. Check [this for more info](macos-sip.md#com.apple.rootless.install.heritable).",
    "### **`com.apple.rootless.install`**",
    "The entitlement **`com.apple.rootless.install`** allows to **bypass SIP**. Check[ this for more info](macos-sip.md#com.apple.rootless.install).",
    "### **`com.apple.system-task-ports` (previously called `task_for_pid-allow`)**",
    "This entitlement allows to get the **task port for any** process, except the kernel. Check [**this for more info**](../macos-proces-abuse/macos-ipc-inter-process-communication/index.html).",
    "### `com.apple.security.get-task-allow`",
    "This entitlement allows other processes with the **`com.apple.security.cs.debugger`** entitlement to get the task port of the process run by the binary with this entitlement and **inject code on it**. Check [**this for more info**](../macos-proces-abuse/macos-ipc-inter-process-communication/index.html).",
    "### `com.apple.security.cs.debugger`",
    "Apps with the Debugging Tool Entitlement can call `task_for_pid()` to retrieve a valid task port for unsigned and third-party apps with the `Get Task Allow` entitlement set to `true`. However, even with the debugging tool entitlement, a debugger **can\u2019t get the task ports** of processes that **don\u2019t have the `Get Task Allow` entitlement**, and that are therefore protected by System Integrity Protection. Check [**this for more info**](https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_security_cs_debugger)."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-dangerous-entitlements.md"
  ]
}