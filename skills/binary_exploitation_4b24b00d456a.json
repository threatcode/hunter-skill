{
  "id": "binary_exploitation_4b24b00d456a",
  "category": "binary-exploitation",
  "title": "no exec nx",
  "description": "# No-exec / NX\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Basic Information\n\nThe **No-Execute (NX)** bit, also known as **Execute Disable (XD)** in Intel terminology, is a hardware-based security feature designed to **mitigate** the effects of **buffer overflow** attacks. When implemented and enabled, it distinguishes between memory regions that are intended for **executable code** and those meant for **data**, such as the **stack** and **heap**. The core idea is to prevent an attack",
  "payloads": [
    "# No-exec / NX",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Basic Information",
    "The **No-Execute (NX)** bit, also known as **Execute Disable (XD)** in Intel terminology, is a hardware-based security feature designed to **mitigate** the effects of **buffer overflow** attacks. When implemented and enabled, it distinguishes between memory regions that are intended for **executable code** and those meant for **data**, such as the **stack** and **heap**. The core idea is to prevent an attacker from executing malicious code through buffer overflow vulnerabilities by putting the malicious code in the stack for example and directing the execution flow to it.",
    "Modern operating systems enforce NX through the page table attributes that back the ELF program headers. For example, the `PT_GNU_STACK` header combined with the `GNU_PROPERTY_X86_FEATURE_1_SHSTK` or `GNU_PROPERTY_X86_FEATURE_1_IBT` properties let the loader know whether the stack should be **RW** or **RWX**. When NX is enabled and the binary was linked with a non-executable stack (`-z noexecstack`), any attempt to pivot execution into attacker-controlled data pages (stack, heap, mmap'ed buffers, etc.) will raise a fault unless those pages were explicitly marked as executable.",
    "### Detecting NX quickly",
    "- `checksec --file ./vuln` will display `NX enabled` or `NX disabled` based on the `GNU_STACK` program header.",
    "- `readelf -W -l ./vuln | grep GNU_STACK` exposes the stack permissions; the presence of an `E` flag indicates that the stack is executable. Example:",
    "```bash",
    "$ readelf -W -l ./vuln | grep GNU_STACK",
    "GNU_STACK      0x000000 0x000000 0x000000 0x000000 0x000000 RW  0x10",
    "- `execstack -q ./vuln` (from `prelink`) is handy when auditing large collections of binaries because it prints `X` for binaries that still have an executable stack.",
    "- At runtime, `/proc/<pid>/maps` will show whether an allocation is `rwx`, `rw-`, `r-x`, etc., which is useful when verifying JIT engines or custom allocators.",
    "## Bypasses",
    "### Code-reuse primitives"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/common-binary-protections-and-bypasses/no-exec-nx.md"
  ]
}