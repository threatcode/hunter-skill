{
  "id": "network_services_pentesting_8ac3488fa44a",
  "category": "network-services-pentesting",
  "title": "drupal rce",
  "description": "# Drupal RCE\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## With PHP Filter Module\n\n> [!WARNING]\n> In older versions of Drupal **(before version 8)**, it was possible to log in as an admin and **enable the `PHP filter` module**, which \"Allows embedded PHP code/snippets to be evaluated.\" But from version 8 this module is not installed by default.\n\n1. Go to **/modules/php** and if a 403 error is returned then the **PHP filter plugin is installed and you can continue**\n   1. If not, go t",
  "payloads": [
    "# Drupal RCE",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## With PHP Filter Module",
    "> [!WARNING]",
    "> In older versions of Drupal **(before version 8)**, it was possible to log in as an admin and **enable the `PHP filter` module**, which \"Allows embedded PHP code/snippets to be evaluated.\" But from version 8 this module is not installed by default.",
    "1. Go to **/modules/php** and if a 403 error is returned then the **PHP filter plugin is installed and you can continue**",
    "1. If not, go to `Modules` and check on the box of `PHP Filter` and then on `Save configuration`",
    "2. Then, to exploit it, click on `Add content` , then Select `Basic Page` or `Article` and write the **PHP backdoor**, then select `PHP` code in Text format and finally select `Preview`",
    "3. To trigger it, just access the newly created node:",
    "```bash",
    "curl http://drupal.local/node/3",
    "## Install PHP Filter Module",
    "> [!WARNING]",
    "> In current versions it's no longer possible to install plugins by only having access to the web after the default installation.",
    "From version **8 onwards, the** [**PHP Filter**](https://www.drupal.org/project/php/releases/8.x-1.1) **module is not installed by default**. To leverage this functionality, we would have to **install the module ourselves**."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/drupal/drupal-rce.md"
  ]
}