{
  "id": "network_services_pentesting_50fba220d522",
  "category": "network-services-pentesting",
  "title": "wsgi",
  "description": "# WSGI Post-Exploitation Tricks\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## WSGI Overview\n\nWeb Server Gateway Interface (WSGI) is a specification that describes how a web server communicates with web applications, and how web applications can be chained together to process one request. uWSGI is one of the most popular WSGI servers, often used to serve Python web applications. Its native binary transport is the uwsgi protocol (lowercase) which carries a bag of key/value parameters (\"uw",
  "payloads": [
    "# WSGI Post-Exploitation Tricks",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## WSGI Overview",
    "Web Server Gateway Interface (WSGI) is a specification that describes how a web server communicates with web applications, and how web applications can be chained together to process one request. uWSGI is one of the most popular WSGI servers, often used to serve Python web applications. Its native binary transport is the uwsgi protocol (lowercase) which carries a bag of key/value parameters (\"uwsgi params\") to the backend application server.",
    "Related pages you may also want to check:",
    "{{#ref}}",
    "werkzeug.md",
    "{{#endref}}",
    "{{#ref}}",
    "../../pentesting-web/ssrf-server-side-request-forgery/README.md",
    "{{#endref}}",
    "## uWSGI Magic Variables Exploitation",
    "uWSGI provides special \"magic variables\" that can change how the instance loads and dispatches applications. These variables are not normal HTTP headers \u2014 they are uwsgi parameters carried inside the uwsgi/SCGI/FastCGI request from the reverse proxy (nginx, Apache mod_proxy_uwsgi, etc.) to the uWSGI backend. If a proxy configuration maps user-controlled data into uwsgi parameters (for example via `$arg_*`, `$http_*`, or unsafely exposed endpoints that talk the uwsgi protocol), attackers can set these variables and achieve code execution.",
    "### Dangerous mappings in front proxies (nginx example)",
    "Misconfigurations like the following directly expose uWSGI magic variables to user input:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/wsgi.md"
  ]
}