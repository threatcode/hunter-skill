{
  "id": "windows_4889f29b4c70",
  "category": "windows",
  "title": "using bloodhound",
  "description": "# Advanced BloodHound Queries Collection\n\nThis document contains a comprehensive collection of queries for use with BloodHound, organized by category. These queries can help you analyze Active Directory environments more effectively.\n\n## User and Group Analysis\n\n### Find all edges any owned user has on a computer\n```\nMATCH p=shortestPath((m:User)-[r]->(b:Computer)) WHERE m.owned RETURN p\n```\n\n### Find all Kerberoastable Users\n```\nMATCH (n:User) WHERE n.hasspn=true RETURN n\n```\n\n### Find Kerberoa",
  "payloads": [
    "# Advanced BloodHound Queries Collection",
    "This document contains a comprehensive collection of queries for use with BloodHound, organized by category. These queries can help you analyze Active Directory environments more effectively.",
    "## User and Group Analysis",
    "### Find all edges any owned user has on a computer",
    "MATCH p=shortestPath((m:User)-[r]->(b:Computer)) WHERE m.owned RETURN p",
    "### Find all Kerberoastable Users",
    "MATCH (n:User) WHERE n.hasspn=true RETURN n",
    "### Find Kerberoastable Users with passwords last set > 5 years ago",
    "MATCH (u:User)",
    "WHERE u.hasspn=true AND u.pwdlastset < (datetime().epochseconds - (1825 * 86400))",
    "AND NOT u.pwdlastset IN [-1.0, 0.0]",
    "RETURN u.name, u.pwdlastset",
    "ORDER BY u.pwdlastset",
    "### Find users that logged in within the last 90 days",
    "MATCH (u:User)"
  ],
  "source": "h4cker",
  "references": [
    "/workspaces/hunter-skill/h4cker/windows/using_bloodhound.md"
  ]
}