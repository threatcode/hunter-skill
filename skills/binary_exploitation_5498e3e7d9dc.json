{
  "id": "binary_exploitation_5498e3e7d9dc",
  "category": "binary-exploitation",
  "title": "ret2lib + printf leak arm64",
  "description": "# Ret2lib + Printf leak - arm64\n\n{{#include ../../../banners/hacktricks-training.md}}\n\n## Ret2lib - NX bypass with ROP (no ASLR)\n\n```c\n#include <stdio.h>\n\nvoid bof()\n{\n    char buf[100];\n    printf(\"\\nbof>\\n\");\n    fgets(buf, sizeof(buf)*3, stdin);\n}\n\nvoid main()\n{\n    printfleak();\n    bof();\n}\n```\n\nCompile without canary:\n\n```bash\nclang -o rop-no-aslr rop-no-aslr.c -fno-stack-protector\n# Disable aslr\necho 0 | sudo tee /proc/sys/kernel/randomize_va_space\n```\n\n### Find offset - x30 offset\n\nCreat",
  "payloads": [
    "# Ret2lib + Printf leak - arm64",
    "{{#include ../../../banners/hacktricks-training.md}}",
    "## Ret2lib - NX bypass with ROP (no ASLR)",
    "#include <stdio.h>",
    "void bof()",
    "char buf[100];",
    "printf(\"\\nbof>\\n\");",
    "fgets(buf, sizeof(buf)*3, stdin);",
    "void main()",
    "printfleak();",
    "bof();",
    "Compile without canary:",
    "```bash",
    "clang -o rop-no-aslr rop-no-aslr.c -fno-stack-protector",
    "# Disable aslr"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/binary-exploitation/rop-return-oriented-programing/ret2lib/ret2lib-+-printf-leak-arm64.md"
  ]
}