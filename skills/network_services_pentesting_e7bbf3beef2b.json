{
  "id": "network_services_pentesting_e7bbf3beef2b",
  "category": "network-services-pentesting",
  "title": "custom protocols",
  "description": "# Custom UDP RPC Enumeration & File-Transfer Abuse\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Mapping proprietary RPC objects with Frida\n\nOlder multiplayer titles often embed home-grown RPC stacks on top of UDP. In *Anno 1404: Venice* this is implemented inside `NetComEngine3.dll` via the `RMC_CallMessage` dispatcher, which parses 5 fields from every datagram:\n\n| Field | Purpose |\n| --- | --- |\n| `ID` | RPC verb (16-bit) |\n| `Flags` | Transport modifiers (reliability, ordering) |\n| `",
  "payloads": [
    "# Custom UDP RPC Enumeration & File-Transfer Abuse",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Mapping proprietary RPC objects with Frida",
    "Older multiplayer titles often embed home-grown RPC stacks on top of UDP. In *Anno 1404: Venice* this is implemented inside `NetComEngine3.dll` via the `RMC_CallMessage` dispatcher, which parses 5 fields from every datagram:",
    "| Field | Purpose |",
    "| --- | --- |",
    "| `ID` | RPC verb (16-bit) |",
    "| `Flags` | Transport modifiers (reliability, ordering) |",
    "| `Source` | Object ID of the caller |",
    "| `TargetObject` | Remote object instance |",
    "| `Method` | Method index inside the target class |",
    "Two helper functions \u2013 `ClassToMethodName()` and `TargetName()` \u2013 translate raw IDs into human-readable strings for logging. By brute-forcing 24\u2011bit object IDs and 16\u2011bit method IDs and calling those helpers we can enumerate the entire remotely reachable surface without traffic captures or symbol leaks.",
    "<details>",
    "<summary>Frida surface enumerator (trimmed)</summary>",
    "```javascript"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/custom-protocols.md"
  ]
}