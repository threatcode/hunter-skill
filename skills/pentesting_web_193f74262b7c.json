{
  "id": "pentesting_web_193f74262b7c",
  "category": "pentesting-web",
  "title": "pdf injection",
  "description": "# PDF Injection\n\n{{#include ../../banners/hacktricks-training.md}}\n\n**If your input is being reflected inside a PDF file, you can try to inject PDF data to execute JavaScript, perform SSRF or steal the PDF content.**  \nPDF syntax is extremely permissive \u2013 if you can break out of the string or dictionary that is embedding your input you can append totally new objects (or new keys in the same object) that Acrobat/Chrome will happily parse.  \nSince 2024 a wave of bug-bounty reports have shown that ",
  "payloads": [
    "# PDF Injection",
    "{{#include ../../banners/hacktricks-training.md}}",
    "**If your input is being reflected inside a PDF file, you can try to inject PDF data to execute JavaScript, perform SSRF or steal the PDF content.**",
    "PDF syntax is extremely permissive \u2013 if you can break out of the string or dictionary that is embedding your input you can append totally new objects (or new keys in the same object) that Acrobat/Chrome will happily parse.",
    "Since 2024 a wave of bug-bounty reports have shown that *one unescaped parenthesis or back-slash is enough* for full script execution.",
    "## TL;DR \u2013 Modern Attack Workflow (2024)",
    "1. Find any user-controlled value that ends up inside a **(parenthesis string)**, `/URI ( \u2026 )` or `/JS ( \u2026 )` field in the generated PDF.",
    "2. Inject `) ` (closing the string) followed by one of the primitives below and finish with another opening parenthesis to keep the syntax valid.",
    "3. Deliver the malicious PDF to a victim (or to a backend service that automatically renders the file \u2013 great for blind bugs).",
    "4. Your payload runs in the PDF viewer:",
    "* Chrome / Edge \u2192 PDFium Sandbox",
    "* Firefox \u2192 PDF.js (see CVE-2024-4367)",
    "* Acrobat \u2192 Full JavaScript API (can exfiltrate arbitrary file contents with `this.getPageNthWord`)",
    "Example (annotation link hijack):",
    "```pdf"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/xss-cross-site-scripting/pdf-injection.md"
  ]
}