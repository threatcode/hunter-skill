{
  "id": "pentesting_web_eeb8cff56c53",
  "category": "pentesting-web",
  "title": "csrf cross site request forgery",
  "description": "# CSRF (Cross Site Request Forgery)\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Cross-Site Request Forgery (CSRF) Explained\n\n**Cross-Site Request Forgery (CSRF)** is a type of security vulnerability found in web applications. It enables attackers to perform actions on behalf of unsuspecting users by exploiting their authenticated sessions. The attack is executed when a user, who is logged into a victim's platform, visits a malicious site. This site then triggers requests to the victim's ",
  "payloads": [
    "# CSRF (Cross Site Request Forgery)",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Cross-Site Request Forgery (CSRF) Explained",
    "**Cross-Site Request Forgery (CSRF)** is a type of security vulnerability found in web applications. It enables attackers to perform actions on behalf of unsuspecting users by exploiting their authenticated sessions. The attack is executed when a user, who is logged into a victim's platform, visits a malicious site. This site then triggers requests to the victim's account through methods like executing JavaScript, submitting forms, or fetching images.",
    "### Prerequisites for a CSRF Attack",
    "To exploit a CSRF vulnerability, several conditions must be met:",
    "1. **Identify a Valuable Action**: The attacker needs to find an action worth exploiting, such as changing the user's password, email, or elevating privileges.",
    "2. **Session Management**: The user's session should be managed solely through cookies or the HTTP Basic Authentication header, as other headers cannot be manipulated for this purpose.",
    "3. **Absence of Unpredictable Parameters**: The request should not contain unpredictable parameters, as they can prevent the attack.",
    "### Quick Check",
    "You could **capture the request in Burp** and check CSRF protections and to test from the bowser you can click on **Copy as fetch** and check the request:",
    "<figure><img src=\"../images/image (11) (1) (1).png\" alt=\"\"><figcaption></figcaption></figure>",
    "### Defending Against CSRF",
    "Several countermeasures can be implemented to protect against CSRF attacks:",
    "- [**SameSite cookies**](hacking-with-cookies/index.html#samesite): This attribute prevents the browser from sending cookies along with cross-site requests. [More about SameSite cookies](hacking-with-cookies/index.html#samesite)."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/csrf-cross-site-request-forgery.md"
  ]
}