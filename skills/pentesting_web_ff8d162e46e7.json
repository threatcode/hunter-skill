{
  "id": "pentesting_web_ff8d162e46e7",
  "category": "pentesting-web",
  "title": "wasm linear memory template overwrite xss",
  "description": "# WebAssembly linear memory corruption to DOM XSS (template overwrite)\n\n{{#include ../../banners/hacktricks-training.md}}\n\nThis technique shows how a memory-corruption bug inside a WebAssembly (WASM) module compiled with Emscripten can be weaponized into a reliable DOM XSS even when input is sanitized. The pivot is to corrupt writable constants in WASM linear memory (e.g., HTML format templates) instead of attacking the sanitized source string.\n\nKey idea: In the WebAssembly model, code lives in ",
  "payloads": [
    "# WebAssembly linear memory corruption to DOM XSS (template overwrite)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "This technique shows how a memory-corruption bug inside a WebAssembly (WASM) module compiled with Emscripten can be weaponized into a reliable DOM XSS even when input is sanitized. The pivot is to corrupt writable constants in WASM linear memory (e.g., HTML format templates) instead of attacking the sanitized source string.",
    "Key idea: In the WebAssembly model, code lives in non-writable executable pages, but the module\u2019s data (heap/stack/globals/\"constants\") live in a single flat linear memory (pages of 64KB) that is writable by the module. If buggy C/C++ code writes out-of-bounds, you can overwrite adjacent objects and even constant strings embedded in linear memory. When such a constant is later used to build HTML for insertion via a DOM sink, you can turn sanitized input into executable JavaScript.",
    "Threat model and preconditions",
    "- Web app uses Emscripten glue (Module.cwrap) to call into a WASM module.",
    "- Application state lives in WASM linear memory (e.g., C structs with pointers/lengths to user buffers).",
    "- Input sanitizer encodes metacharacters before storage, but later rendering builds HTML using a format string stored in WASM linear memory.",
    "- There is a linear-memory corruption primitive (e.g., heap overflow, UAF, or unchecked memcpy).",
    "Minimal vulnerable data model (example)",
    "typedef struct msg {",
    "char *msg_data;       // pointer to message bytes",
    "size_t msg_data_len;  // length after sanitization",
    "int msg_time;         // timestamp",
    "int msg_status;       // flags"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/xss-cross-site-scripting/wasm-linear-memory-template-overwrite-xss.md"
  ]
}