{
  "id": "mobile_pentesting_5de19774260a",
  "category": "mobile-pentesting",
  "title": "bypass biometric authentication android",
  "description": "# Bypass Biometric Authentication (Android)\n\n{{#include ../../banners/hacktricks-training.md}}\n\n\n## **Method 1 \u2013 Bypassing with No Crypto Object Usage**\n\nThe focus here is on the _onAuthenticationSucceeded_ callback, which is crucial in the authentication process. Researchers at WithSecure developed a [Frida script](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js), enabling the bypass of the NULL _CryptoObject_ in _onAuthenticationSucceede",
  "payloads": [
    "# Bypass Biometric Authentication (Android)",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## **Method 1 \u2013 Bypassing with No Crypto Object Usage**",
    "The focus here is on the _onAuthenticationSucceeded_ callback, which is crucial in the authentication process. Researchers at WithSecure developed a [Frida script](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js), enabling the bypass of the NULL _CryptoObject_ in _onAuthenticationSucceeded(...)_. The script forces an automatic bypass of the fingerprint authentication upon the method's invocation. Below is a simplified snippet demonstrating the bypass in an Android Fingerprint context, with the full application available on [GitHub](https://github.com/St3v3nsS/InsecureBanking).",
    "```javascript",
    "biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {",
    "@Override",
    "public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {",
    "Toast.makeText(MainActivity.this,\"Success\",Toast.LENGTH_LONG).show();",
    "Command to run the Frida script:",
    "```bash",
    "frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js",
    "## **Method 2 \u2013 Exception Handling Approach**",
    "Another [Frida script](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js) by WithSecure addresses bypassing insecure crypto object usage. The script invokes _onAuthenticationSucceeded_ with a _CryptoObject_ that hasn't been authorized by a fingerprint. If the application tries to use a different cipher object, it will trigger an exception. The script prepares to invoke _onAuthenticationSucceeded_ and handle the _javax.crypto.IllegalBlockSizeException_ in the _Cipher_ class, ensuring subsequent objects used by the application are encrypted with the new key.",
    "Command to run the Frida script:"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/mobile-pentesting/android-app-pentesting/bypass-biometric-authentication-android.md"
  ]
}