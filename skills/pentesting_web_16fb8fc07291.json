{
  "id": "pentesting_web_16fb8fc07291",
  "category": "pentesting-web",
  "title": "client side template injection csti",
  "description": "# Client Side Template Injection (CSTI)\n\n{{#include ../banners/hacktricks-training.md}}\n\n## Summary\n\nIt is like a [**Server Side Template Injection**](ssti-server-side-template-injection/index.html) but in the **client**. The **SSTI** can allow you to **execute code** on the remote server, the **CSTI** could allow you to **execute arbitrary JavaScript** code in the victim's browser.\n\n**Testing** for this vulnerability is very **similar** as in the case of **SSTI**, the interpreter expects **a te",
  "payloads": [
    "# Client Side Template Injection (CSTI)",
    "{{#include ../banners/hacktricks-training.md}}",
    "## Summary",
    "It is like a [**Server Side Template Injection**](ssti-server-side-template-injection/index.html) but in the **client**. The **SSTI** can allow you to **execute code** on the remote server, the **CSTI** could allow you to **execute arbitrary JavaScript** code in the victim's browser.",
    "**Testing** for this vulnerability is very **similar** as in the case of **SSTI**, the interpreter expects **a template** and will execute it. For example, with a payload like `{{ 7-7 }}`, if the app is **vulnerable** you will see a `0`, and if not, you will see the original: `{{ 7-7 }}`",
    "## AngularJS",
    "AngularJS is a widely-used JavaScript framework that interacts with HTML through attributes known as directives, a notable one being **`ng-app`**. This directive allows AngularJS to process the HTML content, enabling the execution of JavaScript expressions inside double curly braces.",
    "In scenarios where user input is dynamically inserted into the HTML body tagged with `ng-app`, it's possible to execute arbitrary JavaScript code. This can be achieved by leveraging the syntax of AngularJS within the input. Below are examples demonstrating how JavaScript code can be executed:",
    "```javascript",
    "{{$on.constructor('alert(1)')()}}",
    "{{constructor.constructor('alert(1)')()}}",
    "<input ng-focus=$event.view.alert('XSS')>",
    "<!-- Google Research - AngularJS -->",
    "<div ng-app ng-csp><textarea autofocus ng-focus=\"d=$event.view.document;d.location.hash.match('x1') ? '' : d.location='//localhost/mH/'\"></textarea></div>",
    "You can find a very **basic online example** of the vulnerability in **AngularJS** in [http://jsfiddle.net/2zs2yv7o/](http://jsfiddle.net/2zs2yv7o/) and in [**Burp Suite Academy**](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression)"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/client-side-template-injection-csti.md"
  ]
}