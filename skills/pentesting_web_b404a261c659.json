{
  "id": "pentesting_web_b404a261c659",
  "category": "pentesting-web",
  "title": "browext xss example",
  "description": "# BrowExt - XSS Example\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Cross-Site Scripting (XSS) through Iframe\n\nIn this setup, a **content script** is implemented to instantiate an Iframe, incorporating a URL with query parameters as the source of the Iframe:\n\n```javascript\nchrome.storage.local.get(\"message\", (result) => {\n  let constructedURL =\n    chrome.runtime.getURL(\"message.html\") +\n    \"?content=\" +\n    encodeURIComponent(result.message) +\n    \"&redirect=https://example.net/deta",
  "payloads": [
    "# BrowExt - XSS Example",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Cross-Site Scripting (XSS) through Iframe",
    "In this setup, a **content script** is implemented to instantiate an Iframe, incorporating a URL with query parameters as the source of the Iframe:",
    "```javascript",
    "chrome.storage.local.get(\"message\", (result) => {",
    "let constructedURL =",
    "chrome.runtime.getURL(\"message.html\") +",
    "\"?content=\" +",
    "encodeURIComponent(result.message) +",
    "\"&redirect=https://example.net/details\"",
    "frame.src = constructedURL",
    "A publicly accessible HTML page, **`message.html`**, is designed to dynamically add content to the document body based on the parameters in the URL:",
    "```javascript",
    "$(document).ready(() => {"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/pentesting-web/browser-extension-pentesting-methodology/browext-xss-example.md"
  ]
}