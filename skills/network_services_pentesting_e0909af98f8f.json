{
  "id": "network_services_pentesting_e0909af98f8f",
  "category": "network-services-pentesting",
  "title": "disable functions bypass dl function",
  "description": "# Disable Functions Bypass - dl Function\n\n{{#include ../../../../banners/hacktricks-training.md}}\n\n**Important note:**\n\n![image](https://user-images.githubusercontent.com/84577967/174675487-a4c4ca06-194f-4725-85af-231a2f35d56c.png)\n\n**`dl`** is a PHP function that can be used to load PHP extensions. It the function isn't disabled it could be abused to **bypass `disable_functions` and execute arbitrary commands**.\\\nHowever, it has some strict limitations:\n\n- The `dl` function must be **present** ",
  "payloads": [
    "# Disable Functions Bypass - dl Function",
    "{{#include ../../../../banners/hacktricks-training.md}}",
    "**Important note:**",
    "![image](https://user-images.githubusercontent.com/84577967/174675487-a4c4ca06-194f-4725-85af-231a2f35d56c.png)",
    "**`dl`** is a PHP function that can be used to load PHP extensions. It the function isn't disabled it could be abused to **bypass `disable_functions` and execute arbitrary commands**.\\",
    "However, it has some strict limitations:",
    "- The `dl` function must be **present** in the **environment** and **not disabled**",
    "- The PHP Extension **must be compiled with the same major version** (PHP API version) that the server is using (you can see this information in the output of phpinfo)",
    "- The PHP extension must be **located in the directory** that is **defined** by the **`extension_dir`** directive (you can see it in the output of phpinfo). It's very unprobeable that an attacker trying to abuse the server will have write access over this directory, so this requirement probably will prevent you to abuse this technique).",
    "**If you meet these requirements, continue reading the post** [**https://antichat.com/threads/70763/**](https://antichat.com/threads/70763/) **to learn how to bypass disable_functions**. Here is a summary:",
    "The [dl function](http://www.php.net/manual/en/function.dl.php) is used to load PHP extensions dynamically during script execution. PHP extensions, typically written in C/C++, enhance PHP's functionality. The attacker, upon noticing the `dl` function is not disabled, decides to create a custom PHP extension to execute system commands.",
    "### Steps Taken by the Attacker:",
    "1. **PHP Version Identification:**",
    "- The attacker determines the PHP version using a script (`<?php echo 'PHP Version is '.PHP_VERSION; ?>`).",
    "2. **PHP Source Acquisition:**"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-dl-function.md"
  ]
}