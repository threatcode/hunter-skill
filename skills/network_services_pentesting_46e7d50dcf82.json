{
  "id": "network_services_pentesting_46e7d50dcf82",
  "category": "network-services-pentesting",
  "title": "perl tricks",
  "description": "# PrestaShop\n\n{{#include ../../banners/hacktricks-training.md}}\n\n## Perl backticks/qx// sinks in Apache mod_perl handlers (reachability and exploitation)\n\nReal-world pattern: Perl code builds a shell command string and executes it via backticks (or qx//). In a mod_perl AccessHandler, attacker-controlled request components like $r->uri() can flow into that string. If any branch concatenates raw input and then evaluates it with a shell, you get pre-auth RCE.\n\nRisky Perl execution primitives (spawn",
  "payloads": [
    "# PrestaShop",
    "{{#include ../../banners/hacktricks-training.md}}",
    "## Perl backticks/qx// sinks in Apache mod_perl handlers (reachability and exploitation)",
    "Real-world pattern: Perl code builds a shell command string and executes it via backticks (or qx//). In a mod_perl AccessHandler, attacker-controlled request components like $r->uri() can flow into that string. If any branch concatenates raw input and then evaluates it with a shell, you get pre-auth RCE.",
    "Risky Perl execution primitives (spawn a shell when given a single string):",
    "- Backticks / qx//: my $out = `cmd ...`;",
    "- system with a single string: system(\"/bin/sh -c '...'\") implicitly",
    "- open with a pipe: open my $fh, \"cmd |\" or \"| cmd\"",
    "- IPC::Open3 with a single string",
    "Minimal vulnerable shape observed in the wild:",
    "```perl",
    "sub getCASURL {",
    "my $exec_cmd = \"...\";",
    "if ($type eq 'login') {",
    "$exec_cmd .= $uri;        # $uri from $r->uri() \u2192 attacker-controlled"
  ],
  "source": "HackTricks",
  "references": [
    "/workspaces/hunter-skill/hacktricks/src/network-services-pentesting/pentesting-web/perl-tricks.md"
  ]
}